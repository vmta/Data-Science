Теперь перейдем к более важному тесту,
требующему меньше предпосылок,
а именно тесту Бройша-Годфри.
Он предназначен для тестирования
автокорреляции произвольного порядка p,
то есть мы предполагаем,
что ε_t = φ_1 ε_{t-1} + φ_2 ε_{t-2} +...
+ φ_p ε_{t-p} + u_t.
Этот тест,
в отличие от теста Дарбина-Уотсона,
не требует нормальности остатков,
и этот тест допускает ряд нарушений
предпосылки о строгой экзогенности,
то есть теперь математическое
ожидание от ε_t при условии x,
при фиксированных регрессорах
не обязано равняться 0.
И этот тест, конечно, асимптотический,
то есть он верен при больших n.
Проверяет он гипотезу H_0 об отсутствии
автокорреляции, то есть о том,
что φ_1 = φ_2 = φ_3 и так далее.
Все они равны 0.
Процедура теста Бройша-Годфри состоит
из построения двух регрессий:
первой регрессии, основной,
ту самую, которую мы хотим оценить,
из нее мы получаем остатки ε_1 с крышкой,
ε_2 с крышкой и так далее.
И на втором шаге мы строим вспомогательную
регрессию ε_t с крышкой на исходные
регрессоры, которые были на шаге 1,
и предыдущие значения остатков,
ε_{t-1} с крышкой,
ε_{t-2} с крышкой и так далее до шага p,
а некий шаг p,
порядок автокорреляции мы предполагаем.
И в этой второй вспомогательной регрессии
мы находим коэффициент детерминации
R-квадрат.
Назовем его R² вспомогательный.
И потом мы R² вспомогательный
домножаем на количество наблюдений минус
p, предполагаемый порядок автокорреляции,
и получаем статистику Бройша-Годфри.
При верной H0 об отсутствии автокорреляции
статистика Бройша-Годфри имеет
асимптотический χ²
распределения с p-степенями свободы.
Соответственно, на графике
мы видим простой критерий.
Если статистика Бройша-Годфри оказывается
больше χ² критического,
то гипотеза об отсутствии корреляции
отвергается, а ежели статистика
Бройша-Годфри оказывается небольшой,
меньше χ² критического,
то гипотеза об отсутствии
автокорреляции не отвергается.
Еще раз отметим, что тест Бройша-Годфри
требует меньшего количества предпосылок,
и поэтому именно он используется как
основной, а тест Дарбина-Уотсона,
с одной стороны, имеет исторический
интерес, а с другой стороны, сейчас он,
точнее, его аналог, используется в
пространственной эконометрике, где речь
идет о корреляции между наблюдениями,
относящимися к различным регионам.
Там несколько другая формула,
но идея остается очень похожей.
И сейчас мы рассмотрим задачу,
где посмотрим, что можно получить из
статистики Дарбина-Уотсона,
и проведем тест Бройша-Годфри.
Решим теоретическиую
задачу на автокорреляцию.
Для начала выпишем условие.
Итак, исследователь
оценил по 19 наблюдениям зависимость
инвестиций в момент времени,
t от процентной ставки и
валового национального продукта.
В рамках двух предположений,
предположение А,
что имеет место автокорреляция первого
порядка в остатках, то есть сегодняшний
остаток – это γ_1 помножить на
вчерашнюю случайную составляющую.
В рамках этого предположения необходимо
оценить корреляцию между случайной
составляющей вчерашней и сегодняшней.
И в рамках предположения B,
что ошибки в модели, ε_t, подчиняются
авторегрессионной схеме второго порядка,
то есть сегодняшние ошибки
зависят от вчерашних и позавчерашних с
коэффициентами γ_1 и γ_2 соответственно.
В рамках второго предположения B с
помощью вспомогательной регрессии
провести тест Бройша-Годфри
на наличие автокорреляции.
Известно, что в вспомогательной
регрессии остатков ε_t с крышкой
на процентную ставку, валовый национальный
продукт и предыдущие остатки,
R-квадрат вспомогательный был равен 0,075.
Приступим к решению.
Для начала будем работать в рамках
предположения A, что сегодняшняя случайная
составляющая – это γ_1 умножить на
вчерашнюю случайную составляющую, плюс u_t.
В рамках этого предположения
авторегрессионной схемы первого порядка,
мы знаем, что можно оценить корреляцию
с помощью статистики Дарбина-Уотсона,
поскольку имеет место следующая
связь между ними: статистика
Дарбина-Уотсона – это 2(1 - ρ с крышкой).
Отсюда оценка корреляции: ρ с крышкой
= 1- DW/2
= 1 - 1.32/2
= 0.34.
То есть мы получили оценку корреляции
между вчерашней и сегодняшней случайной
составляющей.
Она положительна и равна 0.34.
Если мы работаем в рамках второй модели,
в рамках предположения B об
авторегрессионной схеме второго
порядка и хотим протестировать наличие
автокорреляции, то мы должны построить
вспомогательную регрессию и извлечь
из нее R², а R² равен 0.075.
Соответственно, статистика
Бройша-Годфри – это есть
количество наблюдений минус
порядок авторегрессий,
помножить на R-квадрат во
вспомогательной регрессии.
Следовательно, в нашем
случае мы получаем 
(19 - 2)0.075,
это примерно равно 1.28.
При верном предположении H_0,
то есть я проверяю гипотезу H_0 о том,
что одновременно γ_1 = 0 и γ_2 = 0,
то есть о том,
что на самом деле автокорреляции нет,
против альтернативной о том, что хотя
бы один из коэффициентов не равен 0,
γ_1 не равна 0 или γ_2 не равна 0.
При этих предположениях
статистика Бройша-Годфри
имеет χ² распределения
с p-степенями свободы.
В данном случае это χ²
распределения с двумя степенями свободы.
Функция плотности
χ² с двумя степенями
свободы имеет примерно следующий вид.
Здесь где-то находится справа 5 %,
слева – 0.95,
отмечаем χ² критическое.
Следовательно, здесь около
0 H_0 не отвергается,
а при большом значении
χ² статистики
Бройше-Годфри гипотеза H0 отвергается.
Наблюдаемое значение статистики
Бройша-Годфри равно 1.28,
осталось определить критическое.
Критическое мы можем определить с помощью
R, нам нужно значение квантильной функции
χ² распределения с
двумя степенями свободы.
Квантиль порядка 0.95, соответственно,
χ² критическое равняется квантиль
χ² распределения,
квантиль порядка 0.95,
степени свободы равны двум,
и если эту команду запустить в R,
то мы получим,
что квантиль равна примерно 5.99.
В нашем случае наблюдаемое
значение статистики
Бройша-Годфри равно 1.28,
а критическое равно 5.99.
Следовательно, мы приходим к выводу,
что H0 не отвергается.
Это означает, что при предположении об
авторегрессионной схеме второго порядка
мы не можем отвергнуть гипотезу,
у нас недостаточно данных, конечно,
19 наблюдений – это довольно мало.
У нас не хватает данных,
чтобы отвергнуть гипотезу о полном
отсутствии автокорреляции в этой модели.
В этой лекции мы рассмотрели
ситуацию нарушения предпосылки
о некоррелированности ошибок модели ε_i,
ε_j.
Эта проблема называется автокорреляцией.
Если автокорреляция подчиняется
авторегрессионной схеме порядка p,
то эта проблема не
является такой страшной.
Мы просто используем специальные
стандартные ошибки Ньюи-Уеста,
которые позволяют нам проверять гипотезы
и строить доверительные интервалы.
А если же мы хотим углубленно заняться
моделированием структуры автокорреляции,
то нам необходим другой метод,
не только метод наименьших квадратов,
но и метод максимального правдоподобия,
о котором мы
поговорим в следующей лекции.

