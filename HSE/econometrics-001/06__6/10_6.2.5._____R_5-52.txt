Переходим к формальным
тестам на автокорреляцию.
Два самых популярных теста – это тест
Дарбина-Уотсона и тест Бройша-Годфри.
Проведем тест Дарбина-Уотсона
для нашей модели.
Это очень просто: # Durbin-Watson.
Я напомню, что нулевой гипотезой
данного теста является гипотеза
об отсутствии автокорреляции,
альтернативной
гипотезой (Ha) является гипотеза об
автокорреляции первого порядка,
то есть, в принципе,
тест может не почувствовать автокорреляцию
более высокого порядка, но может и
почувствовать, тут у нас нет гарантий.
Проводим тест, dwt(model).
Мы видим, что в нашем случае
статистика Дарбина-Уотсона равна 1.32,
p-value равно 0.03, и, соответственно,
можем посмотреть на результаты
данного теста dwt(model).
Из результатов, например,
можно вытащить значение
статистики Дарбина-Уотсона и,
например, из результатов можно вытащить
p-value.
p-value могут чуть-чуть отличаться,
потому что получаются путем симуляции.
Например, можно также из полезных
вещей вытащить оценку корреляции остатков,
то есть параметр этой
автокорреляции первого порядка,
и он равен 0.22, то есть корреляция
между сегодняшним остатком и вчерашним,
ее оценка равна 0,22.
Еще один распространенный тест на
автокорреляцию – это тест Бройша-Годфри.
В этом тесте также нулевой гипотезой
является гипотеза об
отсутствии автокорреляции,
однако альтернативной гипотезой
этот тест допускает автокорреляцию
любого более высокого порядка, чем 1,
мы можем задать фиксированный порядок,
скажем, сказать,
что это автокорреляция
k-го порядка.
Соответственно, это будет bgtest
от нашей модели, и, соответственно,
здесь мы должны указать порядок
максимальной автокорреляции, например,
проверим возможность наличия в наших
остатках автокорреляции второго порядка.
И в нашем случае,
если выбрать уровень значимости 5%,
то мы видим,
что значение,
точное p-значение оказалось равно 0.013,
то есть в данном случае гипотеза H_0 о том,
что нет автокорреляции,
против гипотезы о том,
что есть автокорреляция второго порядка,
эта гипотеза в данном
примере не отвергается,
то есть мы попали в такую ситуацию,
которая некоторых пугает,
хотя на самом деле не должна.
Если один тест отверг H_0,
вот здесь результатом
теста было отвержение H_0,
а тест Бройша-Годфри у
нас H0 не отвергнул.
Что делать в таком случае?
Ответ очень простой: гипотеза отвергается.
Почему?
Потому что что означает фраза
«гипотеза не отвергается»?
Это означает: не хватило данных,
чтобы ее отвергнуть.
Соответственно, одному тесту хватило
данных, чтобы отвергнуть H_0,
поэтому вывод: H_0 отвергается.
Таким образом,
в наших данных имеет место автокорреляция.
В нашем случае было логично
ожидать появления автокорреляции,
потому что наши данные являются
временным рядом и вполне логично,
что сегодняшнее значение
показателя связано со вчерашним.
Как в случае любого теста,
с тестом Бройша-Годфри всегда
можно дотянуться до результатов,
то есть можно поместить результаты
оценивания теста Бройша-Годфри в
список res и вытащить из этого списка res
интересующие нас показатели, ну,
например, саму статистику теста,
3.94, можно вытащить оцененные p-value,
0.13.
В этом смысле тест Бройша-Годфри,
его реализация не отличается от остальных.

