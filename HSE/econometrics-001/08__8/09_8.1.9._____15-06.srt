1
00:00:16,230 --> 00:00:18,992
В реальности мы заинтересованы
в построении прогнозов.

2
00:00:18,992 --> 00:00:23,219
Прогноз на h шагов вперед — формально это
условное математическое ожидание от Yt + h

3
00:00:23,219 --> 00:00:28,162
| при условии того,
что Yt и все предыдущие: (Yt- 1, Yt- 2,...

4
00:00:28,162 --> 00:00:29,110
) известны.

5
00:00:29,110 --> 00:00:33,411
Ну, для краткости на практике его часто,
чтобы не тащить вот этого крокодила,

6
00:00:33,411 --> 00:00:38,265
обозначают Y (с крышечкой) t + h, имея в
виду под записью t + h, что это прогноз,

7
00:00:38,265 --> 00:00:41,660
когда мне известна вся
информация вплоть до момента t,

8
00:00:41,660 --> 00:00:44,280
а прогнозирую я на h шагов в будущее.

9
00:00:44,280 --> 00:00:49,515
И давайте для конкретного примера
спрогнозируем на один и два шага вперед,

10
00:00:49,515 --> 00:00:52,946
построим точечный прогноз
и интервальный прогноз,

11
00:00:52,946 --> 00:00:55,887
то есть построим предиктивный интервал.

12
00:00:55,887 --> 00:01:01,410
Наша задача построить точечные и
интервальные прогнозы в рамках AR модели.

13
00:01:01,410 --> 00:01:07,077
Итак, у нас есть готовая
AR модель: Yt = 2 +

14
00:01:07,077 --> 00:01:12,709
0,5*Y(t- 1)- 0,06*Y(t- 2) + εt,

15
00:01:12,709 --> 00:01:17,383
мы считаем,
что εt имеет нормальное распределение с

16
00:01:17,383 --> 00:01:21,262
конкретным математическим ожиданием
0 и конкретной дисперсией 4.

17
00:01:21,262 --> 00:01:26,108
У нас есть данные по
прошлым наблюдениям: Y1,...

18
00:01:26,108 --> 00:01:27,040
Y100.

19
00:01:27,040 --> 00:01:32,690
И скажем, известно,
что Y99 = 3, а Y100 = 4.

20
00:01:32,690 --> 00:01:36,850
И наша задача: a)
составить точеный прогноз,

21
00:01:36,850 --> 00:01:43,596
то есть Y(с крышечкой) 100 + 1,
ну, так я подчеркиваю,

22
00:01:43,596 --> 00:01:51,010
что это прогноз с 100-го шага на один
шаг вперед и Y(с крышечкой)100 + 2,

23
00:01:51,010 --> 00:01:56,230
b) посчитать дисперсию ошибки прогноза,

24
00:01:56,230 --> 00:02:04,950
то есть посчитать Var(Y101 - Y(с
крышечкой)100 + 1 при условии,

25
00:02:04,950 --> 00:02:09,396
что я знаю все текущие игреки, Y1,...

26
00:02:09,396 --> 00:02:12,230
Y100 мне известны.

27
00:02:12,230 --> 00:02:19,040
Посчитать аналогично дисперсию ошибки
прогноза на два шага вперед, при условии,

28
00:02:19,040 --> 00:02:24,435
что я знаю все игреки до
текущего момента времени.

29
00:02:24,435 --> 00:02:29,496
И руководствуясь a и b, далее уже следуют
легкие пункты, если мы сделали a и b,

30
00:02:29,496 --> 00:02:36,340
то построить 95 % доверительный

31
00:02:36,340 --> 00:02:44,240
интервал для будущих...

32
00:02:48,290 --> 00:02:52,340
построить 95 % предиктивный интервал,

33
00:02:52,340 --> 00:03:00,550
предиктивный интервал
для будущих Y101 и Y102.

34
00:03:00,550 --> 00:03:02,614
Первый пункт a.

35
00:03:02,614 --> 00:03:09,435
Мы вспоминаем,
как мы строим прогнозы в рамках AR модели.

36
00:03:09,435 --> 00:03:14,377
Мы строим прогнозы,
беря условное математическое ожидание,

37
00:03:14,377 --> 00:03:21,288
то есть мы берем E(Y101 при условии,
что мы знаем все игреки, Y100, Y99,...

38
00:03:21,288 --> 00:03:24,766
) Мы подставляем формулу для Y101.

39
00:03:24,766 --> 00:03:25,590
Вот она.

40
00:03:25,590 --> 00:03:29,710
Это есть E(2

41
00:03:29,710 --> 00:03:34,008
+ 0,5*Y100-

42
00:03:34,008 --> 00:03:39,110
0,06 *Y99

43
00:03:39,110 --> 00:03:44,129
+ ε101 при условии,

44
00:03:44,129 --> 00:03:47,340
что я знаю все до момента времени 100.

45
00:03:47,340 --> 00:03:53,533
Естественно, при таком подходе Y100

46
00:03:53,533 --> 00:03:58,730
и Y99 для меня это просто известные числа,
а вот Y101 — это случайная величина,

47
00:03:58,730 --> 00:04:04,750
не зависит от информации,
которой я обладаю.

48
00:04:04,750 --> 00:04:09,560
Поэтому ее условное математическое
ожидание равно безусловному и равно 0.

49
00:04:09,560 --> 00:04:15,467
Я получаю 2 + 0,5, поскольку Y100 — это
то, что я знаю, то я просто подставляю,

50
00:04:15,467 --> 00:04:22,200
раз я его знаю, это 4- 0,06*3 + 0.

51
00:04:22,200 --> 00:04:28,100
Я получаю, что это 2 +

52
00:04:28,100 --> 00:04:33,760
2- 0,18

53
00:04:33,760 --> 00:04:38,900
и получается в результате 3,82.

54
00:04:38,900 --> 00:04:42,110
Это точечный прогноз на один шаг вперед.

55
00:04:42,110 --> 00:04:45,756
Аналогично мы строим прогноз
точечный на два шага

56
00:04:45,756 --> 00:04:50,196
вперед: Y (с крышечкой)100
+ 2 равняется...

57
00:04:50,196 --> 00:04:55,554
Подставляем формулу для
условного математического

58
00:04:55,554 --> 00:05:00,533
ожидания E(Y102, при условии,
что я знаю Y100, Y99,...

59
00:05:00,533 --> 00:05:05,556
) = Подставляем формулу для Y102.

60
00:05:05,556 --> 00:05:10,516
Это условное математическое
ожидание E от (2 +

61
00:05:10,516 --> 00:05:15,930
0,5 *Y101-

62
00:05:15,930 --> 00:05:22,611
0,06*Y100 + ε102| при условии,

63
00:05:22,611 --> 00:05:26,590
что я знаю игреки с сотого и более ранние.

64
00:05:31,305 --> 00:05:34,953
Смотрите: Y100 я знаю,

65
00:05:34,953 --> 00:05:39,890
ε102 не зависит,
—это будущая случайная составляющая,

66
00:05:39,890 --> 00:05:46,015
— не зависит от того, что я знаю.

67
00:05:46,015 --> 00:05:53,139
А E(Y101 при условии Y100, Y99,...

68
00:05:53,139 --> 00:05:55,440
) мы уже считали.

69
00:05:55,440 --> 00:05:59,594
Собственно, вот она.

70
00:05:59,594 --> 00:06:01,260
Вот она.

71
00:06:01,260 --> 00:06:02,406
Мы ее уже считали.

72
00:06:02,406 --> 00:06:05,780
Поэтому это можно просто написать,
что это 3,82.

73
00:06:05,780 --> 00:06:08,078
И теперь у нас есть все ингредиенты.

74
00:06:08,078 --> 00:06:12,676
Мы можем смешать их и получить Y (с
крышкой) точечный прогноз на два шага

75
00:06:12,676 --> 00:06:13,280
вперед.

76
00:06:13,280 --> 00:06:17,814
Мы получим 2 + 0,5 помножить на уже

77
00:06:17,814 --> 00:06:21,660
найденное нами математическое
ожидание от Y101 условно,

78
00:06:21,660 --> 00:06:27,940
это 3,82- 0,06*

79
00:06:27,940 --> 00:06:34,744
Y100 (4) и + 0.

80
00:06:34,744 --> 00:06:40,068
Упрощаем и получаем

81
00:06:40,068 --> 00:06:44,650
2 плюс половина от 3,82,

82
00:06:44,650 --> 00:06:49,735
это 1,91 и

83
00:06:49,735 --> 00:06:54,823
минус (6 * 4 это 24)

84
00:06:54,823 --> 00:07:02,710
и мы в результате получаем результат 3,67.

85
00:07:06,030 --> 00:07:10,942
Соответственно, мы построили
прогноз на один шаг вперед

86
00:07:10,942 --> 00:07:14,820
точечный и на два шага вперед
тоже точечный прогноз.

87
00:07:14,820 --> 00:07:20,600
Теперь перейдем к дисперсии
ошибки прогноза, к пункту b.

88
00:07:20,600 --> 00:07:23,380
Пункт b.

89
00:07:23,380 --> 00:07:28,815
Посчитаем Var(Y101- Y

90
00:07:28,815 --> 00:07:34,622
(с крышечкой) 100 + 1 при условии,
что я знаю Y1,...

91
00:07:34,622 --> 00:07:38,629
Y100) Давайте сначала немножко
упростим эту формулу.

92
00:07:38,629 --> 00:07:42,775
Конечно, это ошибка прогноза,
но как я строю свой прогноз?

93
00:07:42,775 --> 00:07:46,410
Мой прогноз он зависит только от того,
что я знаю.

94
00:07:46,410 --> 00:07:51,170
Построить прогноз, который бы зависел от
того, чего вы не знаете, не получится.

95
00:07:51,170 --> 00:07:54,494
Поэтому раз Y (с крышкой) 100

96
00:07:54,494 --> 00:07:59,395
+ 1 строится на основании того,
что я знаю, то, с моей точки зрения,

97
00:07:59,395 --> 00:08:03,100
это известная величина, и она на
дисперсию никак не влияет на условную.

98
00:08:03,100 --> 00:08:08,686
Поэтому я получаю Var(Y101
при условии Y1,...

99
00:08:08,686 --> 00:08:12,859
Y100) Ну вот теперь подставлю.

100
00:08:12,859 --> 00:08:20,620
Получится условная
дисперсия Var(2 + 0,5*Y100

101
00:08:24,740 --> 00:08:29,637
- 0,06 *Y99 +

102
00:08:29,637 --> 00:08:35,289
ε101 | при условии, что я знаю Y1, ...

103
00:08:35,289 --> 00:08:36,313
Y100).

104
00:08:36,313 --> 00:08:40,320
Опять же,
Y100 — это известная мне величина.

105
00:08:40,320 --> 00:08:42,105
Y99 — это известная мне величина.

106
00:08:42,105 --> 00:08:45,910
И 2 — это, вообще, константа, поэтому
на условную дисперсию они не влияют.

107
00:08:45,910 --> 00:08:52,207
Получается условная

108
00:08:52,207 --> 00:08:58,496
дисперсия Var(ε101 при условии Y1,...

109
00:08:58,496 --> 00:09:04,860
Y100) Но ε101, будущий шум,
никак не зависит от текущих игреков,

110
00:09:04,860 --> 00:09:09,509
поэтому условная дисперсия
превращается в безусловную

111
00:09:09,509 --> 00:09:14,310
Var(ε101) и она по условию равна 4.

112
00:09:14,310 --> 00:09:20,770
И аналогично мы можем посчитать дисперсию
ошибки прогноза на два шага вперед.

113
00:09:25,220 --> 00:09:31,162
Var(Y102 -

114
00:09:31,162 --> 00:09:36,092
Y (с крышкой) 100 + 2 |

115
00:09:36,092 --> 00:09:40,782
при условии, что я знаю Y1,...

116
00:09:40,782 --> 00:09:43,735
Y100) равняется...

117
00:09:43,735 --> 00:09:49,860
Опять же, прогноз строится на
основании известной мне информации,

118
00:09:49,860 --> 00:09:52,940
поэтому на разброс ошибки не влияет.

119
00:09:52,940 --> 00:09:55,260
Это есть просто дисперсия.

120
00:09:55,260 --> 00:10:01,180
y 102 при условии y1,..., y100.

121
00:10:01,180 --> 00:10:07,522
Итак, нам надо посчитать
дисперсию y102 при условии,

122
00:10:07,522 --> 00:10:11,980
что я знаю y1,..., y100.

123
00:10:11,980 --> 00:10:15,045
Я быстренько напомню уравнение,

124
00:10:15,045 --> 00:10:20,020
что yt = 2 + 0,5yt − 1

125
00:10:20,020 --> 00:10:24,730
− 0,06yt − 2 + εt.

126
00:10:24,730 --> 00:10:30,176
Подставляем y102 сюда,
получаем дисперсию 2

127
00:10:30,176 --> 00:10:35,296
+ 0,5 на y101 −

128
00:10:35,296 --> 00:10:41,288
0,06 на y100 + ε102 при условии,

129
00:10:41,288 --> 00:10:45,064
что я знаю y1, ..., y100.

130
00:10:45,064 --> 00:10:50,833
Поскольку величины y1,
y100 мне известны, то 0,06 y100 —

131
00:10:50,833 --> 00:10:56,420
для меня это известная величина, она не
прибавляет дисперсию 2, это — константа.

132
00:10:56,420 --> 00:11:01,450
Соответственно, остается дисперсия 0,5

133
00:11:01,450 --> 00:11:08,218
на y101 + ε102 при условии,

134
00:11:08,218 --> 00:11:12,620
что я знаю, что y1,..., y100.

135
00:11:12,620 --> 00:11:18,350
Подставляем y101, пользуясь той
же самой рекуррентной формулой.

136
00:11:18,350 --> 00:11:23,099
Дисперсия 0,5 помножить на

137
00:11:23,099 --> 00:11:27,410
2 + 0,5 на y100,

138
00:11:27,410 --> 00:11:32,210
− 0,06 на

139
00:11:32,210 --> 00:11:37,610
y99 + ε101,

140
00:11:37,610 --> 00:11:44,380
и плюс еще ε102 при условии,
что я знаю y1,..., y100.

141
00:11:44,380 --> 00:11:47,394
Что мне здесь известно?

142
00:11:47,394 --> 00:11:50,270
y100 мне известна.

143
00:11:50,270 --> 00:11:56,160
y99 известна, 2- константа, поэтому их
можно в дисперсии никак не отражать.

144
00:11:56,160 --> 00:12:01,200
И у меня, наконец,
останется совсем простое выражение: 0,5

145
00:12:01,200 --> 00:12:07,133
на ε101 + ε102 при условии y1,...

146
00:12:07,133 --> 00:12:08,670
y100.

147
00:12:08,670 --> 00:12:13,430
Но и ε102 и ε102 не зависят от того,
что я знаю,

148
00:12:13,430 --> 00:12:18,310
никак с ним не связаны,
поэтому это просто безусловная дисперсия.

149
00:12:18,310 --> 00:12:24,420
0,5 на ε101 + ε102,

150
00:12:24,420 --> 00:12:29,960
и это есть 0,5 в квадрате
на дисперсию ε101.

151
00:12:29,960 --> 00:12:34,609
Тут я напомню, что εt предполагались
нормальными с математическим

152
00:12:34,609 --> 00:12:39,586
ожиданием 0 и дисперсией 4,
то здесь я получу 0,5 на 4,

153
00:12:39,586 --> 00:12:42,810
плюс дисперсия 102 — тоже 4.

154
00:12:42,810 --> 00:12:46,350
Получится одна четверть от 4-х +4,
получится 5.

155
00:12:46,350 --> 00:12:48,564
А дальше все просто.

156
00:12:48,564 --> 00:12:55,914
Доверительный интервал,
пункт с) 95 % предиктивный,

157
00:12:55,914 --> 00:13:02,380
предиктивный интервал

158
00:13:02,380 --> 00:13:06,999
для y101 будет

159
00:13:06,999 --> 00:13:12,490
строиться по принципу:
от y100+1(с крышечкой),

160
00:13:12,490 --> 00:13:16,776
от нашего прогноза, минус,
если я говорю про нормальное

161
00:13:16,776 --> 00:13:22,100
распределение и возьму 95 % квантиль,

162
00:13:22,100 --> 00:13:26,758
вернее границы для
доверительного интервала 95 %,

163
00:13:26,758 --> 00:13:30,737
у меня получится от −1,96 до 1,96.

164
00:13:30,737 --> 00:13:38,219
Я напомню еще раз, вот эту 1,96 можно
получить в R как q квантиль нормального

165
00:13:38,219 --> 00:13:44,120
распределения порядка 0,975.

166
00:13:44,120 --> 00:13:49,116
Значит доверительный интервал
будет от y(с крышкой)

167
00:13:49,116 --> 00:13:53,230
100 + 1 −1,96,
помножить на стандартную ошибку,

168
00:13:53,230 --> 00:13:55,710
а стандартная ошибка —
это была корень из 4-х.

169
00:13:55,710 --> 00:13:58,500
Но, соответственно,

170
00:13:58,500 --> 00:14:04,360
y100 + 1 (с крышечкой) + 1,96
помножить на корень из 4-х.

171
00:14:04,360 --> 00:14:10,097
И если мы подставим посчитанное
нами y 100 + 1(с крышечкой),

172
00:14:10,097 --> 00:14:17,310
то мы получим предиктивный
интервал от −0,10 до 7,74.

173
00:14:17,310 --> 00:14:22,190
Аналогично поступая с
предиктивным интервалом для y102,

174
00:14:22,190 --> 00:14:28,170
мы получим интервал от точечного
прогноза 100 + 2 − 1,96

175
00:14:28,170 --> 00:14:33,680
помножить на корень из, на этот раз 5-ти,

176
00:14:33,680 --> 00:14:40,000
до y(с крышечкой) 100 + 2

177
00:14:40,000 --> 00:14:45,100
+ 1,96 на корень из 5-ти.

178
00:14:45,100 --> 00:14:47,916
Если выполнить арифметические действия,

179
00:14:47,916 --> 00:14:52,641
то получится доверительный
интервал от −0,71 до 8,05.

180
00:14:52,641 --> 00:14:57,413
Соответственно, мы получили
возможность строить

181
00:14:57,413 --> 00:15:01,300
точечные и интервальные прогнозы
в модели авторегрессии.

