Помимо обычной автокорреляционной функции,
у каждого стационарного процесса есть
частная автокорреляционная функция.
Прежде чем переходить к формальному
определению и способу подсчёта,
давайте сначала разберёмся с идеей
частной автокорреляционной функции.
Рассмотрим четыре случайные величины,
следующие подряд: y1, y2, y3, y4.
Мы хотим измерить прямой эффект
— как y1 воздействует на y4.
Естественно, есть совокупный эффект,
когда меняется y1, меняется y2 —
отчасти по своим каким-то причинам,
отчасти из-за того, что y1 поменялся,
— потом как-то это все воздействует на y2,
потом на y3 и, наконец, всё доходит до y4.
Соответственно, частная автокорреляция,
— она меряет прямой эффект, то есть то,
насколько изменился бы y4,
если бы y1 поменялся на единичку,
а y2, y3 остались бы неизменными.
В то время как обычная корреляция ρ3,
— она меряет совокупный
эффект воздействия y1 на y4,
то есть насколько в среднем изменится y4,
если y1 изменится на единичку,
и ничего неизвестно про
промежуточный y2 и y3.
Формальное определение частной
автокорреляции может несколько
быть непривычным, но по сути оно
как раз и реализует эту идею.
Частная корреляция φk на самом деле — это
обычная корреляция между yt и yt ‒ k,
только yt и yt ‒ k должны быть очищены от
влияния промежуточных случайных величин:
yt ‒ 1, yt ‒ 2,..., yt ‒ k + 1.
И эта очистка от влияния,
то есть это фиксирование,
осуществляется с помощью проецирования,
то есть мы из yt вычитаем
проекцию yt на множество
случайных величин,
которые линейно выражаются через yt ‒ 1,
yt ‒ 2,..., yt ‒ k + 1.
И точно также yt ‒ k
проецируется на yt ‒ 1,
yt ‒ 2,..., yt ‒ k + 1.
Получается разница, то есть очищенный
yt от влияния промежуточных величин,
очищенный yt ‒ k от промежуточных величин,
и считается между
очищенными yt и yt ‒ k,
считается обычная корреляция.
Но опять же это определение — это
ещё не совсем способ подсчёта.
Способ подсчёта по принципу делай раз,
делай два состоит в следующем.
Мы будем последовательно решать
системы линейных уравнений.
Из одной системы линейных
уравнений мы найдём φ1,
из другой системы уравнений мы
найдём частную автокорреляцию φ2,
из третьей системы уравнений мы найдем
частную автокорреляцию φ3 и так далее.
Соответственно, первая система уравнений
состоит всего из одного уравнения,
а именно: γ0,
то есть дисперсия процесса yt,
помножить на частную
автокорреляцию φ1 равняется γ1,
то есть ковариация yt и yt ‒ 1.
Из этой страшной системы
уравнений мы найдём φ1.
Дальше, чтобы найти φ2,
нам потребуется система линейных уравнений
из двух уравнений с двумя неизвестными.
Одна неизвестная, *1, она будет лишней,
вспомогательной и никак нам не нужна,
и ценности для нас представлять не будет.
А из этой системы уравнений
нам будет нужна только φ2.
Заметьте, как устроена
эта система уравнений.
Справа, в правом столбике находятся γ1,
γ2, а слева,
вот если представить
себе квадратную табличку,
которая отвечает за систему уравнений,
то по диагонали идёт γ0,
γ0, и рядом с главной диагональю γ0,
γ0 идёт γ1, γ1.
И теперь перейдём к случаю,
когда надо найти φ3.
Тогда потребуется решить систему из
трех уравнений с тремя неизвестными.
Но опять же две неизвестные *1 и *2 нас
интересовать вообще никак не будут, будут
вспомогательными, — нас будет интересовать
из этой системы уравнений только φ3.
И, соответственно,
как будет выглядеть эта система уравнений?
В правой стороне — столбик γ1, γ2, γ3.
В левой части уравнения по диагонали γ0,
γ0,
γ0, чуть сбоку от диагонали γ1, γ1, γ1,
γ1, и совсем далеко от диагонали
— γ2 и γ2 коэффициенты.
Соответственно, решая эту систему
уравнений, мы найдём среди прочего φ3,
ну нам, собственно, только оно и нужно.
И теперь рассмотрим на конкретном примере,
как у процесса скользящего среднего MA(2)
найти частную автокорреляционную функцию.
Рассмотрим пример нашего процесса: yt
= 5 + εt + 3εt ‒ 1 ‒ 2εt ‒ 2,
где εt — это белый шум.
Мы предполагаем,
что у этого белого шума дисперсия
равна σ-квадрат.
И наша задача — найти частную
автокорреляционную функцию,
первые несколько её значений: φ1, φ2, φ3.
Для того чтобы найти частную
автокорреляционную функцию,
мы будем решать всё более и более
крупные системы линейных уравнений,
и для того чтобы их составить, нам
потребуется автоковариационная функция,
то есть нам потребуется для начала γk,
которую мы уже находили,
которая есть ковариация между
y сегодня и y k шагов назад.
Мы уже находили эту функцию,
и она равна: 14 σ-квадрат,
если k = 0; ‒ 3 σ-квадрат,
если k = 1; ‒ 2 σ-квадрат,
если k = 2; и 0 при больших k,
то есть больше либо равного 3.
Ну, поехали.
Система уравнений для φ1 очень простая,
это одно уравнение,
и выглядит оно безумно
просто: γ0 * φ1 = γ1.
Отсюда мы получаем, что первая частная
автокорреляционная функция на шаге 1,
— она равна γ1/γ0.
Ну подставляем, получаем ‒ 3/14,
а σ-квадрат благополучно сокращается.
Естественно, можно заметить,
что всегда, собственно, φ1 = ρ1,
потому что никакой разницы между ними,
когда шаг равен единичке, нет.
Есть у меня yt ‒ 1,
он как-то воздействует на yt,
и вот этот эффект — его меряет и ρ1, и φ1.
С φ2 уже чуть более интересно.
Чтобы найти φ2, нам потребуется система с
двумя уравнениями и двумя неизвестными:
одной лишней, ненужной,
ну другой, собственно, φ2.
Система будет следующая.
Расставляем по диагонали γ0,
и потом рядом с диагональю — γ1.
Тут будет какая-то
бесполезная неизвестная,
обозначим её *1,
а потом будет полезная неизвестная φ2.
И здесь будет γ1, γ2.
Вот такая система уравнений, и сейчас
мы из неё найдем, соответственно, φ2.
Ну как нам найти?
Сразу подставим сюда все γ.
Можно сразу сократить на на σ-квадрат,
и получится следующий результат: 14 *
‒ 3 на φ2 = ‒ 3.
И вторая система уравнений: ‒
3 на * + 14
φ2 = γ2, ‒ 2.
Ну, собственно, в этой системе
уравнений нам нужна только φ2,
поэтому от неизвестной * мы будем
избавляться: домножаем первое
уравнение на 3, второе на 14.
Здесь получаем 30 и 12:
42 * ‒ 9φ2 = ‒ 9.
И второе уравнение домножаем на 14,
получаем: ‒ 42
* + 14 на 14,
196φ2 = ‒ 28.
Ну складываем уравнения.
Получаем, что
187φ2 = ‒ 37.
И отсюда φ2 =
‒ 37/187.
И это результат уже отличается от ρ2.
А я напомню,
что ρ2 — это было просто отношение одной
ковариации к дисперсии,
— она равнялась ‒ 2/14.
И ещё раз подчеркну разницу
между этими показателями.
У меня есть yt ‒ 2,
позавчерашнее значение моего показателя,
есть вчерашнее значение моего показателя,
есть сегодняшнее.
И прошлое — оно как-то
воздействует на будущее.
Есть прямой эффект,
и есть эффект через yt ‒ 1.
Так вот φ2 меряет только силу
прямого эффекта,
а ρ2 меряет совокупный эффект,
то есть вот эти несколько
стрелочек в совокупности.
И аналогично можно посчитать φ3.
Значит, для этого нам надо
составить систему большую
и страшную уже: γ0, γ0, γ0 по диагонали.
Потом — чем дальше от диагонали,
тем выше номер
γ: γ1, γ1, γ1, γ1.
И здесь осталось местечко для γ2, γ2.
И пишем здесь неизвестные:
первая бесполезная,
вторая бесполезная и φ3 равняется γ1.
Первая бесполезная плюс вторая
бесполезная плюс φ3 равняется γ2.
И в последнем уравнении то
же самое: три неизвестные,
две из которых бесполезные,
а одна, третья,
неизвестная — γ3.
Соответственно, если записать
эту систему уравнений в числах,
то у нас получится следующее:
14 *1
‒ 3 *2 ‒ 2φ3
= ‒ 3.
‒ 3 *1
+ 14 *2 ‒
3φ3 = ‒ 2.
И последнее уравнение: ‒ 2 *1
‒ 3 *2
+ 14φ3 = 0.
И, соответственно,
решив эту систему уравнений,
мы получим φ3.

