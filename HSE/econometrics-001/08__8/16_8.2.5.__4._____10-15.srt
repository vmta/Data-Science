1
00:00:12,550 --> 00:00:15,697
Рассмотрим еще один ряд,

2
00:00:15,697 --> 00:00:21,320
интересный для анализа,
длинный на Sophist.hse.ru,

3
00:00:21,320 --> 00:00:25,440
вот рассмотрим здесь основные
макроэкономические показатели.

4
00:00:25,440 --> 00:00:30,340
Возьмем вот

5
00:00:30,340 --> 00:00:36,500
это, скажем,
индекс потребительских цен месячный.

6
00:00:40,980 --> 00:00:45,460
Соответственно, он называется CPI_M,

7
00:00:45,460 --> 00:00:49,560
ну мы просто скопируем название.

8
00:00:49,560 --> 00:00:55,210
Так, давайте мы его

9
00:00:55,210 --> 00:01:00,850
загрузим в ряд данных y,

10
00:01:00,850 --> 00:01:07,290
sophisthse и вот здесь
мы вставим это название.

11
00:01:07,290 --> 00:01:12,780
Как всегда сначала построим график.

12
00:01:12,780 --> 00:01:15,995
Что у нас на графике?

13
00:01:15,995 --> 00:01:18,680
Ой, tsdisplay.

14
00:01:18,680 --> 00:01:20,845
Что мы видим?

15
00:01:20,845 --> 00:01:28,670
Что этот цепной

16
00:01:28,670 --> 00:01:31,947
индекс менялся следующим образом:
вот сначала он был очень большой,

17
00:01:31,947 --> 00:01:36,362
сначала была какая-то большая инфляция,
то есть можно посмотреть, здесь есть

18
00:01:36,362 --> 00:01:42,150
маленький нюанс: y реализован
как объект пакета zu.

19
00:01:42,150 --> 00:01:45,816
И, к сожалению, из-за большого
количества пакетов, написанных в R,

20
00:01:45,816 --> 00:01:49,670
одни пакеты читают какие-то характеристики
рядов из других, другие нет,

21
00:01:49,670 --> 00:01:54,820
но вот tsdisplay не прочитала
автоматом годы, давайте тут попробуем

22
00:01:54,820 --> 00:02:01,471
упростить немножко наш объект,
немножко изменить,

23
00:02:01,471 --> 00:02:06,560
представим его как не как объект класса
zu, а как объект класса временной ряд,

24
00:02:06,560 --> 00:02:11,080
тогда у нас появятся годы на оси x.

25
00:02:11,080 --> 00:02:16,044
И вот мы видим, что до начала,
ну вот до 2000-ных у нас тут были и

26
00:02:16,044 --> 00:02:21,044
какие-то совершенно сумашедшие
уровни индекса потребительских цен,

27
00:02:21,044 --> 00:02:25,869
очень большая инфляция, поэтому ну
вот разумно отобрать и посмотреть на

28
00:02:25,869 --> 00:02:30,783
увеличенном масштабе с 2000-го года,
чтобы у нас ряд

29
00:02:30,783 --> 00:02:36,230
представлял себе уже какую-то
более однородную зависимость.

30
00:02:36,230 --> 00:02:40,850
Соответственно, посмотрим на наш ряд y,

31
00:02:40,850 --> 00:02:46,610
значит у нас 2000-й год начинается с

32
00:02:46,610 --> 00:02:51,990
вот январь 2000-го года
— это 97-е наблюдение.

33
00:02:51,990 --> 00:02:57,276
Соответственно, давайте
отберем в ряд ym ну,

34
00:02:57,276 --> 00:03:02,870
скажем, более условно современные y,
это наш ряд y,

35
00:03:02,870 --> 00:03:07,834
с которого отобрали наблюдения,
начиная с 97-го по

36
00:03:07,834 --> 00:03:13,730
количество строк в ряду y,
ну вот скажем столбики отобрали все.

37
00:03:13,730 --> 00:03:17,640
И теперь построим график для

38
00:03:17,640 --> 00:03:23,110
ряда ym.

39
00:03:23,110 --> 00:03:27,440
Соответственно, это тот же ряд,

40
00:03:27,440 --> 00:03:31,131
только я отобрал из
этого ряда последние y,

41
00:03:31,131 --> 00:03:35,100
начиная индекса цен,
начиная с 2000-го года.

42
00:03:35,100 --> 00:03:36,825
Что я вижу на этом графике?

43
00:03:36,825 --> 00:03:40,130
На этом графике я вижу
очень интересную структуру.

44
00:03:40,130 --> 00:03:44,730
Обратите внимание, совершенно какая-то
странная структура автокорреляционной

45
00:03:44,730 --> 00:03:47,646
функции, она как-бы идет циклами.

46
00:03:47,646 --> 00:03:51,503
Давайте посмотрим,
где приходится максимум этих циклов.

47
00:03:51,503 --> 00:03:54,260
И максимум, если присмотреться,
приходится на 12.

48
00:03:54,260 --> 00:03:58,935
Это означает,
что показатель 12 шагов назад очень

49
00:03:58,935 --> 00:04:02,070
сильно влияет на текущий показатель.

50
00:04:02,070 --> 00:04:06,405
И это логично, потому что данные,
которые мы скачали,

51
00:04:06,405 --> 00:04:11,166
если внимательно почитать,
они были месячные.

52
00:04:11,166 --> 00:04:16,750
Соответственно, это означает, что январь,

53
00:04:16,750 --> 00:04:22,957
индекс цен января этого года он похож
на индекс цен января прошлого года.

54
00:04:22,957 --> 00:04:26,644
И это логично, потому что хотя есть
какая-то общая тенденция: если сегодня

55
00:04:26,644 --> 00:04:29,182
были там высокие цены,
то в следующем месяце, наверное,

56
00:04:29,182 --> 00:04:32,160
они сохранятся, вряд ли они резко
поменяются, но тем не менее,

57
00:04:32,160 --> 00:04:34,775
январь одного года похож
на январь другого года.

58
00:04:34,775 --> 00:04:37,340
То есть мы здесь сталкиваемся
с таким явлением,

59
00:04:37,340 --> 00:04:41,053
которое заслуживает отдельного изучения,
как сезонность.

60
00:04:41,053 --> 00:04:45,457
Ну мы не будем, конечно, всерьез
заниматься сезонностью, но просто покажем,

61
00:04:45,457 --> 00:04:48,840
что, во-первых, мы ее увидели
на автокорреляционной функции,

62
00:04:48,840 --> 00:04:53,380
если посмотреть функцию 12
шагов назад и 24 шага назад,

63
00:04:53,380 --> 00:05:00,240
то показатель 12 шагов назад и 24
шага назад сильно влияет на текущий,

64
00:05:00,240 --> 00:05:04,175
и то же самое видно по частной
автокорреляционной функции.

65
00:05:04,175 --> 00:05:10,124
Поэтому в эту модель логично включить
не только yt как в зависимости yt – 1,

66
00:05:10,124 --> 00:05:14,837
но логично включить в
модель для yt коэффициент

67
00:05:14,837 --> 00:05:18,905
при yt – 12 и коэффициент при εt – 12.

68
00:05:18,905 --> 00:05:22,690
И это называется сезонной моделью ARIMA.

69
00:05:22,690 --> 00:05:25,977
Ну, к счастью,
в R это сделать очень легко.

70
00:05:25,977 --> 00:05:30,615
Нам достаточно просто
написать что мы построим нашу

71
00:05:30,615 --> 00:05:35,210
модель 1 — это будет сезонная модель,

72
00:05:35,210 --> 00:05:39,618
то есть мы построим ARIMA
модель для ряда ym, скажем,

73
00:05:39,618 --> 00:05:44,952
я возьму простую сезонную модель,
это будет AR(1),

74
00:05:44,952 --> 00:05:49,290
но с еще одной сезонной
составляющей 12 шагов назад.

75
00:05:49,290 --> 00:05:53,370
То есть я возьму AR(1), как предложил,

76
00:05:53,370 --> 00:06:01,986
и возьму еще сезонную составляющую
seasonal = c (1, 0, 0).

77
00:06:01,986 --> 00:06:04,414
То есть что означает эта запись?

78
00:06:04,414 --> 00:06:11,323
Это означает, что у меня будет yt
зависеть от yt – 1 и от yt – 12.

79
00:06:11,323 --> 00:06:16,511
Поскольку компьютер знает,
что это ряды месячные, то вот эту единичку

80
00:06:16,511 --> 00:06:21,850
сезонную он понимает как аналогичный
сезон, но предыдущего года.

81
00:06:21,850 --> 00:06:26,750
Давайте оценим такую модель,

82
00:06:26,750 --> 00:06:32,310
посмотрим на summary по модели 1,

83
00:06:32,310 --> 00:06:37,370
и здесь вот у нас есть

84
00:06:37,370 --> 00:06:41,720
как средний индекс,

85
00:06:41,720 --> 00:06:46,348
так же есть AR(1) — это
означает как коэффициент при

86
00:06:46,348 --> 00:06:50,880
зависимости yt от yt – 1,
и есть сезонный AR(1) коэффициент,

87
00:06:50,880 --> 00:06:54,516
то есть это коэффициент при
зависимости yt от yt – 12.

88
00:06:54,516 --> 00:06:57,897
И вот здесь видно,
что компьютер сам распознал,

89
00:06:57,897 --> 00:07:03,697
что здесь периодичность 12 месяцев в год,
то есть, соответственно,

90
00:07:03,697 --> 00:07:08,487
мы у этой модели можем посчитать
критерий AIC — штрафной

91
00:07:08,487 --> 00:07:13,890
критерий для сравнения с другими моделями,
можем построить прогнозы,

92
00:07:13,890 --> 00:07:18,360
и вот здесь мы увидим, что прогнозы
они будут уже учитывать сезонность,

93
00:07:18,360 --> 00:07:23,810
и будут не такими, возможно, тривиальными
и ожидаемыми как для случайного блуждания.

94
00:07:23,810 --> 00:07:29,174
Давайте построим прогноз
forecast по модели 1, ну,

95
00:07:29,174 --> 00:07:34,800
скажем, на год вперед,
на 12 месяцев вперед.

96
00:07:34,800 --> 00:07:39,830
Мы строим прогнозы для
цепных индексов цен,

97
00:07:39,830 --> 00:07:48,240
и изображаем наши прогнозы
plot (prognoz_1).

98
00:07:48,240 --> 00:07:54,590
И здесь в силу того,

99
00:07:54,590 --> 00:08:00,037
что мы учитывали сезонность, вот мы видим

100
00:08:00,037 --> 00:08:04,389
прогноз уже нетривиальный,
не просто убывает вниз,

101
00:08:04,389 --> 00:08:09,364
не просто убывает вверх, а он чем-то
похож на структуру каждого года.

102
00:08:09,364 --> 00:08:14,030
Вот здесь вначале вниз, потом вверх,
здесь то же самое: вначале большой вверх,

103
00:08:14,030 --> 00:08:19,274
потом вниз, то есть вот эта структура
динамики индекса потребительских

104
00:08:19,274 --> 00:08:24,600
цен цепного месячного — она у нас
оказывается и в нашем прогнозе.

105
00:08:24,600 --> 00:08:29,800
И, соответственно,
с доверительным интервалом 80 % и 95 %.

106
00:08:29,800 --> 00:08:34,627
Соответственно, вот чего мы
ждем от месячного уровня цен

107
00:08:34,627 --> 00:08:36,549
— цепного коэффициента.

108
00:08:36,549 --> 00:08:41,377
И опять же можно попросить компьютер
автоматически выбрать модель,

109
00:08:41,377 --> 00:08:46,405
поскольку здесь уже можно выбирать
и лаги по AR-части и лаги по

110
00:08:46,405 --> 00:08:51,650
MA-части и сезонные лаги,
то есть можно yt – 12,

111
00:08:51,650 --> 00:08:56,090
yt – 24, εt – 12, εt – 24.

112
00:08:56,090 --> 00:09:01,050
Опять же можно рассматривать,
переходить к Δyt.

113
00:09:01,050 --> 00:09:06,089
Ну и давайте попробуем подобрать
автоматическую модель,

114
00:09:06,089 --> 00:09:11,058
model, которая минимизирует
критерий Акаике,

115
00:09:11,058 --> 00:09:18,670
Arima(ym) и посмотреть прогнозы
по автоматической модели,

116
00:09:18,670 --> 00:09:23,569
насколько они сильно
отличаются от простой нашей.

117
00:09:23,569 --> 00:09:30,410
Model_a, здесь тоже
исправим индекс модель a.

118
00:09:30,410 --> 00:09:36,748
А, я не подобрал модели,
надо было написать auto.arima (ym),

119
00:09:36,748 --> 00:09:39,740
по умолчанию оценилась.

120
00:09:39,740 --> 00:09:46,625
И, соответственно,
вот у нас прогноз по автоматически

121
00:09:46,625 --> 00:09:51,850
оцененный по минимальному
AIC модели ARIMA.

122
00:09:51,850 --> 00:09:57,250
Видите, это сложная модель, здесь ряд
признан нестационарным, то есть идет Δyt,

123
00:09:57,250 --> 00:10:03,038
три лага по AR-части, один лаг по
MA-части, два сезонных лага по AR-части,

124
00:10:03,038 --> 00:10:07,306
один сезонный лаг по MA- части, то есть
это сложный процесс, но, тем не менее,

125
00:10:07,306 --> 00:10:10,560
вот он как-то автоматически
оценивается и можно прогнозировать.

