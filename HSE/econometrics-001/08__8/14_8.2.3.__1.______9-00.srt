1
00:00:13,250 --> 00:00:18,783
Теперь перейдем к оценке реальных данных.

2
00:00:18,783 --> 00:00:23,296
Для начала рассмотрим физический
показатель — уровень воды в одном озере.

3
00:00:23,296 --> 00:00:26,900
Мы возьмем для начала
встроенный в R набор данных.

4
00:00:26,900 --> 00:00:32,780
В R есть встроенный набор
данных по уровню озера Гурон,

5
00:00:32,780 --> 00:00:36,930
можно почитать в Википедии что
это такое за большое озеро.

6
00:00:36,930 --> 00:00:41,400
Мы пользуемся им для простоты,
поскольку это встроенный набор данных.

7
00:00:41,400 --> 00:00:43,340
И, соответственно,

8
00:00:43,340 --> 00:00:49,370
строим для нашего реального набора
данных три стандартных графика.

9
00:00:49,370 --> 00:00:54,094
График самого временного ряда, график
автокорреляционной функции выборочный и

10
00:00:54,094 --> 00:00:56,800
график частной автокорреляционной функции.

11
00:00:56,800 --> 00:01:01,361
На этих трех графиках мы видим,
что наш ряд y занимает какое-то

12
00:01:01,361 --> 00:01:06,337
компромиссное положение между с одной
стороны стационарным процессом,

13
00:01:06,337 --> 00:01:10,760
а с другой стороны чем-то похоже уже
на коротенькое случайное блуждание.

14
00:01:10,760 --> 00:01:15,255
Потому что частная автокорреляционная
функция хотя и убывает, но все-таки

15
00:01:15,255 --> 00:01:20,390
убывает не так быстро, как это было бы
у идеального стационарного процесса.

16
00:01:20,390 --> 00:01:25,569
Поэтому здесь как раз спорная ситуация и
можно попробовать моделировать его как

17
00:01:25,569 --> 00:01:30,594
стационарным процессом, скажем взять
какой-нибудь AR с несколькими лагами, вот

18
00:01:30,594 --> 00:01:35,351
здесь две первых частных автокорреляции
не равны нулю, можно взять AR(2),

19
00:01:35,351 --> 00:01:40,045
либо попробовать
нестационарный временной ряд,

20
00:01:40,045 --> 00:01:43,722
то есть перейти к приращениям,
к Δyt и моделировать Δyt.

21
00:01:43,722 --> 00:01:45,830
Давайте попробуем оба подхода.

22
00:01:45,830 --> 00:01:50,630
Модель 1

23
00:01:50,630 --> 00:01:56,370
Arima модель для ряда y,

24
00:01:56,370 --> 00:02:01,440
порядок Arima модели,
скажем, 2 лага по AR-части,

25
00:02:01,440 --> 00:02:05,890
брать разности и переходить к
Δy не надо и MA-части тоже нет.

26
00:02:05,890 --> 00:02:11,087
Ну для сравнения давайте какую-нибудь
конкурирующую стационарную

27
00:02:11,087 --> 00:02:16,265
тоже модель Arima(y) и порядок равен (1,

28
00:02:16,265 --> 00:02:19,700
0, 1), то есть AR-MA(1,

29
00:02:19,700 --> 00:02:23,900
1) и посмотрим отчет по первой модели.

30
00:02:23,900 --> 00:02:30,840
Здесь мы видим,
что все коэффициенты значимы,

31
00:02:30,840 --> 00:02:35,917
вот оценка коэффициента при AR,
при одном лаге назад,

32
00:02:35,917 --> 00:02:42,420
при yt – 1, вот оценка коэффициента при yt
– 2 и это оценка математического ожидания.

33
00:02:42,420 --> 00:02:45,690
И если каждую оценку поделить
на стандартную ошибку,

34
00:02:45,690 --> 00:02:50,530
здесь 1 делить на 0,1 уходит примерно 10
— коэффициент значим, отличен от нуля.

35
00:02:50,530 --> 00:02:55,937
Здесь –0,25 делить на 0,10, –2,5 —
коэффициент значим, ну и математическое

36
00:02:55,937 --> 00:02:59,390
ожидание, тем более гипотеза о том,
что оно равно нулю отвергается.

37
00:02:59,390 --> 00:03:06,860
Если посмотреть отчет по
модели 2 summary модель 2,

38
00:03:06,860 --> 00:03:12,006
то мы видим примерно такую
же оценку математического

39
00:03:12,006 --> 00:03:17,271
ожидания и здесь тоже оба
коэффициента значимы, соответственно,

40
00:03:17,271 --> 00:03:22,242
мы можем посмотреть, например,
из этих двух моделей какую

41
00:03:22,242 --> 00:03:26,670
выбирает критерий
«штрафной критерий Акаике».

42
00:03:26,670 --> 00:03:30,410
Посчитаем критерий Акаике для модели 1,

43
00:03:30,410 --> 00:03:35,357
посчитаем критерий Акаике
штрафной для модели 2.

44
00:03:35,357 --> 00:03:40,203
Я напомню, чем больше штраф,
тем хуже, то есть модель лучше та,

45
00:03:40,203 --> 00:03:43,045
у которой штрафной критерий меньше.

46
00:03:43,045 --> 00:03:48,416
Да, этот критерий простой, но зато он
позволяет быстро сравнивать модели.

47
00:03:48,416 --> 00:03:51,942
Соответственно, в нашем
случае AIC у модели 2 меньше,

48
00:03:51,942 --> 00:03:54,215
значит модель 2 считается лучше,

49
00:03:54,215 --> 00:03:59,881
она при том же количестве параметров дает
меньше значение суммы квадратов ошибок.

50
00:03:59,881 --> 00:04:03,457
Ну, соответственно,
раз MA-часть сработала,

51
00:04:03,457 --> 00:04:06,580
то может быть разумно оценить модель 3,

52
00:04:06,580 --> 00:04:13,340
куда включить и несколько
лагов по AR-части,

53
00:04:13,340 --> 00:04:18,580
скажем два, и один лаг по MA-части,
то есть модель с тремя параметрами,

54
00:04:18,580 --> 00:04:23,150
и посмотреть summary по модели 3.

55
00:04:23,150 --> 00:04:28,960
И, соответственно,

56
00:04:28,960 --> 00:04:33,510
посмотреть на критерий
Акаике для модели 3.

57
00:04:33,510 --> 00:04:35,734
Ну модель 3 стала чуть-чуть хуже.

58
00:04:35,734 --> 00:04:37,241
Зачем нам нужны модели?

59
00:04:37,241 --> 00:04:39,690
Модели нам позволяют прогнозировать.

60
00:04:39,690 --> 00:04:44,280
Мы можем построить, например, прогнозы,

61
00:04:44,280 --> 00:04:50,019
допустим построим прогноз
прогноз построим,

62
00:04:50,019 --> 00:04:53,860
функция forecast, по модели,

63
00:04:53,860 --> 00:04:57,776
скажем, по модели 2 — она
у нас была чуть получше.

64
00:04:57,776 --> 00:05:01,164
На сколько периодов времени вперед,
здесь у нас один период — это год,

65
00:05:01,164 --> 00:05:04,200
соответственно, на сколько лет вперед,
допустим, на 5 лет вперед.

66
00:05:04,200 --> 00:05:08,235
И для наглядности мы можем построить
график нашего, ну, во-первых,

67
00:05:08,235 --> 00:05:13,792
можно конечно посмотреть на этот прогноз,
что это в числах из себя представляет.

68
00:05:13,792 --> 00:05:15,110
Это такая...

69
00:05:15,110 --> 00:05:20,493
а, я его неправильно назвал,
progroz я его назвал,

70
00:05:20,493 --> 00:05:24,847
prognoz, и, соответственно, это такой ряд,

71
00:05:24,847 --> 00:05:29,212
где предсказаны уровни воды
в озере и доверительный

72
00:05:29,212 --> 00:05:33,826
интервал 80 %-ный и 95 %-ный
доверительный интервал.

73
00:05:33,826 --> 00:05:36,844
И, соответственно,
мы можем построить график,

74
00:05:36,844 --> 00:05:41,225
наглядно изобразить наш прогноз,
и вот здесь видно,

75
00:05:41,225 --> 00:05:46,665
что прогноз на ближайшие 5 лет,
если предполагать стационарность процесса,

76
00:05:46,665 --> 00:05:49,450
то прогноз на ближайшие 5 лет
— что уровень будет снижаться.

77
00:05:49,450 --> 00:05:55,260
Аналогично мы можем построить,
предполагать нестационарность процесса.

78
00:05:55,260 --> 00:05:57,290
Давайте оценим модель 4.

79
00:05:57,290 --> 00:06:00,219
Это будет Arima модель для ряда y.

80
00:06:00,219 --> 00:06:05,665
Порядок модели мы возьмем
пусть будет AR(1)-процесс,

81
00:06:05,665 --> 00:06:08,800
но AR(1)-процесс для Δyt.

82
00:06:08,800 --> 00:06:13,780
То есть мы поставим вот здесь единичку,
предполагая наш ряд нестационарным.

83
00:06:13,780 --> 00:06:20,830
Оценим модель 4,
посмотрим на критерий Акаике для модели 4,

84
00:06:20,830 --> 00:06:25,852
и можем теперь посмотреть,
как выглядят те же

85
00:06:25,852 --> 00:06:31,240
самые прогнозы, только для модели 4,

86
00:06:31,240 --> 00:06:37,190
в которой предполагается нестационарность
нашего ряда на те же пять шагов вперед,

87
00:06:37,190 --> 00:06:40,415
и построим график.

88
00:06:40,415 --> 00:06:45,230
Соответственно, здесь у
нас уже прогноз другой.

89
00:06:45,230 --> 00:06:50,024
Из-за того, что я предполагал, что процесс
является случайным блужданием, то,

90
00:06:50,024 --> 00:06:54,690
соответственно, прогноз, что ряд
будет примерно такой же как сегодня —

91
00:06:54,690 --> 00:06:58,410
это прогноз на будущее, но с
расширяющимся доверительным интервалом.

92
00:06:58,410 --> 00:07:04,621
И чтобы каждый раз не считать AIC мы можем
попросить компьютер из простых моделей

93
00:07:04,621 --> 00:07:09,160
с небольшим количеством лагов, выбрать ту,
у которой AIC минимальный автоматически.

94
00:07:09,160 --> 00:07:14,600
Мы можем оценить какую-то модель
автоматически, давайте назовем ее «модель

95
00:07:14,600 --> 00:07:20,550
автоматически построенная»,
auto.arima для ряда y.

96
00:07:20,550 --> 00:07:23,317
Соответственно, компьютер
что сделает за кадром?

97
00:07:23,317 --> 00:07:28,319
Он сам оценит несколько моделей с разным
количеством лагов по AR и MA-части,

98
00:07:28,319 --> 00:07:32,148
включая и не включая взятие разностей,

99
00:07:32,148 --> 00:07:37,190
переход от yt к Δyt, и выберет
наилучшую модель по критерию Акаике.

100
00:07:37,190 --> 00:07:41,225
Ну и соответственно, можно посмотреть
что же за модель он выбрал,

101
00:07:41,225 --> 00:07:45,926
какая же модель из простых моделей
даем минимальный штрафной критерий.

102
00:07:45,926 --> 00:07:51,114
И вот мы видим, что это модель

103
00:07:51,114 --> 00:07:55,417
с единичным,
с необходимостью взятия разностей,

104
00:07:55,417 --> 00:07:59,580
то есть автоматически по критерию
AIC ряд признан нестационарным,

105
00:07:59,580 --> 00:08:04,943
в среднем с убыванием процесса, то есть
процесс в среднем за каждую единичку

106
00:08:04,943 --> 00:08:09,739
времени убывает на –0,02,
и дальше это MA(4)-процесс.

107
00:08:09,739 --> 00:08:15,690
После устранения убывания и перехода к
разностям у нас получается MA(4)-процесс.

108
00:08:15,690 --> 00:08:20,980
И мы можем, например, спрогнозировать по
нашей автоматически подобранной модели,

109
00:08:20,980 --> 00:08:25,520
прогнозы которой строятся автоматически,

110
00:08:25,520 --> 00:08:30,530
и построим график прогнозов.

111
00:08:35,135 --> 00:08:40,441
Соответственно получилось,
что при использовании модели,

112
00:08:40,441 --> 00:08:46,401
наилучшей по критерию Акаике, получается
что наш прогноз на ближайшие 5 лет,

113
00:08:46,401 --> 00:08:48,922
что уровень воды в озере
Гурон будет падать.

114
00:08:48,922 --> 00:08:52,539
Ну, надо конечно иметь в виду,
что это данные прошлого века,

115
00:08:52,539 --> 00:08:55,920
то есть ближайшие 5 лет —
это не текущее будущее.

