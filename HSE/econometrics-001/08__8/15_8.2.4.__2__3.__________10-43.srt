1
00:00:13,250 --> 00:00:20,454
Перейдем к следующему примеру
с экономическим содержанием,

2
00:00:20,454 --> 00:00:23,810
а именно примеру со стоимостью
акций компаний Google.

3
00:00:23,810 --> 00:00:27,850
Давайте сначала мы загрузим
эти данные из Интернета.

4
00:00:27,850 --> 00:00:33,602
Тут на некоторых компьютерах
нужно небольшое шаманское

5
00:00:33,602 --> 00:00:39,640
заклинание sys.setlocale ("LC_TIME"),
то есть

6
00:00:39,640 --> 00:00:43,490
на некоторых компьютерах сработает без
проблем, но на некоторых вот потребуется

7
00:00:43,490 --> 00:00:48,119
такое маленькое шаманское заклинание
с установкой locale для времени.

8
00:00:48,119 --> 00:00:53,530
Но это связано с тем эффектом,
что даты на разных

9
00:00:53,530 --> 00:00:59,090
языках называются по-разному, иногда не
происходит автоматического распознавания.

10
00:00:59,090 --> 00:01:03,390
Здесь мы установили так, что у нас
будет английский стандарт для дат,

11
00:01:03,390 --> 00:01:06,253
времени и так далее.

12
00:01:06,253 --> 00:01:11,923
И после этого мы можем с
помощью функции getsymbols,

13
00:01:11,923 --> 00:01:15,128
которая входит в пакет quantmod,

14
00:01:15,128 --> 00:01:20,540
мы можем получить данные
по акции компании Google.

15
00:01:20,540 --> 00:01:27,866
Ну, скажем, возьмем за какой-нибудь
период с 2014-го, пусть будет 01-01,

16
00:01:27,866 --> 00:01:34,220
ну давайте возьмем to="2014-

17
00:01:34,220 --> 00:01:38,550
12-01".

18
00:01:38,550 --> 00:01:41,437
Ну то есть за 11 месяцев.

19
00:01:41,437 --> 00:01:46,172
Соответственно, давайте посмотрим на то,

20
00:01:46,172 --> 00:01:50,460
что у нас все загрузилось, head (GOOG).

21
00:01:50,460 --> 00:01:59,135
И вот у нас есть данные по цене открытия,
максимальной цене, минимальной цене,

22
00:01:59,135 --> 00:02:03,982
закрытия, объем торгов и цене,
скорректированной на выплату дивидендов.

23
00:02:03,982 --> 00:02:07,397
Ну поскольку мы моделируем
одномерные временные ряды,

24
00:02:07,397 --> 00:02:10,650
то из этих показателей давайте
возьмем цену закрытия.

25
00:02:10,650 --> 00:02:17,220
То есть мы назовем переменную y, наша
переменная y — это из набора данных GOOG.

26
00:02:17,220 --> 00:02:19,709
Мы выберем GOOG.close.

27
00:02:19,709 --> 00:02:25,030
Так, вот теперь у нас есть
одномерный временной ряд y.

28
00:02:25,030 --> 00:02:30,980
И мы к нему применим наш стандартный
подход — сначала построим три графика.

29
00:02:30,980 --> 00:02:35,220
tsdisplay (y).

30
00:02:39,740 --> 00:02:44,260
И на этот раз мы видим
типичное случайное блуждание.

31
00:02:44,260 --> 00:02:47,737
Вот этот график — прям как
будто мы его сгенерировали

32
00:02:47,737 --> 00:02:50,295
случайным блужданием искусственно.

33
00:02:50,295 --> 00:02:54,355
Во-первых, если ряд находится высоко,
то сегодняшнее значение очень похоже на

34
00:02:54,355 --> 00:02:59,136
вчерашнее, если ряд находится низко,
сегодняшнее значение похоже на вчерашнее.

35
00:02:59,136 --> 00:03:03,272
Медленно убывающей обычной
автокорреляционной функции,

36
00:03:03,272 --> 00:03:06,657
он до конца так,
в доверительный интервал так и не вошли.

37
00:03:06,657 --> 00:03:10,804
И одна частная автокорреляционная
функция не нулевая, остальные нулевые.

38
00:03:10,804 --> 00:03:13,363
Типичный график для случайного блуждания.

39
00:03:13,363 --> 00:03:17,295
Чтобы лишний раз убедиться в этом,
давайте сами возьмем разности,

40
00:03:17,295 --> 00:03:20,160
то есть построим те же самые
показатели для delta y.

41
00:03:20,160 --> 00:03:23,535
Напишем, что dy — это diff (y),

42
00:03:23,535 --> 00:03:29,170
то есть dy — это разница между сегодняшней
ценой акции Гугла и вчерашней.

43
00:03:29,170 --> 00:03:37,400
Перейдем к delta и построим
тот же самый график для dy.

44
00:03:37,400 --> 00:03:43,383
И тут мы увидим, что у нас достаточно,

45
00:03:43,383 --> 00:03:47,970
несмотря на то, что у нас
достаточно длинный временной ряд,

46
00:03:47,970 --> 00:03:54,102
порядка 200 наблюдений, у нас получается,
что нету у него, все автокорреляции

47
00:03:54,102 --> 00:03:58,411
равны 0 и частные автокорреляции тоже,
в принципе, все равны 0.

48
00:03:58,411 --> 00:04:01,490
То есть это говорит о том,
что этот ряд — это белый шум.

49
00:04:01,490 --> 00:04:07,029
То есть исходный ряд был у нас
процессом случайного блуждания.

50
00:04:07,029 --> 00:04:12,280
Ну и тем не менее мы можем попробовать
оценить какие-нибудь модели.

51
00:04:12,280 --> 00:04:16,090
Пусть будет модель_1, соответственно
1-я модель, мы предполагаем,

52
00:04:16,090 --> 00:04:21,420
что это случайное блуждание,
Arima для ряда y.

53
00:04:21,420 --> 00:04:26,490
И мы предполагаем, что порядок: 0, 1, 0.

54
00:04:26,490 --> 00:04:32,050
То есть это — модель чистого
случайного блуждания.

55
00:04:32,050 --> 00:04:35,101
Можно посмотреть,
конечно, четкую модель_1,

56
00:04:35,101 --> 00:04:39,716
но на самом деле здесь в модели_1 нет даже
никаких коэффициентов, не оценивалось.

57
00:04:39,716 --> 00:04:43,200
Нет ни коэффициента при AR-части,
ни коэффициента при МА-части.

58
00:04:43,200 --> 00:04:48,310
Есть только sigma квадрат с
крышкой оцененное, это дисперсия.

59
00:04:48,310 --> 00:04:51,251
И соответственно,
при прогнозировании по такой модели,

60
00:04:51,251 --> 00:04:55,849
естественный прогноз будет выглядеть, что
завтрашний показатель такой же, как вчера,

61
00:04:55,849 --> 00:04:58,690
но оценка модели,
помимо этого тривиального ответа,

62
00:04:58,690 --> 00:05:03,780
она мне еще даст доверительный интервал,
в каких пределах я ожидаю будущую цену.

63
00:05:03,780 --> 00:05:09,840
То есть я могу взять,
сделать прогноз по модели_1,

64
00:05:09,840 --> 00:05:14,813
это будет forecast от модель_1,
ну, к примеру,

65
00:05:14,813 --> 00:05:18,669
построю прогноз на 20 дней вперед.

66
00:05:18,669 --> 00:05:24,100
Ну можно опять же посмотреть
на этот прогноз_1,

67
00:05:24,100 --> 00:05:27,049
вот значение и доверительный интервал.

68
00:05:27,049 --> 00:05:31,971
То есть значение, тут ничего
удивительного нет, это — текущая цена.

69
00:05:31,971 --> 00:05:35,656
А это — доверительные интервалы
с учетом оцененной дисперсии.

70
00:05:35,656 --> 00:05:40,070
Можно на графике посмотреть,
как это выглядит, prognoz_1.

71
00:05:40,070 --> 00:05:47,283
Соответственно, вот из-за того,
что у ряда довольно большие колебания,

72
00:05:47,283 --> 00:05:50,330
вот у нас доверительный интервал
со временем расширяется.

73
00:05:50,330 --> 00:05:54,966
Опять же можно посмотреть,
какую модель компьютер выберет сам,

74
00:05:54,966 --> 00:05:57,210
минимизируя критерий Акаике.

75
00:05:57,210 --> 00:06:01,440
Давайте посмотрим,
модель автоматическая как выглядит.

76
00:06:01,440 --> 00:06:09,760
auto.arima для ряда y.

77
00:06:09,760 --> 00:06:15,440
И посмотрим какая модель минимизирует
критерий штрафной Акаике.

78
00:06:15,440 --> 00:06:19,870
Ну вот, оказывается, компьютер подбирает
ту же самую модель, что и мы подобрали.

79
00:06:19,870 --> 00:06:24,743
Зачастую так оказывается, что ряды цен

80
00:06:24,743 --> 00:06:29,900
акций — это ряды типа «случайное
блуждание» или очень похожие на них.

81
00:06:29,900 --> 00:06:34,642
Связано это с тем, что очень много людей
пытаются сделать деньги и поэтому чего-то

82
00:06:34,642 --> 00:06:39,845
очевидного, каких-то прогнозов: лучше,
чем; такое же как сегодня,

83
00:06:39,845 --> 00:06:44,738
если бы они были очень легкими, то все бы
их делали, и соответственно, это приводило

84
00:06:44,738 --> 00:06:49,790
бы к тому, что цена акций выравнивалась
к процессу случайного блуждания.

85
00:06:49,790 --> 00:06:52,836
Что-то тут найти довольно сложно.

86
00:06:52,836 --> 00:06:56,770
Давайте возьмем следующий пример ряда.

87
00:06:56,770 --> 00:06:59,886
Это ряд по населению России.

88
00:06:59,886 --> 00:07:02,630
Давайте мы загрузим его.

89
00:07:02,630 --> 00:07:07,060
Зайдем на сайт sophisthse.ru,

90
00:07:07,060 --> 00:07:12,240
возьмем тут статистические ряды.

91
00:07:12,240 --> 00:07:17,125
И вот здесь население и трудовые ресурсы.

92
00:07:17,125 --> 00:07:20,826
Вот есть численность населения,
ряд называется, вот годовые показатели,

93
00:07:20,826 --> 00:07:22,365
ряд называется POPNUM_ Y.

94
00:07:22,365 --> 00:07:28,467
Соответственно, открываем
R-STUDIO и здесь говорим,

95
00:07:28,467 --> 00:07:31,900
что y равняется sophisthse.

96
00:07:31,900 --> 00:07:36,691
И ряд называется, большими буквами,
так же, как он был назван на сайте,

97
00:07:36,691 --> 00:07:37,840
"POPNUM_Y".

98
00:07:37,840 --> 00:07:45,429
Вот, ряд у нас загрузился,
и мы можем на него посмотреть,

99
00:07:45,429 --> 00:07:50,080
сделать наш стандартный график из
трех составляющих tsdisplay (y).

100
00:07:50,080 --> 00:07:55,668
Тут мы видим следующее, что, к сожалению,

101
00:07:55,668 --> 00:07:59,868
это, конечно, короткий ряд,

102
00:07:59,868 --> 00:08:05,623
то есть здесь всего-то 25 наблюдений,
это годовые данные.

103
00:08:05,623 --> 00:08:10,767
Но все же по графику я бы сказал,
что это похоже на случайное блуждание.

104
00:08:10,767 --> 00:08:15,080
Сегодняшний показатель уж больно
похож на вчерашний каждый раз.

105
00:08:15,080 --> 00:08:18,470
Медленно убывает
автокорреляционная функция.

106
00:08:18,470 --> 00:08:22,574
Поэтому я бы моделировал вот этот
ряд случайным блужданием, возможно,

107
00:08:22,574 --> 00:08:23,840
с некоторым трендом.

108
00:08:23,840 --> 00:08:28,570
Соответственно, если
исходить из такого подхода,

109
00:08:28,570 --> 00:08:37,040
то можно попробовать построить
модель_1 для нашего ряда, это — Arima.

110
00:08:37,040 --> 00:08:44,660
Для ряда y порядок Arima равен: 0, 1, 0.

111
00:08:44,660 --> 00:08:47,066
То есть случайное блуждание.

112
00:08:47,066 --> 00:08:51,050
Можно, например, добавить AR-составляющую.

113
00:08:51,050 --> 00:08:56,987
И, скажем, поставить опцию,
что здесь есть, возможно,

114
00:08:56,987 --> 00:09:01,930
смещение TRUE, поскольку ряд в целом
показывает некую тенденцию к убыванию.

115
00:09:01,930 --> 00:09:05,147
И оценив такую модель,
мы можем, во-первых,

116
00:09:05,147 --> 00:09:07,740
посмотреть на оценки коэффициентов.

117
00:09:11,975 --> 00:09:15,957
Так, вот summary модель_1,

118
00:09:15,957 --> 00:09:22,105
то есть, и, соответственно,

119
00:09:22,105 --> 00:09:27,140
помимо оценок коэффициентов,
мы можем построить прогнозы.

120
00:09:27,140 --> 00:09:31,739
Поскольку коэффициенты плохо
интерпретируются в моделях класса Arima,

121
00:09:31,739 --> 00:09:34,240
то нам удобней посмотреть на прогнозы.

122
00:09:34,240 --> 00:09:38,360
forecast по модели_1 на,

123
00:09:38,360 --> 00:09:42,303
допустим, 5 лет вперед,

124
00:09:42,303 --> 00:09:48,490
и построим график plot(prognoz_1).

125
00:09:48,490 --> 00:09:54,071
Вот, и, соответственно,
на этом графике мы видим,

126
00:09:54,071 --> 00:09:59,225
что, ну в зависимости от того,
оптимист вы или пессимист, вот,

127
00:09:59,225 --> 00:10:06,308
возможно, в 80 % доверительном интервале
есть и тенденция роста населения России,

128
00:10:06,308 --> 00:10:10,624
но при вот такой глобальной
динамике с 90-го года — убывание,

129
00:10:10,624 --> 00:10:16,150
то как бы прогноз глобальный все-таки,
что средняя убывает, хотя опять же

130
00:10:16,150 --> 00:10:20,850
вопрос в том, изменились ли характеристики
ряда или они остались теми же?

131
00:10:20,850 --> 00:10:23,569
Может быть,
произошли какие-то структурные изменения,

132
00:10:23,569 --> 00:10:25,550
которые резко переломили здесь динамику?

133
00:10:25,550 --> 00:10:29,592
Но если предполагать, что ряд описывается
одним и тем же процессом Arima,

134
00:10:29,592 --> 00:10:33,619
который мы предположили,
то тогда средний прогноз убывающий,

135
00:10:33,619 --> 00:10:39,320
ну и есть возможность роста в
80 % доверительном интервале.

