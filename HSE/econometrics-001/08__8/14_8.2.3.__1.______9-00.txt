Теперь перейдем к оценке реальных данных.
Для начала рассмотрим физический
показатель — уровень воды в одном озере.
Мы возьмем для начала
встроенный в R набор данных.
В R есть встроенный набор
данных по уровню озера Гурон,
можно почитать в Википедии что
это такое за большое озеро.
Мы пользуемся им для простоты,
поскольку это встроенный набор данных.
И, соответственно,
строим для нашего реального набора
данных три стандартных графика.
График самого временного ряда, график
автокорреляционной функции выборочный и
график частной автокорреляционной функции.
На этих трех графиках мы видим,
что наш ряд y занимает какое-то
компромиссное положение между с одной
стороны стационарным процессом,
а с другой стороны чем-то похоже уже
на коротенькое случайное блуждание.
Потому что частная автокорреляционная
функция хотя и убывает, но все-таки
убывает не так быстро, как это было бы
у идеального стационарного процесса.
Поэтому здесь как раз спорная ситуация и
можно попробовать моделировать его как
стационарным процессом, скажем взять
какой-нибудь AR с несколькими лагами, вот
здесь две первых частных автокорреляции
не равны нулю, можно взять AR(2),
либо попробовать
нестационарный временной ряд,
то есть перейти к приращениям,
к Δyt и моделировать Δyt.
Давайте попробуем оба подхода.
Модель 1
Arima модель для ряда y,
порядок Arima модели,
скажем, 2 лага по AR-части,
брать разности и переходить к
Δy не надо и MA-части тоже нет.
Ну для сравнения давайте какую-нибудь
конкурирующую стационарную
тоже модель Arima(y) и порядок равен (1,
0, 1), то есть AR-MA(1,
1) и посмотрим отчет по первой модели.
Здесь мы видим,
что все коэффициенты значимы,
вот оценка коэффициента при AR,
при одном лаге назад,
при yt – 1, вот оценка коэффициента при yt
– 2 и это оценка математического ожидания.
И если каждую оценку поделить
на стандартную ошибку,
здесь 1 делить на 0,1 уходит примерно 10
— коэффициент значим, отличен от нуля.
Здесь –0,25 делить на 0,10, –2,5 —
коэффициент значим, ну и математическое
ожидание, тем более гипотеза о том,
что оно равно нулю отвергается.
Если посмотреть отчет по
модели 2 summary модель 2,
то мы видим примерно такую
же оценку математического
ожидания и здесь тоже оба
коэффициента значимы, соответственно,
мы можем посмотреть, например,
из этих двух моделей какую
выбирает критерий
«штрафной критерий Акаике».
Посчитаем критерий Акаике для модели 1,
посчитаем критерий Акаике
штрафной для модели 2.
Я напомню, чем больше штраф,
тем хуже, то есть модель лучше та,
у которой штрафной критерий меньше.
Да, этот критерий простой, но зато он
позволяет быстро сравнивать модели.
Соответственно, в нашем
случае AIC у модели 2 меньше,
значит модель 2 считается лучше,
она при том же количестве параметров дает
меньше значение суммы квадратов ошибок.
Ну, соответственно,
раз MA-часть сработала,
то может быть разумно оценить модель 3,
куда включить и несколько
лагов по AR-части,
скажем два, и один лаг по MA-части,
то есть модель с тремя параметрами,
и посмотреть summary по модели 3.
И, соответственно,
посмотреть на критерий
Акаике для модели 3.
Ну модель 3 стала чуть-чуть хуже.
Зачем нам нужны модели?
Модели нам позволяют прогнозировать.
Мы можем построить, например, прогнозы,
допустим построим прогноз
прогноз построим,
функция forecast, по модели,
скажем, по модели 2 — она
у нас была чуть получше.
На сколько периодов времени вперед,
здесь у нас один период — это год,
соответственно, на сколько лет вперед,
допустим, на 5 лет вперед.
И для наглядности мы можем построить
график нашего, ну, во-первых,
можно конечно посмотреть на этот прогноз,
что это в числах из себя представляет.
Это такая...
а, я его неправильно назвал,
progroz я его назвал,
prognoz, и, соответственно, это такой ряд,
где предсказаны уровни воды
в озере и доверительный
интервал 80 %-ный и 95 %-ный
доверительный интервал.
И, соответственно,
мы можем построить график,
наглядно изобразить наш прогноз,
и вот здесь видно,
что прогноз на ближайшие 5 лет,
если предполагать стационарность процесса,
то прогноз на ближайшие 5 лет
— что уровень будет снижаться.
Аналогично мы можем построить,
предполагать нестационарность процесса.
Давайте оценим модель 4.
Это будет Arima модель для ряда y.
Порядок модели мы возьмем
пусть будет AR(1)-процесс,
но AR(1)-процесс для Δyt.
То есть мы поставим вот здесь единичку,
предполагая наш ряд нестационарным.
Оценим модель 4,
посмотрим на критерий Акаике для модели 4,
и можем теперь посмотреть,
как выглядят те же
самые прогнозы, только для модели 4,
в которой предполагается нестационарность
нашего ряда на те же пять шагов вперед,
и построим график.
Соответственно, здесь у
нас уже прогноз другой.
Из-за того, что я предполагал, что процесс
является случайным блужданием, то,
соответственно, прогноз, что ряд
будет примерно такой же как сегодня —
это прогноз на будущее, но с
расширяющимся доверительным интервалом.
И чтобы каждый раз не считать AIC мы можем
попросить компьютер из простых моделей
с небольшим количеством лагов, выбрать ту,
у которой AIC минимальный автоматически.
Мы можем оценить какую-то модель
автоматически, давайте назовем ее «модель
автоматически построенная»,
auto.arima для ряда y.
Соответственно, компьютер
что сделает за кадром?
Он сам оценит несколько моделей с разным
количеством лагов по AR и MA-части,
включая и не включая взятие разностей,
переход от yt к Δyt, и выберет
наилучшую модель по критерию Акаике.
Ну и соответственно, можно посмотреть
что же за модель он выбрал,
какая же модель из простых моделей
даем минимальный штрафной критерий.
И вот мы видим, что это модель
с единичным,
с необходимостью взятия разностей,
то есть автоматически по критерию
AIC ряд признан нестационарным,
в среднем с убыванием процесса, то есть
процесс в среднем за каждую единичку
времени убывает на –0,02,
и дальше это MA(4)-процесс.
После устранения убывания и перехода к
разностям у нас получается MA(4)-процесс.
И мы можем, например, спрогнозировать по
нашей автоматически подобранной модели,
прогнозы которой строятся автоматически,
и построим график прогнозов.
Соответственно получилось,
что при использовании модели,
наилучшей по критерию Акаике, получается
что наш прогноз на ближайшие 5 лет,
что уровень воды в озере
Гурон будет падать.
Ну, надо конечно иметь в виду,
что это данные прошлого века,
то есть ближайшие 5 лет —
это не текущее будущее.

