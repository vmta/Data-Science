В реальности мы заинтересованы
в построении прогнозов.
Прогноз на h шагов вперед — формально это
условное математическое ожидание от Yt + h
| при условии того,
что Yt и все предыдущие: (Yt- 1, Yt- 2,...
) известны.
Ну, для краткости на практике его часто,
чтобы не тащить вот этого крокодила,
обозначают Y (с крышечкой) t + h, имея в
виду под записью t + h, что это прогноз,
когда мне известна вся
информация вплоть до момента t,
а прогнозирую я на h шагов в будущее.
И давайте для конкретного примера
спрогнозируем на один и два шага вперед,
построим точечный прогноз
и интервальный прогноз,
то есть построим предиктивный интервал.
Наша задача построить точечные и
интервальные прогнозы в рамках AR модели.
Итак, у нас есть готовая
AR модель: Yt = 2 +
0,5*Y(t- 1)- 0,06*Y(t- 2) + εt,
мы считаем,
что εt имеет нормальное распределение с
конкретным математическим ожиданием
0 и конкретной дисперсией 4.
У нас есть данные по
прошлым наблюдениям: Y1,...
Y100.
И скажем, известно,
что Y99 = 3, а Y100 = 4.
И наша задача: a)
составить точеный прогноз,
то есть Y(с крышечкой) 100 + 1,
ну, так я подчеркиваю,
что это прогноз с 100-го шага на один
шаг вперед и Y(с крышечкой)100 + 2,
b) посчитать дисперсию ошибки прогноза,
то есть посчитать Var(Y101 - Y(с
крышечкой)100 + 1 при условии,
что я знаю все текущие игреки, Y1,...
Y100 мне известны.
Посчитать аналогично дисперсию ошибки
прогноза на два шага вперед, при условии,
что я знаю все игреки до
текущего момента времени.
И руководствуясь a и b, далее уже следуют
легкие пункты, если мы сделали a и b,
то построить 95 % доверительный
интервал для будущих...
построить 95 % предиктивный интервал,
предиктивный интервал
для будущих Y101 и Y102.
Первый пункт a.
Мы вспоминаем,
как мы строим прогнозы в рамках AR модели.
Мы строим прогнозы,
беря условное математическое ожидание,
то есть мы берем E(Y101 при условии,
что мы знаем все игреки, Y100, Y99,...
) Мы подставляем формулу для Y101.
Вот она.
Это есть E(2
+ 0,5*Y100-
0,06 *Y99
+ ε101 при условии,
что я знаю все до момента времени 100.
Естественно, при таком подходе Y100
и Y99 для меня это просто известные числа,
а вот Y101 — это случайная величина,
не зависит от информации,
которой я обладаю.
Поэтому ее условное математическое
ожидание равно безусловному и равно 0.
Я получаю 2 + 0,5, поскольку Y100 — это
то, что я знаю, то я просто подставляю,
раз я его знаю, это 4- 0,06*3 + 0.
Я получаю, что это 2 +
2- 0,18
и получается в результате 3,82.
Это точечный прогноз на один шаг вперед.
Аналогично мы строим прогноз
точечный на два шага
вперед: Y (с крышечкой)100
+ 2 равняется...
Подставляем формулу для
условного математического
ожидания E(Y102, при условии,
что я знаю Y100, Y99,...
) = Подставляем формулу для Y102.
Это условное математическое
ожидание E от (2 +
0,5 *Y101-
0,06*Y100 + ε102| при условии,
что я знаю игреки с сотого и более ранние.
Смотрите: Y100 я знаю,
ε102 не зависит,
—это будущая случайная составляющая,
— не зависит от того, что я знаю.
А E(Y101 при условии Y100, Y99,...
) мы уже считали.
Собственно, вот она.
Вот она.
Мы ее уже считали.
Поэтому это можно просто написать,
что это 3,82.
И теперь у нас есть все ингредиенты.
Мы можем смешать их и получить Y (с
крышкой) точечный прогноз на два шага
вперед.
Мы получим 2 + 0,5 помножить на уже
найденное нами математическое
ожидание от Y101 условно,
это 3,82- 0,06*
Y100 (4) и + 0.
Упрощаем и получаем
2 плюс половина от 3,82,
это 1,91 и
минус (6 * 4 это 24)
и мы в результате получаем результат 3,67.
Соответственно, мы построили
прогноз на один шаг вперед
точечный и на два шага вперед
тоже точечный прогноз.
Теперь перейдем к дисперсии
ошибки прогноза, к пункту b.
Пункт b.
Посчитаем Var(Y101- Y
(с крышечкой) 100 + 1 при условии,
что я знаю Y1,...
Y100) Давайте сначала немножко
упростим эту формулу.
Конечно, это ошибка прогноза,
но как я строю свой прогноз?
Мой прогноз он зависит только от того,
что я знаю.
Построить прогноз, который бы зависел от
того, чего вы не знаете, не получится.
Поэтому раз Y (с крышкой) 100
+ 1 строится на основании того,
что я знаю, то, с моей точки зрения,
это известная величина, и она на
дисперсию никак не влияет на условную.
Поэтому я получаю Var(Y101
при условии Y1,...
Y100) Ну вот теперь подставлю.
Получится условная
дисперсия Var(2 + 0,5*Y100
- 0,06 *Y99 +
ε101 | при условии, что я знаю Y1, ...
Y100).
Опять же,
Y100 — это известная мне величина.
Y99 — это известная мне величина.
И 2 — это, вообще, константа, поэтому
на условную дисперсию они не влияют.
Получается условная
дисперсия Var(ε101 при условии Y1,...
Y100) Но ε101, будущий шум,
никак не зависит от текущих игреков,
поэтому условная дисперсия
превращается в безусловную
Var(ε101) и она по условию равна 4.
И аналогично мы можем посчитать дисперсию
ошибки прогноза на два шага вперед.
Var(Y102 -
Y (с крышкой) 100 + 2 |
при условии, что я знаю Y1,...
Y100) равняется...
Опять же, прогноз строится на
основании известной мне информации,
поэтому на разброс ошибки не влияет.
Это есть просто дисперсия.
y 102 при условии y1,..., y100.
Итак, нам надо посчитать
дисперсию y102 при условии,
что я знаю y1,..., y100.
Я быстренько напомню уравнение,
что yt = 2 + 0,5yt − 1
− 0,06yt − 2 + εt.
Подставляем y102 сюда,
получаем дисперсию 2
+ 0,5 на y101 −
0,06 на y100 + ε102 при условии,
что я знаю y1, ..., y100.
Поскольку величины y1,
y100 мне известны, то 0,06 y100 —
для меня это известная величина, она не
прибавляет дисперсию 2, это — константа.
Соответственно, остается дисперсия 0,5
на y101 + ε102 при условии,
что я знаю, что y1,..., y100.
Подставляем y101, пользуясь той
же самой рекуррентной формулой.
Дисперсия 0,5 помножить на
2 + 0,5 на y100,
− 0,06 на
y99 + ε101,
и плюс еще ε102 при условии,
что я знаю y1,..., y100.
Что мне здесь известно?
y100 мне известна.
y99 известна, 2- константа, поэтому их
можно в дисперсии никак не отражать.
И у меня, наконец,
останется совсем простое выражение: 0,5
на ε101 + ε102 при условии y1,...
y100.
Но и ε102 и ε102 не зависят от того,
что я знаю,
никак с ним не связаны,
поэтому это просто безусловная дисперсия.
0,5 на ε101 + ε102,
и это есть 0,5 в квадрате
на дисперсию ε101.
Тут я напомню, что εt предполагались
нормальными с математическим
ожиданием 0 и дисперсией 4,
то здесь я получу 0,5 на 4,
плюс дисперсия 102 — тоже 4.
Получится одна четверть от 4-х +4,
получится 5.
А дальше все просто.
Доверительный интервал,
пункт с) 95 % предиктивный,
предиктивный интервал
для y101 будет
строиться по принципу:
от y100+1(с крышечкой),
от нашего прогноза, минус,
если я говорю про нормальное
распределение и возьму 95 % квантиль,
вернее границы для
доверительного интервала 95 %,
у меня получится от −1,96 до 1,96.
Я напомню еще раз, вот эту 1,96 можно
получить в R как q квантиль нормального
распределения порядка 0,975.
Значит доверительный интервал
будет от y(с крышкой)
100 + 1 −1,96,
помножить на стандартную ошибку,
а стандартная ошибка —
это была корень из 4-х.
Но, соответственно,
y100 + 1 (с крышечкой) + 1,96
помножить на корень из 4-х.
И если мы подставим посчитанное
нами y 100 + 1(с крышечкой),
то мы получим предиктивный
интервал от −0,10 до 7,74.
Аналогично поступая с
предиктивным интервалом для y102,
мы получим интервал от точечного
прогноза 100 + 2 − 1,96
помножить на корень из, на этот раз 5-ти,
до y(с крышечкой) 100 + 2
+ 1,96 на корень из 5-ти.
Если выполнить арифметические действия,
то получится доверительный
интервал от −0,71 до 8,05.
Соответственно, мы получили
возможность строить
точечные и интервальные прогнозы
в модели авторегрессии.

