1
00:00:12,950 --> 00:00:19,114
Помимо обычной автокорреляционной функции,

2
00:00:19,114 --> 00:00:22,530
у каждого стационарного процесса есть
частная автокорреляционная функция.

3
00:00:22,530 --> 00:00:27,433
Прежде чем переходить к формальному
определению и способу подсчёта,

4
00:00:27,433 --> 00:00:31,170
давайте сначала разберёмся с идеей
частной автокорреляционной функции.

5
00:00:31,170 --> 00:00:34,836
Рассмотрим четыре случайные величины,

6
00:00:34,836 --> 00:00:39,179
следующие подряд: y1, y2, y3, y4.

7
00:00:39,179 --> 00:00:46,653
Мы хотим измерить прямой эффект
— как y1 воздействует на y4.

8
00:00:46,653 --> 00:00:50,968
Естественно, есть совокупный эффект,

9
00:00:50,968 --> 00:00:56,212
когда меняется y1, меняется y2 —
отчасти по своим каким-то причинам,

10
00:00:56,212 --> 00:01:00,192
отчасти из-за того, что y1 поменялся,
— потом как-то это все воздействует на y2,

11
00:01:00,192 --> 00:01:04,670
потом на y3 и, наконец, всё доходит до y4.

12
00:01:04,670 --> 00:01:08,728
Соответственно, частная автокорреляция,

13
00:01:08,728 --> 00:01:12,360
— она меряет прямой эффект, то есть то,

14
00:01:12,360 --> 00:01:18,000
насколько изменился бы y4,
если бы y1 поменялся на единичку,

15
00:01:18,000 --> 00:01:22,019
а y2, y3 остались бы неизменными.

16
00:01:22,019 --> 00:01:26,313
В то время как обычная корреляция ρ3,

17
00:01:26,313 --> 00:01:32,449
— она меряет совокупный
эффект воздействия y1 на y4,

18
00:01:32,449 --> 00:01:38,763
то есть насколько в среднем изменится y4,
если y1 изменится на единичку,

19
00:01:38,763 --> 00:01:43,000
и ничего неизвестно про
промежуточный y2 и y3.

20
00:01:43,000 --> 00:01:48,540
Формальное определение частной
автокорреляции может несколько

21
00:01:48,540 --> 00:01:54,450
быть непривычным, но по сути оно
как раз и реализует эту идею.

22
00:01:54,450 --> 00:02:02,339
Частная корреляция φk на самом деле — это
обычная корреляция между yt и yt ‒ k,

23
00:02:02,339 --> 00:02:07,370
только yt и yt ‒ k должны быть очищены от

24
00:02:07,370 --> 00:02:14,736
влияния промежуточных случайных величин:
yt ‒ 1, yt ‒ 2,..., yt ‒ k + 1.

25
00:02:14,736 --> 00:02:18,200
И эта очистка от влияния,
то есть это фиксирование,

26
00:02:18,200 --> 00:02:23,015
осуществляется с помощью проецирования,
то есть мы из yt вычитаем

27
00:02:23,015 --> 00:02:29,165
проекцию yt на множество
случайных величин,

28
00:02:29,165 --> 00:02:33,920
которые линейно выражаются через yt ‒ 1,
yt ‒ 2,..., yt ‒ k + 1.

29
00:02:33,920 --> 00:02:39,794
И точно также yt ‒ k
проецируется на yt ‒ 1,

30
00:02:39,794 --> 00:02:42,711
yt ‒ 2,..., yt ‒ k + 1.

31
00:02:42,711 --> 00:02:48,824
Получается разница, то есть очищенный
yt от влияния промежуточных величин,

32
00:02:48,824 --> 00:02:53,371
очищенный yt ‒ k от промежуточных величин,
и считается между

33
00:02:53,371 --> 00:02:58,050
очищенными yt и yt ‒ k,
считается обычная корреляция.

34
00:02:58,050 --> 00:03:03,020
Но опять же это определение — это
ещё не совсем способ подсчёта.

35
00:03:03,020 --> 00:03:07,990
Способ подсчёта по принципу делай раз,
делай два состоит в следующем.

36
00:03:07,990 --> 00:03:11,830
Мы будем последовательно решать
системы линейных уравнений.

37
00:03:11,830 --> 00:03:14,965
Из одной системы линейных
уравнений мы найдём φ1,

38
00:03:14,965 --> 00:03:19,405
из другой системы уравнений мы
найдём частную автокорреляцию φ2,

39
00:03:19,405 --> 00:03:24,975
из третьей системы уравнений мы найдем
частную автокорреляцию φ3 и так далее.

40
00:03:24,975 --> 00:03:30,340
Соответственно, первая система уравнений
состоит всего из одного уравнения,

41
00:03:30,340 --> 00:03:34,693
а именно: γ0,
то есть дисперсия процесса yt,

42
00:03:34,693 --> 00:03:39,885
помножить на частную
автокорреляцию φ1 равняется γ1,

43
00:03:39,885 --> 00:03:42,740
то есть ковариация yt и yt ‒ 1.

44
00:03:42,740 --> 00:03:46,430
Из этой страшной системы
уравнений мы найдём φ1.

45
00:03:46,430 --> 00:03:48,047
Дальше, чтобы найти φ2,

46
00:03:48,047 --> 00:03:53,190
нам потребуется система линейных уравнений
из двух уравнений с двумя неизвестными.

47
00:03:53,190 --> 00:03:57,930
Одна неизвестная, *1, она будет лишней,
вспомогательной и никак нам не нужна,

48
00:03:57,930 --> 00:04:00,420
и ценности для нас представлять не будет.

49
00:04:00,420 --> 00:04:03,680
А из этой системы уравнений
нам будет нужна только φ2.

50
00:04:03,680 --> 00:04:07,647
Заметьте, как устроена
эта система уравнений.

51
00:04:07,647 --> 00:04:12,284
Справа, в правом столбике находятся γ1,
γ2, а слева,

52
00:04:12,284 --> 00:04:15,775
вот если представить
себе квадратную табличку,

53
00:04:15,775 --> 00:04:21,050
которая отвечает за систему уравнений,
то по диагонали идёт γ0,

54
00:04:21,050 --> 00:04:26,270
γ0, и рядом с главной диагональю γ0,
γ0 идёт γ1, γ1.

55
00:04:26,270 --> 00:04:31,550
И теперь перейдём к случаю,
когда надо найти φ3.

56
00:04:31,550 --> 00:04:36,830
Тогда потребуется решить систему из
трех уравнений с тремя неизвестными.

57
00:04:36,830 --> 00:04:43,054
Но опять же две неизвестные *1 и *2 нас
интересовать вообще никак не будут, будут

58
00:04:43,054 --> 00:04:47,150
вспомогательными, — нас будет интересовать
из этой системы уравнений только φ3.

59
00:04:47,150 --> 00:04:51,140
И, соответственно,
как будет выглядеть эта система уравнений?

60
00:04:51,140 --> 00:04:53,800
В правой стороне — столбик γ1, γ2, γ3.

61
00:04:53,800 --> 00:04:58,778
В левой части уравнения по диагонали γ0,
γ0,

62
00:04:58,778 --> 00:05:02,351
γ0, чуть сбоку от диагонали γ1, γ1, γ1,

63
00:05:02,351 --> 00:05:07,026
γ1, и совсем далеко от диагонали
— γ2 и γ2 коэффициенты.

64
00:05:07,026 --> 00:05:11,755
Соответственно, решая эту систему
уравнений, мы найдём среди прочего φ3,

65
00:05:11,755 --> 00:05:13,760
ну нам, собственно, только оно и нужно.

66
00:05:13,760 --> 00:05:18,497
И теперь рассмотрим на конкретном примере,

67
00:05:18,497 --> 00:05:24,240
как у процесса скользящего среднего MA(2)
найти частную автокорреляционную функцию.

68
00:05:24,240 --> 00:05:29,452
Рассмотрим пример нашего процесса: yt

69
00:05:29,452 --> 00:05:35,170
= 5 + εt + 3εt ‒ 1 ‒ 2εt ‒ 2,

70
00:05:35,170 --> 00:05:38,860
где εt — это белый шум.

71
00:05:38,860 --> 00:05:44,990
Мы предполагаем,
что у этого белого шума дисперсия

72
00:05:44,990 --> 00:05:50,695
равна σ-квадрат.

73
00:05:50,695 --> 00:05:53,846
И наша задача — найти частную
автокорреляционную функцию,

74
00:05:53,846 --> 00:05:56,400
первые несколько её значений: φ1, φ2, φ3.

75
00:05:56,400 --> 00:06:01,285
Для того чтобы найти частную
автокорреляционную функцию,

76
00:06:01,285 --> 00:06:06,170
мы будем решать всё более и более
крупные системы линейных уравнений,

77
00:06:06,170 --> 00:06:11,786
и для того чтобы их составить, нам
потребуется автоковариационная функция,

78
00:06:11,786 --> 00:06:16,120
то есть нам потребуется для начала γk,
которую мы уже находили,

79
00:06:16,120 --> 00:06:22,090
которая есть ковариация между
y сегодня и y k шагов назад.

80
00:06:22,090 --> 00:06:28,327
Мы уже находили эту функцию,
и она равна: 14 σ-квадрат,

81
00:06:28,327 --> 00:06:31,870
если k = 0; ‒ 3 σ-квадрат,

82
00:06:31,870 --> 00:06:36,114
если k = 1; ‒ 2 σ-квадрат,

83
00:06:36,114 --> 00:06:43,330
если k = 2; и 0 при больших k,
то есть больше либо равного 3.

84
00:06:43,330 --> 00:06:44,990
Ну, поехали.

85
00:06:44,990 --> 00:06:49,696
Система уравнений для φ1 очень простая,
это одно уравнение,

86
00:06:49,696 --> 00:06:58,280
и выглядит оно безумно
просто: γ0 * φ1 = γ1.

87
00:06:58,280 --> 00:07:02,730
Отсюда мы получаем, что первая частная

88
00:07:02,730 --> 00:07:07,180
автокорреляционная функция на шаге 1,
— она равна γ1/γ0.

89
00:07:07,180 --> 00:07:12,080
Ну подставляем, получаем ‒ 3/14,

90
00:07:12,080 --> 00:07:15,490
а σ-квадрат благополучно сокращается.

91
00:07:15,490 --> 00:07:20,060
Естественно, можно заметить,
что всегда, собственно, φ1 = ρ1,

92
00:07:20,060 --> 00:07:24,630
потому что никакой разницы между ними,
когда шаг равен единичке, нет.

93
00:07:24,630 --> 00:07:30,740
Есть у меня yt ‒ 1,
он как-то воздействует на yt,

94
00:07:30,740 --> 00:07:35,250
и вот этот эффект — его меряет и ρ1, и φ1.

95
00:07:35,250 --> 00:07:38,310
С φ2 уже чуть более интересно.

96
00:07:38,310 --> 00:07:43,010
Чтобы найти φ2, нам потребуется система с
двумя уравнениями и двумя неизвестными:

97
00:07:43,010 --> 00:07:46,990
одной лишней, ненужной,
ну другой, собственно, φ2.

98
00:07:46,990 --> 00:07:49,201
Система будет следующая.

99
00:07:49,201 --> 00:07:54,860
Расставляем по диагонали γ0,
и потом рядом с диагональю — γ1.

100
00:07:54,860 --> 00:07:58,809
Тут будет какая-то
бесполезная неизвестная,

101
00:07:58,809 --> 00:08:04,290
обозначим её *1,
а потом будет полезная неизвестная φ2.

102
00:08:04,290 --> 00:08:09,770
И здесь будет γ1, γ2.

103
00:08:09,770 --> 00:08:15,539
Вот такая система уравнений, и сейчас
мы из неё найдем, соответственно, φ2.

104
00:08:15,539 --> 00:08:16,800
Ну как нам найти?

105
00:08:16,800 --> 00:08:21,430
Сразу подставим сюда все γ.

106
00:08:21,430 --> 00:08:27,383
Можно сразу сократить на на σ-квадрат,

107
00:08:27,383 --> 00:08:32,626
и получится следующий результат: 14 *

108
00:08:32,626 --> 00:08:40,220
‒ 3 на φ2 = ‒ 3.

109
00:08:40,220 --> 00:08:45,512
И вторая система уравнений: ‒

110
00:08:45,512 --> 00:08:51,215
3 на * + 14

111
00:08:51,215 --> 00:08:56,500
φ2 = γ2, ‒ 2.

112
00:08:56,500 --> 00:09:00,911
Ну, собственно, в этой системе
уравнений нам нужна только φ2,

113
00:09:00,911 --> 00:09:05,505
поэтому от неизвестной * мы будем
избавляться: домножаем первое

114
00:09:05,505 --> 00:09:07,947
уравнение на 3, второе на 14.

115
00:09:07,947 --> 00:09:12,770
Здесь получаем 30 и 12:

116
00:09:12,770 --> 00:09:18,520
42 * ‒ 9φ2 = ‒ 9.

117
00:09:18,520 --> 00:09:23,397
И второе уравнение домножаем на 14,

118
00:09:23,397 --> 00:09:28,457
получаем: ‒ 42

119
00:09:28,457 --> 00:09:34,750
* + 14 на 14,

120
00:09:34,750 --> 00:09:40,350
196φ2 = ‒ 28.

121
00:09:40,350 --> 00:09:43,024
Ну складываем уравнения.

122
00:09:43,024 --> 00:09:49,700
Получаем, что

123
00:09:49,700 --> 00:09:53,810
187φ2 = ‒ 37.

124
00:09:53,810 --> 00:09:58,570
И отсюда φ2 =

125
00:09:58,570 --> 00:10:03,820
‒ 37/187.

126
00:10:03,820 --> 00:10:07,820
И это результат уже отличается от ρ2.

127
00:10:07,820 --> 00:10:13,150
А я напомню,
что ρ2 — это было просто отношение одной

128
00:10:13,150 --> 00:10:19,070
ковариации к дисперсии,
— она равнялась ‒ 2/14.

129
00:10:19,070 --> 00:10:26,090
И ещё раз подчеркну разницу
между этими показателями.

130
00:10:26,090 --> 00:10:31,220
У меня есть yt ‒ 2,
позавчерашнее значение моего показателя,

131
00:10:31,220 --> 00:10:34,821
есть вчерашнее значение моего показателя,
есть сегодняшнее.

132
00:10:34,821 --> 00:10:37,640
И прошлое — оно как-то
воздействует на будущее.

133
00:10:37,640 --> 00:10:44,990
Есть прямой эффект,
и есть эффект через yt ‒ 1.

134
00:10:44,990 --> 00:10:50,460
Так вот φ2 меряет только силу

135
00:10:50,460 --> 00:10:56,520
прямого эффекта,
а ρ2 меряет совокупный эффект,

136
00:10:56,520 --> 00:11:02,340
то есть вот эти несколько
стрелочек в совокупности.

137
00:11:02,340 --> 00:11:07,840
И аналогично можно посчитать φ3.

138
00:11:07,840 --> 00:11:14,134
Значит, для этого нам надо
составить систему большую

139
00:11:14,134 --> 00:11:19,623
и страшную уже: γ0, γ0, γ0 по диагонали.

140
00:11:19,623 --> 00:11:24,626
Потом — чем дальше от диагонали,
тем выше номер

141
00:11:24,626 --> 00:11:30,295
γ: γ1, γ1, γ1, γ1.

142
00:11:30,295 --> 00:11:34,750
И здесь осталось местечко для γ2, γ2.

143
00:11:34,750 --> 00:11:39,970
И пишем здесь неизвестные:
первая бесполезная,

144
00:11:39,970 --> 00:11:48,030
вторая бесполезная и φ3 равняется γ1.

145
00:11:48,030 --> 00:11:53,050
Первая бесполезная плюс вторая

146
00:11:53,050 --> 00:11:57,905
бесполезная плюс φ3 равняется γ2.

147
00:11:57,905 --> 00:12:02,590
И в последнем уравнении то
же самое: три неизвестные,

148
00:12:02,590 --> 00:12:06,336
две из которых бесполезные,
а одна, третья,

149
00:12:06,336 --> 00:12:11,740
неизвестная — γ3.

150
00:12:11,740 --> 00:12:15,920
Соответственно, если записать
эту систему уравнений в числах,

151
00:12:15,920 --> 00:12:21,490
то у нас получится следующее:

152
00:12:21,490 --> 00:12:27,220
14 *1

153
00:12:27,220 --> 00:12:32,230
‒ 3 *2 ‒ 2φ3

154
00:12:32,230 --> 00:12:38,060
= ‒ 3.

155
00:12:38,060 --> 00:12:42,635
‒ 3 *1

156
00:12:42,635 --> 00:12:47,955
+ 14 *2 ‒

157
00:12:47,955 --> 00:12:52,800
3φ3 = ‒ 2.

158
00:12:52,800 --> 00:12:58,870
И последнее уравнение: ‒ 2 *1

159
00:12:58,870 --> 00:13:05,840
‒ 3 *2

160
00:13:05,840 --> 00:13:10,940
+ 14φ3 = 0.

161
00:13:10,940 --> 00:13:16,750
И, соответственно,
решив эту систему уравнений,

162
00:13:16,750 --> 00:13:21,720
мы получим φ3.

