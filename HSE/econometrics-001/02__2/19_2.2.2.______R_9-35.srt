1
00:00:16,230 --> 00:00:21,071
Перейдём к оценке модели
множественной регрессии и проверке

2
00:00:21,071 --> 00:00:24,810
гипотез о коэффициентах,
и построению доверительных интервалов в R.

3
00:00:24,810 --> 00:00:29,920
Множественная регрессия.

4
00:00:29,920 --> 00:00:34,229
Проверка гипотез.

5
00:00:34,229 --> 00:00:37,071
Возьмём набор данных,

6
00:00:37,071 --> 00:00:41,853
с которым мы уже познакомились,
— набор данных по швейцарским кантонам.

7
00:00:41,853 --> 00:00:44,040
Поместим этот набор данных в табличку h.

8
00:00:44,040 --> 00:00:49,430
Давайте ещё раз глянем на табличку h,
что там находится.

9
00:00:49,430 --> 00:00:54,812
Там есть несколько переменных: по каждому
швейцарскому кантону есть фертильность,

10
00:00:54,812 --> 00:00:58,850
— это, соответственно, количество детей до
пяти лет делить на количество женщин до

11
00:00:58,850 --> 00:01:02,849
50-ти и помножить на 1000; доля мужчин,
занятых в сельском хозяйстве;

12
00:01:02,849 --> 00:01:06,770
и другие переменные, например,
доля католического населения в кантоне.

13
00:01:06,770 --> 00:01:14,105
Ещё раз напомню, что всегда надо думать,
а что это у нас за данные.

14
00:01:14,105 --> 00:01:18,124
И в данном случае, поскольку у
нас набор данных, встроенный в R,

15
00:01:18,124 --> 00:01:22,045
то мы можем почитать о нём более подробно,
нажав help(swiss),

16
00:01:22,045 --> 00:01:25,530
и посмотрев, что это за данные,
более подробно.

17
00:01:25,530 --> 00:01:29,116
Итак, мы оценим модель,

18
00:01:29,116 --> 00:01:34,150
в которой данные берутся из набора h,

19
00:01:34,150 --> 00:01:38,506
и мы будем предполагать, что фертильность,

20
00:01:38,506 --> 00:01:42,961
Fertility, зависит, тильда,

21
00:01:42,961 --> 00:01:47,450
от доли католического
населения в данном кантоне,

22
00:01:47,450 --> 00:01:52,420
от показателя,
насколько это регион сельскохозяйственный,

23
00:01:52,420 --> 00:01:56,090
и, скажем, от Examination.

24
00:02:00,315 --> 00:02:04,540
Нажимаем Ctrl+Enter,
и у нас оценилась модель.

25
00:02:04,540 --> 00:02:08,707
Теперь мы можем посмотреть отчёт
об этой модели, и на этот раз,

26
00:02:08,707 --> 00:02:14,114
после второй лекции, для нас в этом отчёте
практически не осталось белых пятен.

27
00:02:14,114 --> 00:02:17,890
Давайте внимательно посмотрим,
что здесь выведено.

28
00:02:17,890 --> 00:02:21,898
В начале просто продублирована формула,
тут ничего интересного.

29
00:02:21,898 --> 00:02:24,980
Дальше, следующая строчка
— это остатки от модели,

30
00:02:24,980 --> 00:02:29,480
то есть насколько спрогнозированная
фертильность не была похожа

31
00:02:29,480 --> 00:02:32,220
на ту фертильность, которая в данных.

32
00:02:32,220 --> 00:02:36,710
То есть минимальная разница
составила минус 26, максимальная 18,

33
00:02:36,710 --> 00:02:41,290
медиана 1.2, то есть это показывает
разброс ошибок прогнозов.

34
00:02:41,290 --> 00:02:45,305
Следующая табличка, стандартная табличка,

35
00:02:45,305 --> 00:02:49,320
которую выводит более-менее в таком
виде большинство статистических пакетов.

36
00:02:49,320 --> 00:02:52,029
Первый столбик — это оценки коэффициентов.

37
00:02:52,029 --> 00:02:56,695
Соответственно, наша модель — это то,
что прогноз фертильности равен 90,

38
00:02:56,695 --> 00:02:59,663
плюс 0.04 умножить на долю
католического населения,

39
00:02:59,663 --> 00:03:03,360
минус 0.09 умножить на долю мужчин,
занятых в сельском хозяйстве,

40
00:03:03,360 --> 00:03:09,280
минус 1.07 умножить на Examination.

41
00:03:09,280 --> 00:03:14,065
Следующий столбик — это стандартные
ошибки каждого коэффициента: 8.63 — это

42
00:03:14,065 --> 00:03:18,127
стандартная ошибка коэффициента
β₁ с крышкой, а, скажем,

43
00:03:18,127 --> 00:03:22,436
0.08 — это стандартная ошибка
коэффициента β_3 с крышкой,

44
00:03:22,436 --> 00:03:26,540
коэффициент при доле
сельскохозяйственного населения.

45
00:03:26,540 --> 00:03:28,579
Автоматом посчитаны t-статистики,

46
00:03:28,579 --> 00:03:32,170
которые проверяют гипотезы о
незначимости каждого коэффициента.

47
00:03:32,170 --> 00:03:36,762
И здесь мы видим, что гипотеза о том,
что β₁ равно нулю,

48
00:03:36,762 --> 00:03:40,312
отвергается; гипотеза о том,
что β₂ равно нулю,

49
00:03:40,312 --> 00:03:43,999
не отвергается; гипотеза о том,
что β_3 равно нулю,

50
00:03:43,999 --> 00:03:49,480
не отвергается; и гипотеза о том,
что β_4 равно нулю, отвергается.

51
00:03:49,480 --> 00:03:54,962
Мы можем попросить компьютер вывести
только табличку с оценками коэффициентов,

52
00:03:54,962 --> 00:04:02,690
стандартными ошибками, t-статистикой
и значимостью: coeftest(model).

53
00:04:02,690 --> 00:04:07,280
И также можем легко получить

54
00:04:07,280 --> 00:04:13,770
доверительные интервалы: confint(model).

55
00:04:13,770 --> 00:04:18,070
Соответственно, вот мы видим,
что доверительный интервал для

56
00:04:18,070 --> 00:04:22,370
коэффициента при доле католического
населения от минус 0.04 до 0.12.

57
00:04:22,370 --> 00:04:28,228
Также можно попросить компьютер
визуализировать нашу зависимость

58
00:04:28,228 --> 00:04:33,930
коэффициента модели: spj.lm(model).

59
00:04:33,930 --> 00:04:37,146
И посмотреть...

60
00:04:37,146 --> 00:04:41,120
Опечатался, sjp.lm.

61
00:04:41,120 --> 00:04:47,168
и у нас получается график,
на котором визуально

62
00:04:47,168 --> 00:04:52,790
видны и оценки каждого коэффициента,
и доверительные интервалы.

63
00:04:52,790 --> 00:04:58,273
И, соответственно, пунктиром проведена
линия нуля, и, таким образом, мы визуально

64
00:04:58,273 --> 00:05:02,718
можем быстро проконтролировать значимость
или незначимость каждого коэффициента.

65
00:05:02,718 --> 00:05:06,942
Вот эти два коэффициента незначимы, потому
что доверительный интервал пересекает

66
00:05:06,942 --> 00:05:10,600
ноль, а вот этот коэффициент значим,

67
00:05:10,600 --> 00:05:14,009
потому что доверительный
интервал не пересекает ноль,

68
00:05:14,009 --> 00:05:17,850
то есть оценка коэффициента
существенно далеко от нуля лежит.

69
00:05:17,850 --> 00:05:22,570
Теперь перейдём к проверке
линейных гипотез.

70
00:05:22,570 --> 00:05:27,267
Давайте проверим линейную гипотезу о том,

71
00:05:27,267 --> 00:05:31,525
что коэффициент зависимости
при доле католического

72
00:05:31,525 --> 00:05:36,560
населения и при доле населения,
занятого в сельском хозяйстве, одинаковые.

73
00:05:36,560 --> 00:05:40,850
Мы говорили о том, что есть несколько
способов проверить эту гипотезу.

74
00:05:40,850 --> 00:05:45,050
Значит, давайте реализуем способ с
построением вспомогательной регрессии.

75
00:05:45,050 --> 00:05:52,385
Проверка гипотезы о том,

76
00:05:52,385 --> 00:05:59,002
что β при католическом населении

77
00:05:59,002 --> 00:06:04,410
равно β при Agriculture.

78
00:06:04,410 --> 00:06:10,438
Как будет выглядеть вспомогательная
регрессия, мы выводили в лекционной части.

79
00:06:10,438 --> 00:06:15,273
Соответственно, здесь мы
её просто оценим: model

80
00:06:15,273 --> 00:06:19,770
вспомогательная равняется lm,

81
00:06:19,770 --> 00:06:25,172
данные берутся из таблички h,
и зависимость имеет вид:

82
00:06:25,172 --> 00:06:30,263
Fertility от Catholic плюс...

83
00:06:30,263 --> 00:06:35,407
вот здесь нам надо включить переменную,
которая является

84
00:06:35,407 --> 00:06:40,540
суммой переменной Catholic
плюс Agriculture.

85
00:06:40,540 --> 00:06:45,960
Соответственно, мы покажем 

86
00:06:45,960 --> 00:06:53,960
I (Catholic + Agriculture).

87
00:06:58,680 --> 00:07:03,400
Для удобства перенесём
формулу на отдельную строчку,

88
00:07:03,400 --> 00:07:09,300
чтобы она была видна целиком,
+ Examination.

89
00:07:09,300 --> 00:07:14,670
Соответственно, если

90
00:07:14,670 --> 00:07:19,241
коэффициент при переменной Catholic
равен нулю, то получается,

91
00:07:19,241 --> 00:07:23,650
что коэффициент при Catholic и
Agriculture будет один и тот же.

92
00:07:23,650 --> 00:07:29,150
А значок I означает инструкцию для R,
что надо трактовать

93
00:07:29,150 --> 00:07:34,650
Catholic + Agriculture — «плюс» в прямом
смысле, не как введение новой переменной.

94
00:07:34,650 --> 00:07:39,337
Вот здесь плюс трактуется как несколько
разных переменных: регрессор Catholic,

95
00:07:39,337 --> 00:07:42,250
регрессор Agriculture,
регрессор Examination,

96
00:07:42,250 --> 00:07:45,862
а здесь внутри I «плюс»
трактуется как банальный плюс,

97
00:07:45,862 --> 00:07:50,000
что надо сложить переменную
Catholic с переменной Agriculture.

98
00:07:50,000 --> 00:07:54,022
Соответственно, оцениваем данную модель.

99
00:07:54,022 --> 00:08:00,150
Смотрим summary этой
вспомогательной модели и получаем,

100
00:08:00,150 --> 00:08:05,217
что коэффициент при Cathilic незначим,

101
00:08:05,217 --> 00:08:08,870
p-value равно 0,15.

102
00:08:08,870 --> 00:08:11,104
Это говорит о том, что гипотеза о том,

103
00:08:11,104 --> 00:08:15,190
что коэффициенты при Catholic и
Agriculture равны, не отвергается.

104
00:08:15,190 --> 00:08:18,790
И, к счастью, в R, конечно,
есть более удобный способ,

105
00:08:18,790 --> 00:08:22,540
что R сам построит необходимые
вспомогательные регрессии.

106
00:08:22,540 --> 00:08:27,117
Мы не будем вдаваться в детали
этого способа на этой неделе,

107
00:08:27,117 --> 00:08:31,245
мы поговорим о деталях другого
способа на следующей неделе,

108
00:08:31,245 --> 00:08:33,930
но тем не менее уже сейчас
мы его можем реализовать:

109
00:08:33,930 --> 00:08:39,745
linearHypothesis с
большой буквы для модели.

110
00:08:39,745 --> 00:08:46,654
А гипотеза у нас состоит в том, что
коэффициент при Catholic минус коэффициент

111
00:08:46,654 --> 00:08:52,290
при Agriculture равняется нулю, то есть
о том, что вот эти коэффициенты равны.

112
00:08:52,290 --> 00:08:56,782
И, соответственно,
компьютер сам построит и вспомогательную

113
00:08:56,782 --> 00:09:00,967
регрессию и посчитает P-значение
необходимой нам статистики.

114
00:09:00,967 --> 00:09:05,070
Соответственно, вот оно
выходит точно таким же, 0.15,

115
00:09:05,070 --> 00:09:09,640
как и у нас руками при
вспомогательной регрессии.

116
00:09:09,640 --> 00:09:14,210
Но здесь немножко другой способ,
он считает не t-статистику, а её квадрат.

117
00:09:14,210 --> 00:09:16,208
И этот квадрат — это 2.05.

118
00:09:16,208 --> 00:09:19,250
Но тем не менее способ
абсолютно эквивалентен.

119
00:09:19,250 --> 00:09:23,147
Таким образом,
мы смогли проверить гипотезу о том,

120
00:09:23,147 --> 00:09:26,734
что два коэффициента истинных,
неизвестных нам, равны,

121
00:09:26,734 --> 00:09:31,610
и эта гипотеза в нашем
случае не отвергается.

