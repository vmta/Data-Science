1
00:00:13,100 --> 00:00:17,667
В сегодняшней третьей лекции
мы разберём два сюжета.

2
00:00:17,667 --> 00:00:22,399
Первый сюжет — это прогнозирование,
как строить прогнозы и,

3
00:00:22,399 --> 00:00:26,680
более интересно, как строить
доверительные интервалы для прогнозов.

4
00:00:26,680 --> 00:00:29,156
И второй сюжет — это как
выбрать наилучшую модель.

5
00:00:29,156 --> 00:00:33,195
Вот если у меня есть две модели, как
сравнить, как проверить гипотезу о том,

6
00:00:33,195 --> 00:00:36,150
верна ли первая модель или
верна ли вторая модель.

7
00:00:36,150 --> 00:00:39,848
Итак, начнём с прогнозирования.

8
00:00:39,848 --> 00:00:44,676
У нас есть теоретическая
модель на примере двух

9
00:00:44,676 --> 00:00:50,210
объясняющих переменных 
y_i = β₁ + β₂ x_i + β_3 z_i + ε_i,

10
00:00:50,210 --> 00:00:54,599
и, соответственно,
оценив неизвестные коэффициенты β₁, β₂,

11
00:00:54,599 --> 00:00:59,203
β_3 методом наибольших квадратов,
мы получаем оценённую регрессию,

12
00:00:59,203 --> 00:01:03,855
которая нам позволяет делать
точечные прогнозы: ŷ i-тое

13
00:01:03,855 --> 00:01:08,263
равно β₁ с крышкой плюс β₂ с
крышкой на x с β_3 с крышкой на z.

14
00:01:08,263 --> 00:01:12,371
Естественно, случайную составляющую
ε мы спрогнозировать не можем,

15
00:01:12,371 --> 00:01:13,730
вместо неё стоит ноль.

16
00:01:13,730 --> 00:01:18,335
Но интересно не точечные
прогнозы построить,

17
00:01:18,335 --> 00:01:20,578
а интересно построить
доверительный интервал.

18
00:01:20,578 --> 00:01:22,871
Интересно, вот мы,
хорошо спрогнозировали,

19
00:01:22,871 --> 00:01:28,223
что завтра будет минус 20 градусов:
это от минус 21-го до минус 19-ти?

20
00:01:28,223 --> 00:01:30,700
Или это от минус 40-ка до нуля?

21
00:01:30,700 --> 00:01:34,481
То есть интересно потроить
доверительный интервал, понять,

22
00:01:34,481 --> 00:01:36,931
насколько наш прогноз является точным.

23
00:01:36,931 --> 00:01:40,475
И вот здесь, чтобы говорить о ширине
доверительного интервала, надо,

24
00:01:40,475 --> 00:01:43,740
вообще говоря, уточнить, а что мы,
собственно, прогнозируем.

25
00:01:43,740 --> 00:01:48,207
Представим себе, что мы исследуем,
например, что-то такое простое, скажем,

26
00:01:48,207 --> 00:01:52,846
зависимость веса человека
от его характеристик: от,

27
00:01:52,846 --> 00:01:57,730
скажем, роста, пола и 
других характеристик.

28
00:01:57,730 --> 00:02:00,508
И, соответственно,
что является неизвестным?

29
00:02:00,508 --> 00:02:03,100
Под неизвестным можно
рассмотреть две величины.

30
00:02:03,100 --> 00:02:10,643
Допустим, я хочу построить прогноз
для человека с заданным ростом,

31
00:02:10,643 --> 00:02:15,720
скажем, с ростом 170 
сантиметров для мужчины.

32
00:02:15,720 --> 00:02:21,278
И тут возникает два варианта: я
могу строить доверительный интервал

33
00:02:21,278 --> 00:02:27,592
для веса среднестатистического
мужчины с ростом 170 сантиметров,

34
00:02:27,592 --> 00:02:32,458
а могу строить доверительный интервал,
который называется предиктивный интервал,

35
00:02:32,458 --> 00:02:36,320
для конкретного мужчины с
ростом в 170 сантиметров.

36
00:02:36,320 --> 00:02:37,620
В чём разница?

37
00:02:37,620 --> 00:02:44,260
Одно дело, если я возьму всех
мужчин ростом 170 сантиметров,

38
00:02:44,260 --> 00:02:50,690
а, другое дело, вот сейчас в комнату
войдёт мужчина ростом 170 сантиметров.

39
00:02:50,690 --> 00:02:58,248
И моя неуверенность в моём прогнозе
роста в этих двух случаях разная.

40
00:02:58,248 --> 00:02:58,910
Почему?

41
00:02:58,910 --> 00:03:03,810
В первом случае средний рост всех мужчин,

42
00:03:03,810 --> 00:03:06,819
которые, вернее, средний вес всех мужчин,

43
00:03:06,819 --> 00:03:10,263
которые имеют рост 170 сантиметров
— это какая-то константа.

44
00:03:10,263 --> 00:03:13,165
Вот эта вот одна константа
— средний рост всех мужчин.

45
00:03:13,165 --> 00:03:15,520
Я его не знаю,
и я имею выборку наблюдений,

46
00:03:15,520 --> 00:03:17,700
могу попытаться его спрогнозировать.

47
00:03:17,700 --> 00:03:21,406
Соответственно, ошибка прогноза,
которая возникает,

48
00:03:21,406 --> 00:03:25,596
она связана только с тем, что у меня
данные не по всем мужчинам Земли,

49
00:03:25,596 --> 00:03:28,830
а у меня данные только по
небольшой случайной выборке.

50
00:03:28,830 --> 00:03:32,637
А вторая задача, если я пытаюсь
спрогнозировать рост конкретного мужчины,

51
00:03:32,637 --> 00:03:36,589
который вот сейчас войдёт в комнату,
и у него рост 170 сантиметров.

52
00:03:36,589 --> 00:03:41,860
Если я пытаюсь спрогнозировать его вес,
то здесь источников ошибки два.

53
00:03:41,860 --> 00:03:44,822
Первый источник ошибки — это то,

54
00:03:44,822 --> 00:03:50,880
что я руководствовался при
оценке модели выборкой,

55
00:03:50,880 --> 00:03:56,416
а второй источник ошибки состоит в том,
что это не среднестатистический мужчина,

56
00:03:56,416 --> 00:04:00,860
рост которого равен константе, а это
случайный мужчина ростом 170 сантиметров.

57
00:04:00,860 --> 00:04:03,525
Поэтому во втором случае
два источника ошибки,

58
00:04:03,525 --> 00:04:05,610
и предиктивный интервал будет шире.

59
00:04:05,610 --> 00:04:08,650
Давайте посмотрим более детально.

60
00:04:08,650 --> 00:04:14,970
Если я прогнозирую условное среднее, то
есть E от у при фиксированных регрессорах,

61
00:04:14,970 --> 00:04:19,816
то у меня возникает понятие ошибки
прогнозирования условного среднего, то

62
00:04:19,816 --> 00:04:25,880
есть ŷ, прогноз, минус средний
вес всех мужчин ростом 170 сантиметров,

63
00:04:25,880 --> 00:04:30,773
и дисперсия этой ошибки прогноза,
ошибки прогнозирования среднего веса,

64
00:04:30,773 --> 00:04:37,022
— она при фиксированном регрессоре
просто равна дисперсии прогноза,

65
00:04:37,022 --> 00:04:42,673
потому что при фиксированных регрессорах
математическое ожидание условное

66
00:04:42,673 --> 00:04:47,760
— это константа, и, соответственно,
её условная дисперсия равна нулю.

67
00:04:47,760 --> 00:04:52,086
И, соответственно, мы получаем,
что нам надо просто,

68
00:04:52,086 --> 00:04:56,706
фактически, посчитать дисперсию
β₁ с крышкой плюс β₂ с крышкой x_i

69
00:04:56,706 --> 00:05:00,140
плюс β_3 с крышкой z_i при
фиксированных регрессорах.

70
00:05:00,140 --> 00:05:05,434
Однако если меня интересует
дисперсия ошибки

71
00:05:05,434 --> 00:05:12,255
прогнозирования конкретного наблюдения,
то конкретное наблюдение - это что такое?

72
00:05:12,255 --> 00:05:16,100
Это среднестатистическое плюс 
эта самая случайная составляющая ε.

73
00:05:16,100 --> 00:05:18,360
И у неё дисперсия, конечно, больше.

74
00:05:18,360 --> 00:05:23,100
Если я посчитаю дисперсию ошибки при
прогнозировании конкретного наблюдения,

75
00:05:23,100 --> 00:05:28,017
у меня получится, что к дисперсии β₁

76
00:05:28,017 --> 00:05:32,460
с крышкой плюс β₂ с крышкой
x_i плюс β_3 с крышкой z_i

77
00:05:32,460 --> 00:05:37,220
условной прибавляется
условная дисперсия ε_i.

78
00:05:37,220 --> 00:05:43,304
То есть дисперсия во втором случае больше
и, стало быть, доверительный интервал,

79
00:05:43,304 --> 00:05:47,735
предиктивный интервал будет 
шире во втором случае.

80
00:05:47,735 --> 00:05:52,395
Надо опять же сказать, что σ²,

81
00:05:52,395 --> 00:05:58,040
дисперсия прогноза,
дисперсия ε — они неизвестны,

82
00:05:58,040 --> 00:06:03,345
и вместо них мы всегда сможем посчитать и
будем использовать во всех расчётах не

83
00:06:03,345 --> 00:06:08,650
настоящие дисперсии, а оценки дисперсий:
вместо Var будет стоять Var с крышкой.

84
00:06:08,650 --> 00:06:14,312
Мы будем использовать стандартные ошибки,
то есть стандартная ошибка y_i с

85
00:06:14,312 --> 00:06:19,540
крышечкой — это корень из оценки дисперсии
y_i с крышечкой при фиксированных иксах.

86
00:06:19,540 --> 00:06:23,375
Соответственно, подходить к
построению доверительного интервала,

87
00:06:23,375 --> 00:06:26,840
как и в случае с доверительными
интервалами для коэффициентов,

88
00:06:26,840 --> 00:06:32,590
можно двумя способами: либо нужно
иметь большое количество наблюдений,

89
00:06:32,590 --> 00:06:38,520
либо нужно верить в нормальный закон
распределения ε_i при фиксированных иксах.

90
00:06:38,520 --> 00:06:42,602
В одном случае мы будем получать,
что ошибка,

91
00:06:42,602 --> 00:06:48,186
делённая на стандартную ошибку,
стремится к нормальному распределению,

92
00:06:48,186 --> 00:06:52,765
в другом случае ошибка прогноза,
делённая на стандартную ошибку,

93
00:06:52,765 --> 00:06:57,360
будет иметь t-распределение
с n – k степенями свободы.

94
00:06:57,360 --> 00:07:02,434
И в соответствии с этим мы получим
два подхода к подсчёту доверительного

95
00:07:02,434 --> 00:07:09,350
интервала: один при нормальном
распределении, другой при большой выборке.

96
00:07:09,350 --> 00:07:14,700
Аналогично, абсолютно то же самое
будет с предиктивным интервалом,

97
00:07:14,700 --> 00:07:18,110
то есть с интервалом для
конкретного наблюдения.

98
00:07:18,110 --> 00:07:22,490
Можно работать в рамках предположения
о большом количестве наблюдений,

99
00:07:22,490 --> 00:07:28,976
можно работать в рамках предположения
о нормальном распределении ε_i.

100
00:07:28,976 --> 00:07:36,354
И сейчас мы на конкретном примере
посмотрим, как строить доверительный

101
00:07:36,354 --> 00:07:40,990
интервал и как строить предиктивный
интервал для отдельного наблюдения.

102
00:07:40,990 --> 00:07:45,635
Ещё раз о терминологии: когда говорят
«доверительный интервал», обычно

103
00:07:45,635 --> 00:07:50,612
имеют в виду доверительный интервал для
среднего значения зависимой переменной,

104
00:07:50,612 --> 00:07:56,447
когда говорят «предиктивный интервал»,
обычно имеют в виду интервал

105
00:07:56,447 --> 00:08:01,370
для значения зависимой переменной
для конкретного наблюдения.

