1
00:00:13,250 --> 00:00:19,528
Мы знаем, что пропуск переменных,

2
00:00:19,528 --> 00:00:23,603
влияющих на игрек,
приводит к очень страшным последствиям.

3
00:00:23,603 --> 00:00:27,337
И если у нас есть какая-то группа
переменных, которые мы думаем включать

4
00:00:27,337 --> 00:00:32,119
или не включать, мы можем запросто
проверить гипотезу с помощью F-теста.

5
00:00:32,119 --> 00:00:36,417
То есть, взяв разницу RSS
restricted минус RSS unrestrected,

6
00:00:36,417 --> 00:00:41,312
поделить на RSS unrestrected, мы можем
свободно проверить гипотезу о том,

7
00:00:41,312 --> 00:00:43,510
надо включать эти переменные или нет.

8
00:00:43,510 --> 00:00:48,421
Гораздо более интересной является
гипотеза о том — а вот у меня

9
00:00:48,421 --> 00:00:50,852
каких-то переменных нет.

10
00:00:50,852 --> 00:00:56,480
А может быть я их, как раз-то может быть
их и надо было включить, а у меня их нет.

11
00:00:56,480 --> 00:00:58,728
Как проверить гипотезу о том,

12
00:00:58,728 --> 00:01:04,100
что не пропустил ли я чего-нибудь важное,
за чем у меня нет наблюдений.

13
00:01:04,100 --> 00:01:08,367
Если у меня есть наблюдения,
я делаю F-тест, считаю разницу RSS,

14
00:01:08,367 --> 00:01:12,454
делю на RSS unrestrected,
на соответствующие константы и проверяю

15
00:01:12,454 --> 00:01:16,070
гипотезу — надо было мне включать
эти переменные или не надо.

16
00:01:16,070 --> 00:01:20,080
А может быть мне надо включить те
переменные, данных по которым у меня нет.

17
00:01:20,080 --> 00:01:24,185
И вот тест Рамсея — это
такая изящная попытка,

18
00:01:24,185 --> 00:01:28,290
успешная попытка проверить гипотезу о том,

19
00:01:28,290 --> 00:01:33,000
надо ли мне было включать те переменные,
которых у меня на самом деле нет.

20
00:01:33,000 --> 00:01:39,508
Итак, текст Рамсея,
нулевая гипотеза у него состоит в том,

21
00:01:39,508 --> 00:01:44,156
что yi = β1 + β2 хi + β3 zi + εi,

22
00:01:44,156 --> 00:01:47,803
то есть я включил ровно те переменные,

23
00:01:47,803 --> 00:01:52,200
которые и надо было бы
включить в оценку регрессии.

24
00:01:52,200 --> 00:01:56,617
Альтернативная гипотеза
теста Рамсея состоит в том,

25
00:01:56,617 --> 00:02:00,845
что я пропустил и не включил
некоторый набор регрессоров,

26
00:02:00,845 --> 00:02:03,730
который на самом деле было включить надо.

27
00:02:03,730 --> 00:02:07,910
Как проводится тест Рамсея?

28
00:02:07,910 --> 00:02:12,827
На первом шаге теста Рамсея
оценивается исходная модель,

29
00:02:12,827 --> 00:02:16,650
и из нее получаются прогнозы yi с крышкой.

30
00:02:16,650 --> 00:02:22,100
На втором шаге оценивается

31
00:02:22,100 --> 00:02:27,200
вспомогательная регрессия,
то есть строится регрессия yi

32
00:02:27,200 --> 00:02:32,436
на исходные переменные и на степени

33
00:02:32,436 --> 00:02:37,739
прогнозов из регрессии на первом шаге.

34
00:02:37,739 --> 00:02:42,130
То есть туда включаются yi с крышкой
в квадрате, yi с крышкой в кубе.

35
00:02:42,130 --> 00:02:45,063
Ну, несколько первых степеней включаются.

36
00:02:45,063 --> 00:02:46,866
Скажем, вторая, третья,

37
00:02:46,866 --> 00:02:50,840
всего p степеней со второй и до
p + первой степени включаются.

38
00:02:50,840 --> 00:02:55,985
Дальше считается обычная F-статистика,
проверяющая гипотезу

39
00:02:55,985 --> 00:03:00,416
о равенстве всех коэффициентов
перед вот этими искусственными

40
00:03:00,416 --> 00:03:05,010
переменными y с крышкой во второй степени,
y с крышкой в третьей степени.

41
00:03:05,010 --> 00:03:09,066
Гипотеза о равенстве нулю всех
коэффициентов перед этими новыми

42
00:03:09,066 --> 00:03:10,030
переменными.

43
00:03:10,030 --> 00:03:14,846
И проверяется стандартным
F-тестом гипотеза о том,

44
00:03:14,846 --> 00:03:18,492
что эти переменные γ1, γ2, γ3, ...,

45
00:03:18,492 --> 00:03:19,678
γp равны нулю.

46
00:03:19,678 --> 00:03:21,060
В чем идея теста?

47
00:03:21,060 --> 00:03:26,787
Если мы пропустили какую-то переменную,
то, наверное,

48
00:03:26,787 --> 00:03:31,350
эта переменная останется в y с крышкой.

49
00:03:31,350 --> 00:03:36,300
И, соответственно, мы с помощью y

50
00:03:36,300 --> 00:03:41,290
с крышкой будем заменять эту
самую пропущенную переменную.

51
00:03:41,290 --> 00:03:42,980
То есть y с крышкой в квадрате,

52
00:03:42,980 --> 00:03:47,280
y с крышкой в кубе — это будет какой-то
заменитель пропущенной переменной.

53
00:03:47,280 --> 00:03:53,784
Если на самом деле пропущенных
переменных нет, то значение yi с

54
00:03:53,784 --> 00:03:59,050
крышкой не будет содержать в себе
информацию о пропущенных переменных,

55
00:03:59,050 --> 00:04:04,130
ну и стало быть тогда γ1,
γ2, γ3 будут равняться нулю.

56
00:04:04,130 --> 00:04:06,383
Пример на тест Рамсея.

57
00:04:06,383 --> 00:04:11,546
Предположим, что исследователь
оценил зависимость

58
00:04:11,546 --> 00:04:20,090
заработной платы от количества
лет обучения и от опыта работы.

59
00:04:20,090 --> 00:04:23,834
И он хочет проверить гипотезу,

60
00:04:23,834 --> 00:04:29,400
что пропущенных регрессоров,
пропущенных объясняющих переменных нету.

61
00:04:29,400 --> 00:04:33,947
То есть он хочет проверить
гипотезу H0 о том,

62
00:04:33,947 --> 00:04:40,030
что в модели нет пропущенных

63
00:04:40,030 --> 00:04:44,980
переменных.

64
00:04:44,980 --> 00:04:48,908
Против H альтернативной о том,

65
00:04:48,908 --> 00:04:53,820
что есть пропущенные переменные.

66
00:04:53,820 --> 00:04:59,290
Ну то есть,
если бы у него были эти самые переменные,

67
00:04:59,290 --> 00:05:02,188
которые, он подозревает, что влияют
на заработную плату, он бы, конечно,

68
00:05:02,188 --> 00:05:03,961
их включил в модель и
провел бы обычный F-тест.

69
00:05:03,961 --> 00:05:07,287
Но у него просто нет,
других переменных, данных нет,

70
00:05:07,287 --> 00:05:12,610
поэтому он должен выкрутиться,
и для этого он использует тест Рамсея.

71
00:05:12,610 --> 00:05:15,980
Тест Рамсея.

72
00:05:15,980 --> 00:05:20,270
В тесте Рамсея строится
вспомогательная регрессия.

73
00:05:20,270 --> 00:05:25,150
Вспомогательная регрессия,

74
00:05:25,150 --> 00:05:30,089
где заработная плата с крышечкой

75
00:05:30,089 --> 00:05:36,580
равняется минус 3,3, оказалась равна,

76
00:05:36,580 --> 00:05:41,929
плюс 0,95 помножить на количество

77
00:05:41,929 --> 00:05:47,130
лет обучения, плюс 0,25 на опыт работы,

78
00:05:47,130 --> 00:05:51,948
и дальше он на первом шаге,

79
00:05:51,948 --> 00:05:58,540
оценив исходную модель, а на втором
шаге оценивая вспомогательную модель,

80
00:05:58,540 --> 00:06:03,740
он включил в модель предсказанные
значения y с крышкой из первой модели.

81
00:06:03,740 --> 00:06:06,704
То есть оценив первую модель,

82
00:06:06,704 --> 00:06:12,778
он получил y с крышкой и вставил
их во вспомогательную регрессию,

83
00:06:12,778 --> 00:06:18,170
получил минус 0,264 на y с
крышкой в квадрате i-тая

84
00:06:18,170 --> 00:06:24,010
плюс 0,024 на yi с крышкой в кубе.

85
00:06:24,010 --> 00:06:30,800
В основной регрессии R-квадрат
оказался равен 0,91.

86
00:06:30,800 --> 00:06:36,860
И количество наблюдений 3294.

87
00:06:36,860 --> 00:06:41,968
Во вспомогательной регрессии R-квадрат

88
00:06:41,968 --> 00:06:46,407
равен 0,091 и во вспомогательной

89
00:06:46,407 --> 00:06:50,781
регрессии R-квадрат равен 0,095 и

90
00:06:50,781 --> 00:06:55,849
количество наблюдений такое же — n = 3294.

91
00:06:55,849 --> 00:07:01,112
И нам надо на уровне
значимости α = 5 % проверить

92
00:07:01,112 --> 00:07:06,521
гипотезу о том, что в первой
модели нет пропущенных переменных.

93
00:07:06,521 --> 00:07:07,919
Как нам это сделать?

94
00:07:07,919 --> 00:07:09,628
Что говорит тест Рамсея?

95
00:07:09,628 --> 00:07:16,629
Тест Рамсея основан на следующей идее,
что если, действительно переменных нет,

96
00:07:16,629 --> 00:07:24,235
то включение чего бы то ни было в
уравнение, будет приводить к оценкам,

97
00:07:24,235 --> 00:07:28,780
близким к нулю, и соответственно, можно
проверить с помощью обычной F-статистики.

98
00:07:28,780 --> 00:07:32,940
А ежели какие-то переменные на самом
деле пропущены, то, скорей всего,

99
00:07:32,940 --> 00:07:38,344
эти пропущенные переменные, они хоть
как-то связаны с включенными переменными,

100
00:07:38,344 --> 00:07:42,980
и, соответственно,
они как-то будут связаны с y с крышкой.

101
00:07:42,980 --> 00:07:46,764
И, соответственно,
включив y с крышкой в квадрате,

102
00:07:46,764 --> 00:07:51,523
y с крышкой в кубе, мы получим
коэффициенты, которые не равны нулю.

103
00:07:51,523 --> 00:07:56,920
Поэтому проверка гипотезы о том,
что в модели нет пропущенных переменных,

104
00:07:56,920 --> 00:08:01,110
у нас превращается
конкретно в гипотезу о том,

105
00:08:01,110 --> 00:08:06,289
что β при y с крышкой
в квадрате равен нулю,

106
00:08:06,289 --> 00:08:10,250
и о том,
что β при y с крышкой в кубе равен нулю.

107
00:08:10,250 --> 00:08:13,056
То есть мы получаем обычный F-тест,

108
00:08:13,056 --> 00:08:17,870
только мы включили не отсутствующие
у нас в данных переменные,

109
00:08:17,870 --> 00:08:22,010
а мы включили y с крышкой в квадрате,
y с крышкой в кубе.

110
00:08:22,010 --> 00:08:22,715
Почему?

111
00:08:22,715 --> 00:08:27,300
Потому что в нем есть отчасти
информация о пропущенных,

112
00:08:27,300 --> 00:08:30,830
отсутствующих у нас в данных переменных.

113
00:08:30,830 --> 00:08:35,740
И альтернативная гипотеза о том, что хотя
бы один из коэффициентов не равен нулю.

114
00:08:35,740 --> 00:08:41,156
H-альтернативная: о том,
что хотя бы один,- хотя бы

115
00:08:41,156 --> 00:08:48,720
один из коэффициентов не равен нулю.

116
00:08:48,720 --> 00:08:56,940
Соответственно, эта модель у нас
ограниченная выходит, restricted.

117
00:08:56,940 --> 00:08:58,910
Эта модель неограниченная,

118
00:08:58,910 --> 00:09:02,700
в ней не предполагается
равенство нулю коэффициентов.

119
00:09:02,700 --> 00:09:06,804
И я считаю обычную F-статистику.

120
00:09:06,804 --> 00:09:11,740
Это RSS restricted минус RSS unrestricted,

121
00:09:11,740 --> 00:09:15,810
деленное на количество ограничений,
в данном случае — два,

122
00:09:15,810 --> 00:09:22,135
деленное на RSS unrestricted на n 3294,

123
00:09:22,135 --> 00:09:26,640
минус количество переменных оцениваемых
коэффициентов в неограниченной модели.

124
00:09:26,640 --> 00:09:28,460
Раз, два, три, четыре, пять.

125
00:09:28,460 --> 00:09:30,277
Минус пять.

126
00:09:30,277 --> 00:09:33,522
Замечаем, что RSS у нас нет.

127
00:09:33,522 --> 00:09:37,390
Опять у нас есть R-квадрат,
поэтому мы применим тот же самый трюк.

128
00:09:37,390 --> 00:09:45,786
Мы поделим на TSS, TSS одинаковый.

129
00:09:45,786 --> 00:09:50,723
TSS restricted и TSS
unrestricted — это одно и то же,

130
00:09:50,723 --> 00:09:54,626
это сумма yi минус y средняя в квадрате.

131
00:09:54,626 --> 00:09:57,260
Поделим все здесь на TSS.

132
00:09:57,260 --> 00:10:02,280
Получим: равняется

133
00:10:02,280 --> 00:10:10,008
RSS restricted на TSS,

134
00:10:10,008 --> 00:10:16,897
минус RSS unrestricted на TSS,
деленное на 2,

135
00:10:16,897 --> 00:10:22,692
деленное на RSS unrestricted на TSS,

136
00:10:22,692 --> 00:10:29,180
деленное на 3289.

137
00:10:29,180 --> 00:10:33,583
Ну и дальше мы вспоминаем снова факт,

138
00:10:33,583 --> 00:10:39,240
что RSS плюс ESS равняется TSS,

139
00:10:39,240 --> 00:10:45,030
поэтому RSS деленное на TSS плюс ESS,

140
00:10:45,030 --> 00:10:48,128
деленное на TSS равняется единичке.

141
00:10:48,128 --> 00:10:55,363
Это величина называется R-квадрат,
поэтому эта единичка — минус R-квадрат.

142
00:10:55,363 --> 00:11:02,060
В нашем случае мы получаем: единичка
минус R-квадрат restricted,

143
00:11:02,060 --> 00:11:07,994
минус единичка минус R-квадрат
unrestricted, деленное на 2.

144
00:11:07,994 --> 00:11:13,186
А тут единичка минус
R-квадрат unrestricted,

145
00:11:13,186 --> 00:11:16,040
деленное на 3289.

146
00:11:16,040 --> 00:11:22,600
Поскольку R-квадрат у нас даны,

147
00:11:22,600 --> 00:11:27,802
то мы получаем 0,095 минус

148
00:11:27,802 --> 00:11:33,343
0,091, деленное на 2, делить на 0,0...

149
00:11:33,343 --> 00:11:35,570
unrestricted R- квадрат...

150
00:11:35,570 --> 00:11:42,110
на единичка минус 0,095,

151
00:11:42,110 --> 00:11:47,915
деленное на 3289,

152
00:11:47,915 --> 00:11:54,893
и мы получаем, что это примерно равно 7,3.

153
00:11:54,893 --> 00:11:58,280
При верной H0,

154
00:11:58,280 --> 00:12:03,929
при H0 наша F-статистика
имеет F-распределение

155
00:12:03,929 --> 00:12:08,290
с 2,3289 степеней свободы.

156
00:12:08,290 --> 00:12:14,140
Соответственно, график ее плотности
выглядит примерно вот так вот.

157
00:12:14,140 --> 00:12:17,190
Это F-критическое.

158
00:12:17,190 --> 00:12:22,528
По таблице находим или с помощью
компьютера, что F-критическое —

159
00:12:22,528 --> 00:12:27,601
это квантильная функция
F-распределения порядка

160
00:12:27,601 --> 00:12:33,060
0,95 со степенями свободы по числителю 2,

161
00:12:33,060 --> 00:12:36,716
со степенями свободы по знаменателю 3289.

162
00:12:36,716 --> 00:12:41,853
Если мы вводим такую команду,
мы получаем, что F-критическое равно 3.

163
00:12:41,853 --> 00:12:46,324
Значит здесь площадь 0,95, здесь — 0,05.

164
00:12:46,324 --> 00:12:52,990
Наша F-наблюдаемая,
F-наблюдаемая равно 7,3,

165
00:12:52,990 --> 00:12:57,956
F-критическая делит наши
области возможных значений

166
00:12:57,956 --> 00:13:02,700
наблюдаемого F-статистики на ту часть,
где H0 отвергается.

167
00:13:02,700 --> 00:13:07,203
Слишком большие значения F-статистики
говорят о слишком большой

168
00:13:07,203 --> 00:13:10,600
разнице между RSS restricted
и RSS unrestricted,

169
00:13:10,600 --> 00:13:14,810
и говорят о том,
что ограничения не выполняются.

170
00:13:14,810 --> 00:13:20,000
Здесь у нас H0 не отвергается.

171
00:13:20,000 --> 00:13:26,660
В нашем конкретном случае F-наблюдаемая
попала куда-то сюда, 7,3.

172
00:13:26,660 --> 00:13:32,080
Соответственно, в нашем случае
F-наблюдаемая больше F-критического.

173
00:13:32,080 --> 00:13:38,143
Мы делаем вывод, что H0 отвергается,
в нашем случае H0 — это о том,

174
00:13:38,143 --> 00:13:41,820
что в модели нет пропущенных переменных.

175
00:13:41,820 --> 00:13:46,710
Значит мы приходим к выводу,
что есть пропущенные переменные.

