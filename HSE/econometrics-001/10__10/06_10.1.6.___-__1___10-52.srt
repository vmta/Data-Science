1
00:00:12,620 --> 00:00:19,620
Для иллюстрации байесовского подхода
мы рассмотрим простой пример.

2
00:00:19,620 --> 00:00:24,120
К примеру, у нас есть наблюдения за тем,
кого мы выловили,

3
00:00:24,120 --> 00:00:28,730
закидывая удочку в очередной раз, в озере.

4
00:00:28,730 --> 00:00:33,340
Итак, наши наблюдения: y₁ — в
первый раз мы выловили карася,

5
00:00:33,340 --> 00:00:37,667
во второй раз мы выловили щуку,

6
00:00:37,667 --> 00:00:42,360
и в третий раз мы выловили тоже карася.

7
00:00:42,360 --> 00:00:45,000
Это имеющиеся наблюдения.

8
00:00:45,000 --> 00:00:49,747
Соответственно, помимо имеющихся
наблюдений у нас должна быть

9
00:00:49,747 --> 00:00:51,220
какая-то модель.

10
00:00:51,220 --> 00:00:56,162
Ну мы предположим модель нашего
явления следующую: предположим,

11
00:00:56,162 --> 00:00:59,812
что рыб в озере достаточно много,
поэтому если вы выловили одного карася,

12
00:00:59,812 --> 00:01:02,390
это вряд ли сильно поменяет
вероятности вылова рыб.

13
00:01:02,390 --> 00:01:05,078
Не то что там в озере водились
последние два карася,

14
00:01:05,078 --> 00:01:06,980
и поэтому вероятность резко упала.

15
00:01:06,980 --> 00:01:11,840
Поэтому мы предположим,
что y_i независимы и одинаково

16
00:01:11,840 --> 00:01:16,309
распределены — это наша
модель явления будет.

17
00:01:16,309 --> 00:01:20,140
И закон распределения будет
следующий — неизвестный.

18
00:01:20,140 --> 00:01:23,831
То есть мы будем предполагать,
что отдельные наблюдения независимы,

19
00:01:23,831 --> 00:01:28,351
каждое наблюдение может быть либо
карасём с некой вероятностью p, ну,

20
00:01:28,351 --> 00:01:33,623
соответственно, либо щукой
с вероятностью 1 ‒ p.

21
00:01:33,623 --> 00:01:35,971
Это будет модель.

22
00:01:35,971 --> 00:01:40,839
И для байесовского подхода нам ещё
нужно некое априорное распределение на

23
00:01:40,839 --> 00:01:42,440
неизвестный параметр p.

24
00:01:42,440 --> 00:01:47,490
Априорное распределение.

25
00:01:47,490 --> 00:01:53,210
И для начала мы рассмотрим

26
00:01:53,210 --> 00:01:57,625
первую ситуацию,
где мы ничего не знали про параметр p.

27
00:01:57,625 --> 00:01:59,601
Нам здравый смысл, естественно, говорит,

28
00:01:59,601 --> 00:02:05,113
что вероятность не может вылазить за
пределы от 0 до 1, и поэтому мы говорим,

29
00:02:05,113 --> 00:02:10,472
что первое априорное распределение,
которое мы рассматриваем, это равномерное

30
00:02:10,472 --> 00:02:15,574
от 0 до 1, ну то есть это означает,
что график функции плотности — это 1,

31
00:02:15,574 --> 00:02:19,955
когда p от 0 до 1, и 0 иначе,

32
00:02:19,955 --> 00:02:27,149
то есть график функции плотности у нас
вот такой вот: здесь по горизонтали p,

33
00:02:27,149 --> 00:02:32,450
здесь 0, здесь 1,
и функция плотности проходит на высоте 1.

34
00:02:32,450 --> 00:02:40,914
Вот такая вот априорная функция плотности.

35
00:02:40,914 --> 00:02:47,460
И наша задача — посчитать следующие вещи:
самая основная наша цель — это понять...

36
00:02:47,460 --> 00:02:51,690
Вот это было априорное знание до того,
как я выловил карасей.

37
00:02:51,690 --> 00:02:58,640
Но карасей-то много попалось, поэтому это
как-то меняет моё мнение о неизвестном p.

38
00:02:58,640 --> 00:03:03,955
Значит, первое что нужно сделать, — это
посчитать моё мнение о неизвестном p,

39
00:03:03,955 --> 00:03:09,270
априорную функцию плотности при
условии известных y_1, y_2, y_3.

40
00:03:09,270 --> 00:03:14,874
Ну и для того чтобы лучше почувствовать
разницу между априорным распределением,

41
00:03:14,874 --> 00:03:17,009
то есть распределение до
получения наблюдений,

42
00:03:17,009 --> 00:03:20,466
то есть вот это априорное распределение,
оно — это моя вера,

43
00:03:20,466 --> 00:03:24,630
мое мнение о вероятности
нахождения карася,

44
00:03:24,630 --> 00:03:28,813
отлова карася в озере,
ну когда у меня ещё нет наблюдений.

45
00:03:28,813 --> 00:03:32,202
А вот это — это моё же мнение о
вероятности только с учётом имеющихся

46
00:03:32,202 --> 00:03:32,930
наблюдений.

47
00:03:32,930 --> 00:03:37,185
И, соответственно, чтобы лучше
почувствовать разницу между моим мнением

48
00:03:37,185 --> 00:03:42,092
до получения наблюдений и после получения
наблюдений о неизвестном параметре p,

49
00:03:42,092 --> 00:03:44,584
мы посчитаем какие-то характеристики.

50
00:03:44,584 --> 00:03:47,393
Ну, например,
математическое ожидание от p,

51
00:03:47,393 --> 00:03:52,206
— p мы трактуем сейчас как случайную
величину,— до получения наблюдений

52
00:03:52,206 --> 00:03:56,810
и математическое ожидание от
p после получения наблюдений.

53
00:03:56,810 --> 00:04:01,209
И также, чтобы ещё сравнить,
вероятность, скажем, того,

54
00:04:01,209 --> 00:04:06,363
что p больше половины до получения
наблюдений, безусловная вероятность,

55
00:04:06,363 --> 00:04:11,720
априорная, и вероятность того,
что параметр p больше 0,5 апостериорное,

56
00:04:11,720 --> 00:04:15,040
после получения наблюдений y_1,..., y_3.

57
00:04:15,040 --> 00:04:21,490
Вот такие вот у нас вопросы,
чтобы лучше почувствовать разницу между

58
00:04:21,490 --> 00:04:26,893
априорным распределением и апостериорным,
которое мы пока что не нашли.

59
00:04:26,893 --> 00:04:27,673
Поехали.

60
00:04:27,673 --> 00:04:32,100
По формуле условной вероятности,
условная вероятность,

61
00:04:32,100 --> 00:04:36,666
условная функция плотности p
при известном y — это есть

62
00:04:36,666 --> 00:04:41,827
совместная функция
плотности от p и y делить

63
00:04:41,827 --> 00:04:47,354
на условную вероятность y,
условную функцию плотности y.

64
00:04:47,354 --> 00:04:51,620
Ну здесь я немножко, может,
злоупотребляю обозначением,

65
00:04:51,620 --> 00:04:55,884
но тем не менее из контекста понятно,
что это — совместная функция плотности,

66
00:04:55,884 --> 00:04:57,900
а когда я ставлю палочку — условная.

67
00:04:57,900 --> 00:05:05,030
Равняется: опять же в формуле
условной вероятности это f(y|p)

68
00:05:05,030 --> 00:05:10,770
помножить на f(p) делить на f(y).

69
00:05:10,770 --> 00:05:15,176
Ну нас будет интересовать
зависимость именно от p,

70
00:05:15,176 --> 00:05:19,791
то есть нас интересует зависимость
именно от p, поэтому всё,

71
00:05:19,791 --> 00:05:24,490
что не зависит от p, это будет константой.

72
00:05:24,490 --> 00:05:27,738
И поэтому в данном случае вот это f(y),
— мы его изучать не будем,

73
00:05:27,738 --> 00:05:29,698
поэтому здесь напишем такую тильдочку.

74
00:05:29,698 --> 00:05:35,825
Это будет означать, что с точностью до
параметров, которые от p не зависят.

75
00:05:35,825 --> 00:05:39,782
То есть всё, что не зависит от p,
— константы.

76
00:05:39,782 --> 00:05:41,970
С точностью до константы.

77
00:05:41,970 --> 00:05:47,910
Мы получаем f(y|p) помножить на f(p).

78
00:05:47,910 --> 00:05:51,028
Ну переходим к нашему конкретному случаю.

79
00:05:51,028 --> 00:05:53,730
Как определяется вероятность...

80
00:05:53,730 --> 00:05:54,856
Что вот это такое?

81
00:05:54,856 --> 00:05:57,890
Это априорная функция плотности,
она у нас дана.

82
00:05:57,890 --> 00:06:00,700
Вот это априорная функция плотности.

83
00:06:00,700 --> 00:06:05,820
А вот это наша модель для данных,
вот это — это наша модель для данных.

84
00:06:05,820 --> 00:06:10,140
Наша модель для данных говорит,
что отдельные наблюдения независимы,

85
00:06:10,140 --> 00:06:14,331
поэтому мне вероятность получить
карася надо перемножить на вероятность

86
00:06:14,331 --> 00:06:17,413
получить щуку и на
вероятность получения карася.

87
00:06:17,413 --> 00:06:19,600
И в данном случае у нас получается.

88
00:06:19,600 --> 00:06:24,379
Поскольку наблюдения независимы тут,
перемножаем вероятности.

89
00:06:24,379 --> 00:06:28,727
Мы получаем: вероятность
карася p помножить на (1‒ p)

90
00:06:28,727 --> 00:06:33,399
помножить на вероятность карася
p и помножить на единичку.

91
00:06:33,399 --> 00:06:41,674
Ещё раз, вот это, это — из модели, а вот
это — это априорная функция плотности.

92
00:06:41,674 --> 00:06:45,730
Ну, естественно,
здесь я получил на участке от 0 до 1.

93
00:06:45,730 --> 00:06:50,455
То есть это, значит,
у нас априорная функция плотности,

94
00:06:50,455 --> 00:06:55,180
вот это при p, лежащем от 0 до 1,

95
00:06:55,180 --> 00:06:58,973
ну и 0 — при p, не лежащем от 0 до 1,

96
00:06:58,973 --> 00:07:03,844
поскольку что бы я не помножил на 0,
получится 0.

97
00:07:03,844 --> 00:07:08,719
Соответственно, я выяснил с
точностью до константы как выглядит

98
00:07:08,719 --> 00:07:10,902
апостериорная функция плотности.

99
00:07:10,902 --> 00:07:13,230
Ну эту константу тоже несложно найти.

100
00:07:13,230 --> 00:07:17,271
Поскольку я знаю, что на любой функции
плотности интеграл должен равняться,

101
00:07:17,271 --> 00:07:19,264
— под любой функцией плотности,
— единичке.

102
00:07:19,264 --> 00:07:25,510
То есть у меня есть такое условие,
что интеграл от 0 до 1 функции

103
00:07:25,510 --> 00:07:31,747
плотности условной по p,
— этот интеграл должен равняться 1.

104
00:07:31,747 --> 00:07:37,977
И поэтому хотя я здесь забыл константу,
я могу проинтегрировать это выражение и,

105
00:07:37,977 --> 00:07:42,808
соответственно, найти условную
функцию плотности абсолютно точно.

106
00:07:42,808 --> 00:07:47,470
У меня получится, что чтобы интеграл
под этим выражением равнялся 1,

107
00:07:47,470 --> 00:07:50,372
его дополнительно надо помножить на 12.

108
00:07:50,372 --> 00:07:54,037
Ну в этом просто несложно убедиться,
взяв интеграл.

109
00:07:54,037 --> 00:07:59,100
Соответственно, я получаю ответ,
который сейчас будем интерпретировать.

110
00:07:59,100 --> 00:08:04,256
Я получил, что условная функция
плотности f(p|y) равняется

111
00:08:04,256 --> 00:08:09,915
12p-квадрат на 1 ‒ p при p от 0 до 1 и,

112
00:08:09,915 --> 00:08:15,560
соответственно, 0 при p,
не принадлежащем от 0 до 1.

113
00:08:15,560 --> 00:08:19,910
Вот у нас априорная функция плотности.

114
00:08:19,910 --> 00:08:24,830
А если построить график
апостериорной функции плотности,

115
00:08:24,830 --> 00:08:29,018
то мы получим следующую картинку.

116
00:08:29,018 --> 00:08:34,330
Если построить график вот этой
функции плотности f(p|y),

117
00:08:34,330 --> 00:08:37,380
график функции плотности
будет вот таким вот.

118
00:08:37,380 --> 00:08:43,400
Здесь p, а здесь f(p).

119
00:08:43,400 --> 00:08:47,674
То есть моё априорное
мнение было: я не знаю,

120
00:08:47,674 --> 00:08:52,686
где p от 0 до 1, и все точки для меня
окажутся одинаково предпочтительными.

121
00:08:52,686 --> 00:08:57,891
А апостериорное моё мнение о вероятности
поймать карася уже говорит о том,

122
00:08:57,891 --> 00:09:03,030
что вероятность поймать карася
гораздо ближе к 1, чем к 0.

123
00:09:03,030 --> 00:09:08,720
И я могу, например,
ответить на вопросы, какова...

124
00:09:08,720 --> 00:09:14,025
как я оцениваю шансы того,
что вероятность поймать карася больше 0,5.

125
00:09:14,025 --> 00:09:19,107
Ну если ответить на эти вопросы, то
получится, что априорная вероятность того,

126
00:09:19,107 --> 00:09:23,703
что шансы поймать карася больше 0,5,

127
00:09:23,703 --> 00:09:30,060
— это вот эта площадь за 0,5, — это 0,5.

128
00:09:30,060 --> 00:09:33,643
А если я посчитаю апостериорную,
шансы того,

129
00:09:33,643 --> 00:09:38,194
что вероятность поймать карася больше 0,5,
то есть это вероятность того,

130
00:09:38,194 --> 00:09:41,645
что карасей больше, чем щук, и это
вероятность того, что карасей больше,

131
00:09:41,645 --> 00:09:46,695
чем щук, До получения наблюдений она —
0,5, а после получения наблюдений...

132
00:09:46,695 --> 00:09:51,310
Ну мне надо вот взять где-то вот
здесь 0,5, взять этот интеграл,

133
00:09:51,310 --> 00:09:57,446
и если посчитать эту площадь,
то она окажется равной 11/16.

134
00:09:57,446 --> 00:10:04,188
Если честно взять интеграл,
то окажется, он равен 11/16, 0,6875.

135
00:10:04,188 --> 00:10:09,873
То есть априори я думал,
что вероятность того, что карасей больше,

136
00:10:09,873 --> 00:10:13,795
чем щук, 0,5, а после учёта этой
информации я оцениваю вероятность того,

137
00:10:13,795 --> 00:10:16,541
что карасей больше, чем щук, как 11/16.

138
00:10:16,541 --> 00:10:21,303
Ну и то же самое можно посчитать
среднюю долю щук: мое мнение о средней

139
00:10:21,303 --> 00:10:24,760
доле щук до получения наблюдений и после.

140
00:10:24,760 --> 00:10:29,062
В первом случае E(p)
окажется равным 0,5 — по

141
00:10:29,062 --> 00:10:32,307
формуле обычного математического ожидания.

142
00:10:32,307 --> 00:10:35,746
А если я посчитаю обычное
математическое ожидание с учётом y,

143
00:10:35,746 --> 00:10:37,990
то есть условное математическое ожидание,

144
00:10:37,990 --> 00:10:42,890
ну то есть возьму интеграл от p помножить
на эту функция плотности, то я получу,

145
00:10:42,890 --> 00:10:48,110
что средняя доля карасей, — теперь я
считаю, что средняя доля карасей 0,6.

