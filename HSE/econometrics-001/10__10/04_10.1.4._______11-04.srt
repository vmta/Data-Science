1
00:00:12,100 --> 00:00:18,950
Рассмотрим пример задачи
на построение дерева.

2
00:00:18,950 --> 00:00:23,288
Итак, у нас есть зависимые
переменные yi и xi.

3
00:00:23,288 --> 00:00:28,349
Исходные данные таковы: по y — 1, 2, 9,

4
00:00:28,349 --> 00:00:34,472
10, 10; и по объясняющей переменной — 1,
2, 3, 4, 5.

5
00:00:34,472 --> 00:00:38,959
Соответственно, наша задача — построить,

6
00:00:38,959 --> 00:00:42,780
построить оптимальное,

7
00:00:42,780 --> 00:00:47,950
оптимальное классификационное дерево,

8
00:00:47,950 --> 00:00:53,160
классификационное дерево, ну,

9
00:00:53,160 --> 00:00:58,540
скажем, с тремя «листиками».

10
00:00:58,540 --> 00:01:04,646
Ну для начала,

11
00:01:04,646 --> 00:01:08,855
прежде, чем строить дерево, давайте для
удобства введем такую функцию — сумму

12
00:01:08,855 --> 00:01:10,882
квадратов остатков от набора чисел.

13
00:01:10,882 --> 00:01:13,060
Если у меня есть какой-то набор чисел,

14
00:01:13,060 --> 00:01:16,560
я его буду просто заменять на
его среднее арифмитическое.

15
00:01:16,560 --> 00:01:20,922
Ну, например,
если у меня есть набор чисел: 1,

16
00:01:20,922 --> 00:01:25,845
2 и 9, вот такой набор из трех чисел.

17
00:01:25,845 --> 00:01:31,020
Ну, естественно, здесь среднее
арифметическое по данному набору чисел,

18
00:01:31,020 --> 00:01:37,254
вот здесь вот y среднее = 1,
2 + 9, деленное на 3 = 4.

19
00:01:37,254 --> 00:01:44,182
И, соответственно, если я прогнозирую
вместо каждого числа 4, то есть

20
00:01:44,182 --> 00:01:47,552
меня просят прогнозировать числа из этого
набора, а я вместо каждого говорю: ну,

21
00:01:47,552 --> 00:01:50,460
вот если выбрать много раз число из
этого набора, ну будет примерно 4.

22
00:01:50,460 --> 00:01:53,708
Вот, естественно,
у меня будет какая-то ошибка.

23
00:01:53,708 --> 00:01:58,781
И сумма квадратов ошибок RSS
для данной ситуации — это (1

24
00:01:58,781 --> 00:02:05,435
− 4) в квадрате + (2 − 4) в
квадрате + (9 − 4) в квадрате.

25
00:02:05,435 --> 00:02:09,129
То есть прогнозировать
я буду очень просто,

26
00:02:09,129 --> 00:02:13,377
средним числом любой набор буду заменять,
а RSS — это, как всегда,

27
00:02:13,377 --> 00:02:18,266
будет сумма квадратов ошибок прогнозов, то
есть прогноз у меня будет равен среднему

28
00:02:18,266 --> 00:02:22,792
числу в наборе, но в данном случае это,
соответственно,

29
00:02:22,792 --> 00:02:27,764
3 в квадрате + 2 в квадрате
+ 5 в квадрате, ну и,

30
00:02:27,764 --> 00:02:31,870
соответственно, получается 9 + 4 + 25,

31
00:02:31,870 --> 00:02:36,940
получается 13 + 25 = 38.

32
00:02:36,940 --> 00:02:42,370
И, если мы поняли, что такое, значит,
как мы прогнозируем любой набор чисел,

33
00:02:42,370 --> 00:02:47,428
и что является суммой квадрат и ошибок,
то мы готовы начать строить дерево.

34
00:02:47,428 --> 00:02:52,967
Итак, у меня изначально в
стартовом узле есть все y: 1,

35
00:02:52,967 --> 00:02:55,780
2, 9, 10 и 10.

36
00:02:55,780 --> 00:03:00,675
И теперь я должен этот набор
данных разделить на 2 части.

37
00:03:00,675 --> 00:03:06,232
Ну, поскольку делить я могу только по
объясняющей переменной, по x, то я могу,

38
00:03:06,232 --> 00:03:11,241
соответственно, задать какой-то вопрос,
там: правда ли, что x > 2,5?

39
00:03:11,241 --> 00:03:13,571
И поделить свой набор вот между 2 и 3.

40
00:03:13,571 --> 00:03:19,424
А могу, например, задать вопрос: а правда
ли, что x > 4 и поделить набор на 2 части.

41
00:03:19,424 --> 00:03:24,370
Соответственно, я этот набор
должен поделить на 2 части,

42
00:03:24,370 --> 00:03:26,670
задав какой-то вопрос по x.

43
00:03:26,670 --> 00:03:31,638
Но, соответственно,
давайте подумаем — как мне, чему равна

44
00:03:31,638 --> 00:03:36,624
сумма квадратов ошибок прогнозов сейчас,
и как мне лучше поделить набор на 2 части?

45
00:03:36,624 --> 00:03:39,830
Ну в настоящий момент,
если я применю эту самую логику,

46
00:03:39,830 --> 00:03:44,544
посчитаю среднее арифметическое
и посчитаю RSS для набора: 1,

47
00:03:44,544 --> 00:03:49,710
2, 9, 10, 10, сейчас окажется,

48
00:03:49,710 --> 00:03:54,904
что, соответственно, у меня y

49
00:03:54,904 --> 00:04:00,060
среднее = 20 и еще 12,

50
00:04:00,060 --> 00:04:05,730
32/5, то есть я каждое число
буду прогнозировать 32/5,

51
00:04:05,730 --> 00:04:11,030
и, соответственно, в данной ситуации RSS

52
00:04:11,030 --> 00:04:16,990
= 81,2 при такой ситуации.

53
00:04:16,990 --> 00:04:21,714
Я могу, вообще говоря,
предложить 4 варианта дележки.

54
00:04:21,714 --> 00:04:27,360
Могу делить 1, 2, 9, 10 и 10, могу делить,

55
00:04:27,360 --> 00:04:34,016
отрезать 1, могу отрезать 2,
могу отрезать 9, могу отрезать одну из 10.

56
00:04:34,016 --> 00:04:36,140
Вот четыре варианта деления.

57
00:04:36,140 --> 00:04:40,852
И нам, соответственно, надо посчитать — на
какие наборы делится наш набор данных при

58
00:04:40,852 --> 00:04:45,168
каждой дележке и посчитать
соответствующую сумму квадратов остатков.

59
00:04:45,168 --> 00:04:48,620
Если я отрежу единичку и
отдельно остальные числа,

60
00:04:48,620 --> 00:04:53,580
то у меня будет набор: 1, 2, 9, 10, 10.

61
00:04:53,580 --> 00:04:58,058
Здесь у меня в наборе находится одно число
— 1, я его смогу идеально прогнозировать.

62
00:04:58,058 --> 00:05:01,966
Если я попал в левый набор,
то я прогнозирую — 1, здесь RSS = 0,

63
00:05:01,966 --> 00:05:06,416
соответственно, суммарный
RSS здесь окажется: 0 +,

64
00:05:06,416 --> 00:05:11,685
здесь я буду прогнозировать,
у меня 4 числа: 10, 10, 9 и 2.

65
00:05:11,685 --> 00:05:14,325
Я буду прогнозировать их
средним арифметическим,

66
00:05:14,325 --> 00:05:16,190
то есть: 10 + 10 + 9 пополам.

67
00:05:16,190 --> 00:05:19,437
То есть, если мне говорят: выпало число
из этого набора, я говорю: ну, наверное,

68
00:05:19,437 --> 00:05:23,495
это вот 31, деленное на 4, примерно.

69
00:05:23,495 --> 00:05:30,940
И RSS для набора: 2, 9, 10,
10 оказывается равным 44,75.

70
00:05:30,940 --> 00:05:36,468
Если я поделю по 2,
у меня будет два набора чисел: 1,

71
00:05:36,468 --> 00:05:41,780
2 и набор чисел: 9, 10 и 10.

72
00:05:41,780 --> 00:05:45,051
И, соответственно,
суммарный RSS будет равен.

73
00:05:45,051 --> 00:05:47,868
Если я попадаю в левый набор,
то я прогнозирую.

74
00:05:47,868 --> 00:05:51,385
Ну, если мне говорят: выпало 1 или 2,
как бы, я, спрогнозировано,

75
00:05:51,385 --> 00:05:53,400
я бы сказал: ну примерно 1,5 выпало.

76
00:05:53,400 --> 00:05:59,660
И, соответственно,
здесь ошибка прогноза — это 0,5.

77
00:05:59,660 --> 00:06:04,220
Ну 0,5 в квадрате + 0,5 в квадрате,
это 0,25 на 2, это 0,5.

78
00:06:04,220 --> 00:06:10,734
И RSS по набору: 9, 10,
10 оказывается равным 2/3.

79
00:06:10,734 --> 00:06:16,552
Аналогично, если я делю по 9: 1, 2, 9.

80
00:06:16,552 --> 00:06:20,820
И отделяю 10-ки в сторонку.

81
00:06:20,820 --> 00:06:26,350
RSS для первого набора, для набора: 1, 2,

82
00:06:26,350 --> 00:06:33,057
9, оказывается равным 38, а во втором
наборе, там находятся только 10-ки,

83
00:06:33,057 --> 00:06:37,060
поэтому я второй набор я прогнозирую
идеально, соответственно RSS там равен 0.

84
00:06:37,060 --> 00:06:41,941
И последний вариант дележки,
если я делю числа на: 1,

85
00:06:41,941 --> 00:06:45,993
2, 9 и 10, и отдельно отделяю 10.

86
00:06:45,993 --> 00:06:50,899
Соответственно, RSS в такой
ситуации по первому набору,

87
00:06:50,899 --> 00:06:55,730
по: 1, 2, 9, 10 равен 65, а по второму
набору, там находится только 10.

88
00:06:55,730 --> 00:06:59,930
Если я знаю число из второго набора,
я могу идеально спрогнозировать 10-кой.

89
00:06:59,930 --> 00:07:02,025
Соответственно, + 0.

90
00:07:02,025 --> 00:07:06,926
Я вижу, что сумма квадратов
ошибок оказывается наименьшей,

91
00:07:06,926 --> 00:07:09,850
если я отделю 1 и 2 от 9, 10 и 10.

92
00:07:09,850 --> 00:07:15,450
Соответственно, первое деление, мне надо
разделить мой набор на две части: 1, 2.

93
00:07:15,450 --> 00:07:21,320
И здесь 9, 10 и 10.

94
00:07:21,320 --> 00:07:26,369
Ну и вопрос про x, который может отделить,
осуществить это разбиение,

95
00:07:26,369 --> 00:07:31,368
это, например,
вопрос: а правда ли, что x больше,

96
00:07:31,368 --> 00:07:36,399
чем, правда ли, что x_i меньше,

97
00:07:36,399 --> 00:07:39,025
чем 2,5, например.

98
00:07:39,025 --> 00:07:42,800
Здесь ответ: да, здесь ответ: нет.

99
00:07:42,800 --> 00:07:48,630
И теперь я могу, вот у меня уже, на таком
простом дереве у меня 2 финальных листика.

100
00:07:48,630 --> 00:07:51,172
Соответственно, 2 терминальных узла.

101
00:07:51,172 --> 00:07:55,770
Ну мне тут разрешено 3 листика,
соответственно, я могу еще одно разбиение

102
00:07:55,770 --> 00:07:59,367
сделать, и чтобы,
терминальных листиков тогда окажется 3.

103
00:07:59,367 --> 00:08:02,910
Ну тут понятны варианты,
что я либо здесь разобью на 2 части,

104
00:08:02,910 --> 00:08:06,030
либо здесь разобью на 2 части.

105
00:08:06,030 --> 00:08:10,742
В любом случае я могу свести
RSS для разбиения к 0.

106
00:08:10,742 --> 00:08:15,317
Ну, действительно, если у меня есть набор
чисел: 1 и 2, то я его, естественно,

107
00:08:15,317 --> 00:08:16,525
разобью на 2 набора.

108
00:08:16,525 --> 00:08:22,178
1, отедельно 2, число 1 прогнозируется
идеально, число 2 прогнозируется идеально.

109
00:08:22,178 --> 00:08:23,441
И набор чисел: 9,

110
00:08:23,441 --> 00:08:28,027
10 и 10 тоже можно легко разбить на
случай идеального прогнозирования.

111
00:08:28,027 --> 00:08:32,484
9 отдельно и 10-ки отдельно.

112
00:08:32,484 --> 00:08:38,407
И, естественно,
здесь RSS до разбиения равен 0,5,

113
00:08:38,407 --> 00:08:42,438
а после разбиения окажется равным 0.

114
00:08:42,438 --> 00:08:48,920
И здесь RSS до разбиения был равен 2/3,
а после разбиения окажется равным нулю.

115
00:08:48,920 --> 00:08:50,746
Поэтому, естественно, мне лучше,

116
00:08:50,746 --> 00:08:54,580
чтобы снижение суммы квадратов ошибок
было сильнее, 2/3 превратить в 0.

117
00:08:54,580 --> 00:08:57,832
Соответственно, я буду
разбивать вот здесь.

118
00:08:57,832 --> 00:09:04,990
Ну мне надо отделить 9 от 10-ок,
ну чтобы отделить 9 от 10-ок,

119
00:09:04,990 --> 00:09:10,743
можно ли задать вопрос,
например: а правда ли, что x_i < 3,5?

120
00:09:10,743 --> 00:09:15,434
Если я задам такой вопрос,
то вот здесь у меня

121
00:09:15,434 --> 00:09:20,449
отделится 9-ка,
а здесь у меня отделится две 10-ки.

122
00:09:20,449 --> 00:09:25,592
Здесь, на случай ответа: да,
здесь на случай ответа: нет.

123
00:09:25,592 --> 00:09:29,540
И вот у меня получилось такое
дерево классификационное,

124
00:09:29,540 --> 00:09:34,321
которое мне будет позволять
предсказывать y, если известен x.

125
00:09:34,321 --> 00:09:39,823
Ну, например, можно с помощью этого дерева
осуществить прогноз для какого-то x.

126
00:09:39,823 --> 00:09:45,675
Ну, например, если мне сказали,
что x равен..., ну не важно,

127
00:09:45,675 --> 00:09:50,426
любое число, 15,
то что прогнозирует мое дерево?

128
00:09:50,426 --> 00:09:52,740
Ну смотрим: x_i < 2,5?

129
00:09:52,740 --> 00:09:55,330
Нет, значит пошли сюда.

130
00:09:55,330 --> 00:09:56,370
xi < 3,5?

131
00:09:56,370 --> 00:09:58,278
Нет, значит пошли сюда.

132
00:09:58,278 --> 00:10:00,980
И дерево говорит: прогноз — 10.

133
00:10:00,980 --> 00:10:04,044
y с крышкой = 10.

134
00:10:04,044 --> 00:10:09,064
Например, если я возьму x = 0,

135
00:10:09,064 --> 00:10:13,510
что прогнозирует мое дерево?

136
00:10:13,510 --> 00:10:17,675
Ну оно задает вопрос: правда ли,
что x < 2,5, говорим: да,

137
00:10:17,675 --> 00:10:21,840
а здесь «валяются» числа 1 и 2, ну среднее
арифметические между ними, это — 1,5.

138
00:10:21,840 --> 00:10:27,330
Поэтому дерево мое прогнозирует,
что y с крышкой равняется 1,5.

139
00:10:27,330 --> 00:10:31,945
И вот так вот сначала можно,

140
00:10:31,945 --> 00:10:36,560
руководствуясь минимизацией RSS,
построить классификационное дерево,

141
00:10:36,560 --> 00:10:39,870
а потом с помощью него можно
осуществлять прогнозы.

142
00:10:39,870 --> 00:10:42,687
Ну, естественно,
я изобразил совсем простую ситуацию,

143
00:10:42,687 --> 00:10:46,480
где у меня одна объясняющая переменная,
поэтому я задаю вопросы только про x.

144
00:10:46,480 --> 00:10:51,372
А если тут много объясняющих переменных,
то, естественно,

145
00:10:51,372 --> 00:10:55,273
вопросы при делении ветви
дерева на две подветви,

146
00:10:55,273 --> 00:11:00,340
можно уже задавать и про x,
и про другую объясняющую переменную z.

