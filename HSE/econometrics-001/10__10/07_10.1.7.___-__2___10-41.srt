1
00:00:13,065 --> 00:00:15,413
Рассмотрим второй пример,

2
00:00:15,413 --> 00:00:20,510
где будет использоваться другое
априорное распределение.

3
00:00:20,510 --> 00:00:23,990
То есть мы, предположим,
ту же самую модель.

4
00:00:23,990 --> 00:00:30,930
Модель будет состоять в том, что в пруду
караси встречаются с вероятностью p,

5
00:00:35,310 --> 00:00:39,690
а щуки встречаются с вероятностью (1- p).

6
00:00:39,690 --> 00:00:46,169
Но на этот раз у нас будет некая
априорная информация об этом p.

7
00:00:46,169 --> 00:00:52,153
Ну, например, бабушка сказала,
которая вот живет рядом с этим озером,

8
00:00:52,153 --> 00:00:57,560
она сказала, что, ну, скажем, она
сказала: «Караси встречаются чаще щук».

9
00:00:57,560 --> 00:01:04,490
Караси встречаются чаще щук.

10
00:01:04,490 --> 00:01:11,640
И наша задача эту априорную информацию
записать в виде функции плотности.

11
00:01:11,640 --> 00:01:15,032
Ну, тут, к сожалению, мы сталкиваемся с
такой проблемой, как в любой реальной

12
00:01:15,032 --> 00:01:18,277
модели, что у нас, как правило,
информация несколько вот такая размытая.

13
00:01:18,277 --> 00:01:20,869
Ну, чаще, а что означает это «чаще»?

14
00:01:20,869 --> 00:01:22,120
Насколько чаще?

15
00:01:22,120 --> 00:01:25,768
И нам надо реализовать это
как-то математически строго

16
00:01:25,768 --> 00:01:28,960
в виде функции плотности
в байесовском подходе.

17
00:01:28,960 --> 00:01:35,110
Ну, давайте для простоты мы скажем,
что функция плотности имеет вот такой вид.

18
00:01:35,110 --> 00:01:40,469
Здесь вот p, здесь 0, здесь 1,
здесь, соответственно, f(p).

19
00:01:40,469 --> 00:01:42,744
Ну и мы будем считать, что, скажем,

20
00:01:42,744 --> 00:01:46,932
априорная функция плотности вот
имеет какой-то такой возрастающий...

21
00:01:46,932 --> 00:01:52,523
Ну, самая простая возрастающая функция
— это, соответственно, линейная.

22
00:01:52,523 --> 00:01:57,418
Здесь вот двоечка, чтобы площадь
под функцией плотности равнялась 1.

23
00:01:57,418 --> 00:02:00,540
Ну и если эту функцию
плотности записывать формулой,

24
00:02:00,540 --> 00:02:05,180
то f(p) окажется равным 2p

25
00:02:05,180 --> 00:02:10,260
при p[0;1] и 0 иначе.

26
00:02:10,260 --> 00:02:15,330
Это, соответственно, модель,
априорное распределение.

27
00:02:15,330 --> 00:02:19,060
Вот я напишу,
что это априорное распределение.

28
00:02:19,060 --> 00:02:21,853
И у меня должны быть какие-то наблюдения.

29
00:02:21,853 --> 00:02:26,770
Ну, пусть наблюдения будут те же самые,
что и были в предыдущем примере.

30
00:02:26,770 --> 00:02:28,472
Наблюдения будут...

31
00:02:28,472 --> 00:02:33,276
Первое наблюдение — это карась,
второе наблюдение — это

32
00:02:33,276 --> 00:02:37,240
щука и третье наблюдение — это карась.

33
00:02:37,240 --> 00:02:40,657
И точно так же еще надо сказать,

34
00:02:40,657 --> 00:02:46,360
что отдельные наблюдения: в модели
мы предполагаем, Y_i-тые независимы.

35
00:02:46,360 --> 00:02:51,680
Вот у нас имеет место полное описание,
необходимое для байесовского анализа.

36
00:02:51,680 --> 00:02:53,300
Есть наблюдения.

37
00:02:53,300 --> 00:02:57,660
Есть априорное мнение о
неизвестном параметре p.

38
00:02:57,660 --> 00:02:59,389
И есть модель для наблюдений.

39
00:02:59,389 --> 00:03:03,445
Вот эти три ингредиента позволяют
нам получить апостериорное мнение,

40
00:03:03,445 --> 00:03:08,127
то есть мнение с учетом наблюдений,
с учетом имеющейся информации.

41
00:03:08,127 --> 00:03:13,086
Ну, значит, наша задача будет
посчитать следующее: во-первых,

42
00:03:13,086 --> 00:03:18,056
посчитать апостериорное
распределение f(p|Y_1,Y_2,Y_3) и

43
00:03:18,056 --> 00:03:23,445
сравнить E(p) и

44
00:03:23,445 --> 00:03:29,940
E(p) с учетом информации,
содержащейся в Y1, ..., Y3.

45
00:03:29,940 --> 00:03:34,360
И сравнить вероятность того,

46
00:03:34,360 --> 00:03:40,112
что p > 0,5 без учета наблюдений,

47
00:03:40,112 --> 00:03:48,120
и сравнить ту же самую вероятность с
учетом имеющихся наблюдений Y_1, ..., Y_3.

48
00:03:48,120 --> 00:03:52,315
То есть еще раз, по смыслу,
что вот это за показатель?

49
00:03:52,315 --> 00:03:58,428
Это ожидаемая доля,
ожидаемая доля карасей.

50
00:03:58,428 --> 00:04:00,332
А что вот это такое?

51
00:04:00,332 --> 00:04:04,459
Это вероятность того,
что карасей больше, чем щук.

52
00:04:04,459 --> 00:04:07,730
Ну, соответственно,
априорная и апостериорная.

53
00:04:07,730 --> 00:04:10,575
Это вероятность того,

54
00:04:10,575 --> 00:04:15,760
что карасей больше, чем щук.

55
00:04:15,760 --> 00:04:20,110
Ну, поехали.

56
00:04:20,110 --> 00:04:25,050
Ну, для начала давайте посмотрим,
чему равно E(p).

57
00:04:25,050 --> 00:04:29,960
Изначально, если я вот пользуюсь только
информацией «караси встречаются чаще щук»,

58
00:04:29,960 --> 00:04:33,154
реализованной в виде функции плотности,
то, соответственно,

59
00:04:33,154 --> 00:04:37,818
я должен взять интеграл от 0 до 1,
p помножить на функцию плотности,

60
00:04:37,818 --> 00:04:41,575
и у меня получится интеграл от 0 до 1,

61
00:04:41,575 --> 00:04:46,553
p * 2pdp, получается равно 2/3.

62
00:04:46,553 --> 00:04:51,495
И априорная вероятность того,
что карасей больше,

63
00:04:51,495 --> 00:04:56,327
чем щук, то есть карасей больше 50
процентов, это, соответственно,

64
00:04:56,327 --> 00:05:02,110
интеграл от 0,5 до 1,
функция от плотности pdp и это есть...

65
00:05:02,110 --> 00:05:07,810
Ну, если взять этот
интеграл от 0,5 до 1 от 2p,

66
00:05:07,810 --> 00:05:10,442
то есть это площадь...

67
00:05:10,442 --> 00:05:12,000
Здесь 0,5.

68
00:05:12,000 --> 00:05:14,286
Это вот эта площадь.

69
00:05:14,286 --> 00:05:16,968
И она окажется — ну, например,

70
00:05:16,968 --> 00:05:21,740
по формуле площади трапеции или
через взятие интеграла — равна 0,75.

71
00:05:21,740 --> 00:05:27,155
Вот это мое априорное мнение о ситуации
в озере до получения информации.

72
00:05:27,155 --> 00:05:28,505
Ну а теперь поехали.

73
00:05:28,505 --> 00:05:32,690
Исследуем апостериорную функцию плотности.

74
00:05:32,690 --> 00:05:37,110
Давайте оставим место
для графика и получим

75
00:05:37,110 --> 00:05:42,785
апостериорную функцию плотности Y_1,
Y_2, Y_3.

76
00:05:42,785 --> 00:05:47,342
Мы уже говорили,
что она с точностью до сомножителя равна

77
00:05:47,342 --> 00:05:52,610
произведению модели f(Y|p),

78
00:05:52,610 --> 00:05:55,906
— то есть чему равна вероятность
получить наши данные,

79
00:05:55,906 --> 00:06:01,952
если p мысленно зафиксировать, — помножить
на априорную функцию плотности p.

80
00:06:01,952 --> 00:06:06,248
Ну, давайте подумаем, чему равна
вероятность получить такие Y-ки,

81
00:06:06,248 --> 00:06:08,550
вот такие вот, как у нас, если p известно.

82
00:06:08,550 --> 00:06:12,935
Ну, если p известно, то вероятность
карася — p, щуки — (1- p), карася — p,

83
00:06:12,935 --> 00:06:17,320
и нам надо их все
перемножить: p * (1- p) * p.

84
00:06:17,320 --> 00:06:23,310
p * (1- p) * p, это,
соответственно, взялось из модели.

85
00:06:23,310 --> 00:06:29,300
И еще априорная функция
плотности — она просто 2p,

86
00:06:29,300 --> 00:06:33,577
и получаем,
что с точностью до сомножителя,

87
00:06:33,577 --> 00:06:39,664
до константы — это p куб * (1- p) Ну,

88
00:06:39,664 --> 00:06:47,111
соответственно, это верна формула при
p от 0 до 1, а иначе получается 0.

89
00:06:47,111 --> 00:06:51,638
Вот такая вот у нас
апостериорная функция плотности.

90
00:06:51,638 --> 00:06:55,720
Ну, поскольку интеграл под любой
функцией плотности должен равняться 1,

91
00:06:55,720 --> 00:07:00,315
то можно восстановить пропущенный
множитель, который я потерял,

92
00:07:00,315 --> 00:07:03,490
когда здесь не поделил
на функцию плотности Y.

93
00:07:03,490 --> 00:07:07,979
То есть можно восстановить пропущенную
константу так, чтобы интеграл...

94
00:07:07,979 --> 00:07:11,960
То есть у меня есть условие,
что интеграл от 0 до 1,

95
00:07:11,960 --> 00:07:19,378
f(p|Y)dp должен равняться 1,
и отсюда если взять интеграл,

96
00:07:19,378 --> 00:07:23,850
он окажется равен 1/20 вот этот,
и его надо будет домножить на 20.

97
00:07:23,850 --> 00:07:28,850
Соответственно, f(p|Y) = 20

98
00:07:28,850 --> 00:07:36,810
* p в кубе * (1- p) или 0 — это при p,
лежащем от 0 до 1.

99
00:07:36,810 --> 00:07:42,600
И можно нарисовать, соответственно,
апостериорную функцию плотности,

100
00:07:42,600 --> 00:07:46,820
опять же, от 0 до 1.

101
00:07:46,820 --> 00:07:49,697
Выглядит она немножко другим образом.

102
00:07:49,697 --> 00:07:51,140
Она выглядит...

103
00:07:51,140 --> 00:07:54,011
Вот здесь она начинается очень медленно,

104
00:07:54,011 --> 00:07:58,593
потом она резко поднимается вверх
и вот так вот опускается вниз.

105
00:07:58,593 --> 00:08:01,783
То есть это апостериорная
функция плотности.

106
00:08:01,783 --> 00:08:06,263
Она имеет, соответственно, вот такую
вот формулу: 20p в кубе * (1- p), и,

107
00:08:06,263 --> 00:08:11,447
соответственно, я вижу,
что если учесть информацию от

108
00:08:11,447 --> 00:08:16,773
бабушки априорную до получения наблюдений,
учесть наблюдения,

109
00:08:16,773 --> 00:08:20,788
то у нас получится
апостериорное мнение о p.

110
00:08:20,788 --> 00:08:24,925
То есть шансы, что я верю,
что карасей в озере мало, они минимальны.

111
00:08:24,925 --> 00:08:27,990
Вот здесь вот очень низко
проходит функция плотности.

112
00:08:27,990 --> 00:08:32,642
Ну и, соответственно, эта новая функция
плотности апостериорная, — давайте отмечу,

113
00:08:32,642 --> 00:08:36,605
что здесь f(p|Y) при условии
известных Y-ов наблюдений,

114
00:08:36,605 --> 00:08:41,365
— она позволяет мне пересчитать,
что я ожидаю от доли карасей и

115
00:08:41,365 --> 00:08:45,810
что я ожидаю от вероятности того,
что карасей больше, чем щук.

116
00:08:45,810 --> 00:08:49,937
Соответственно, с использованием вот
этой функции плотности, если я считаю

117
00:08:49,937 --> 00:08:55,452
математическое ожидание как интеграл,
E(p|Y), то есть это интеграл от 0 до 1,

118
00:08:55,452 --> 00:09:00,207
p помножить на условную функцию
плотности по dp, и окажется,

119
00:09:00,207 --> 00:09:06,984
если я проинтегрирую p помножить на
эту штуку, здесь окажется тоже 2/3.

120
00:09:06,984 --> 00:09:11,829
То есть оказывается, что мои, как бы,

121
00:09:11,829 --> 00:09:16,441
повышенные наблюдения карасей оно
вот подтверждает информацию от

122
00:09:16,441 --> 00:09:20,049
бабушки и поэтому никак не
искажает математическое ожидание.

123
00:09:20,049 --> 00:09:21,992
Что я думал, так я примерно...

124
00:09:21,992 --> 00:09:26,067
Данные подтверждают вот это матожидание,
поэтому оно не поменялось.

125
00:09:26,067 --> 00:09:27,950
А вероятность она еще вырастет.

126
00:09:27,950 --> 00:09:33,280
То есть вероятность того, что карасей
больше, чем щук при известных Y-ках...

127
00:09:33,280 --> 00:09:38,893
Мне, соответственно,
надо взять интеграл от 0,5 до 1 условной

128
00:09:38,893 --> 00:09:44,349
функции f(p|Y) И если взять
интеграл от этой функции плотности,

129
00:09:44,349 --> 00:09:50,650
ну, не забыв двадцатку, конечно,
то получится результат 13/16.

130
00:09:50,650 --> 00:09:54,020
Ну, это примерно 0,81.

131
00:09:54,020 --> 00:09:58,174
То есть это означает, что изначально
я думал, что вероятность того,

132
00:09:58,174 --> 00:10:01,580
что карасей больше,
чем щук — 0,75, три четверти,

133
00:10:01,580 --> 00:10:05,793
а когда я получил вот эти
наблюдения — карась, щука, карась,

134
00:10:05,793 --> 00:10:11,785
я стал оценивать вероятность того,
что карасей больше, чем щук, как 0,81.

135
00:10:11,785 --> 00:10:15,958
Еще раз хочу подчеркнуть,
что в байесовском подходе вся информация о

136
00:10:15,958 --> 00:10:19,474
неизвестном параметре
описывается функцией плотности.

137
00:10:19,474 --> 00:10:22,613
Вот это функция плотности
до получения наблюдений,

138
00:10:22,613 --> 00:10:25,578
вот это функция плотности
после получения наблюдений.

139
00:10:25,578 --> 00:10:28,326
И дальше с помощью нее можно
ответить на любые вопросы,

140
00:10:28,326 --> 00:10:31,596
как расчет любого среднего
или любой вероятности.

141
00:10:31,596 --> 00:10:36,639
Но еще раз — надо помнить о том,
что p трактуется

142
00:10:36,639 --> 00:10:41,500
как случайная величина.

