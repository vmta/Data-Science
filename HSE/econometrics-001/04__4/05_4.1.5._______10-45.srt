1
00:00:13,250 --> 00:00:18,940
Посчитаем первую главную компоненту.

2
00:00:18,940 --> 00:00:24,128
Перед нами простой набор
данных с двумя переменными,

3
00:00:24,128 --> 00:00:26,770
a₁ и a₂, и тремя наблюдениями.

4
00:00:26,770 --> 00:00:33,970
2, 4, 0 по переменной a₁ и 5,
1, 3 по переменной a₂.

5
00:00:33,970 --> 00:00:38,820
И наша задача – посчитать
первую главную компоненту,

6
00:00:38,820 --> 00:00:43,125
то есть как выглядит в этом наборе
данных новая искусственная переменная,

7
00:00:43,125 --> 00:00:45,690
так называемая первая главная компонента.

8
00:00:45,690 --> 00:00:52,179
Как всегда в методе главных компонент,
сначала мы центрируем наше наблюдение,

9
00:00:52,179 --> 00:00:59,780
то есть мы от a₁ и a₂ переходим к x₁,

10
00:00:59,780 --> 00:01:05,310
x₁ = a₁- a₁ среднее,
вектор x₂ = a₂- a₂ среднее.

11
00:01:05,310 --> 00:01:09,708
Ну, нетрудно посчитать, что в нашем

12
00:01:09,708 --> 00:01:14,868
примере a₁ среднее равно 2, а a₂ среднее,

13
00:01:14,868 --> 00:01:21,037
среднее арифметическое этих
чисел (5 +1 + 3)/3 = 3.

14
00:01:21,037 --> 00:01:24,620
Соответственно, наши новые переменные,

15
00:01:24,620 --> 00:01:30,410
с которыми удобно находить
главные компоненты,

16
00:01:30,410 --> 00:01:34,298
имеют вид 0, 2,

17
00:01:34,298 --> 00:01:38,360
-2 и 2,

18
00:01:38,360 --> 00:01:43,390
-2 и 0.

19
00:01:43,390 --> 00:01:50,840
И теперь мы переходим непосредственно
к поиску первой главной компоненты.

20
00:01:50,840 --> 00:01:56,579
Я напомню, что первая главная компонента –
это некая комбинация линейная с некоторыми

21
00:01:56,579 --> 00:02:02,786
весами x₁ и x₂,
то есть это число αx₁ + βx₂.

22
00:02:02,786 --> 00:02:07,010
Я обращу внимание, что α и β – это числа,

23
00:02:07,010 --> 00:02:11,656
α и β – это числа, а, соответственно, x₁,

24
00:02:11,656 --> 00:02:15,520
x₂ и pc₁ – это вектора.

25
00:02:15,520 --> 00:02:21,520
И мы хотим подобрать такие веса,

26
00:02:21,520 --> 00:02:25,430
которые, с одной стороны,

27
00:02:25,430 --> 00:02:29,492
невелики в том смысле,
что α² + β² = 1,

28
00:02:29,492 --> 00:02:34,471
а с другой стороны, мы хотим подобрать
такую пропорцию между x₁ и x₂,

29
00:02:34,471 --> 00:02:38,830
чтобы первая главная компонента
имела наибольший разброс.

30
00:02:38,830 --> 00:02:43,475
Ну, в данном случае наибольший разброс,
мы имеем в виду,

31
00:02:43,475 --> 00:02:49,309
что выборочная дисперсия первой главной
компоненты должна быть максимальна,

32
00:02:49,309 --> 00:02:53,732
и мы это будем максимизировать по α₁ и α₂.

33
00:02:53,732 --> 00:02:59,900
Поскольку x₁ и x₂ имеют нулевое среднее,

34
00:02:59,900 --> 00:03:03,618
мы специально отцентрировали переменные,

35
00:03:03,618 --> 00:03:08,320
чтобы получилось нулевое среднее, то
поэтому максимизация выборочной дисперсии,

36
00:03:08,320 --> 00:03:13,732
она равносильна максимизации
просто длины вектора pc₁.

37
00:03:13,732 --> 00:03:19,591
То есть можно просто максимизировать
длину вектора pc₁ или квадрат длины,

38
00:03:19,591 --> 00:03:25,690
чтобы не извлекать корень, можно просто
максимизировать квадрат длины вектора

39
00:03:25,690 --> 00:03:30,420
pc₁ по α и β, то есть максимизировать
сумму квадратов его компонентов.

40
00:03:30,420 --> 00:03:34,290
Ну, посчитаем эту первую
главную компоненту.

41
00:03:34,290 --> 00:03:37,908
Значит, первая главная компонента.

42
00:03:37,908 --> 00:03:44,840
Для первого наблюдения это αx₁ + βx₂,
то есть это β*2.

43
00:03:44,840 --> 00:03:51,810
Для второго наблюдения это α*2- β*2,

44
00:03:51,810 --> 00:03:56,352
и для третьего наблюдения

45
00:03:56,352 --> 00:04:00,845
это -2α, α*(-2).

46
00:04:00,845 --> 00:04:05,959
Соответственно, квадрат длины первой

47
00:04:05,959 --> 00:04:12,130
главной компоненты – это есть

48
00:04:12,130 --> 00:04:18,433
(2β)² + (2α-
2β)² + (-2α)²

49
00:04:18,433 --> 00:04:23,590
Раскрываем скобки и
приводим подобные слагаемые.

50
00:04:23,590 --> 00:04:28,876
4β² + 4α² - 8αβ

51
00:04:28,876 --> 00:04:34,420
+ 4β² + 4α²

52
00:04:34,420 --> 00:04:38,620
= 8α² +

53
00:04:38,620 --> 00:04:43,507
8β² - 8αβ.

54
00:04:43,507 --> 00:04:49,739
Можно немножко эту функцию упростить.

55
00:04:49,739 --> 00:04:55,009
Из-за того,
что у нас α² + β² = 1,

56
00:04:55,009 --> 00:05:00,940
то вот это выражение 8α² +
8β² у нас обязано равняться 8.

57
00:05:00,940 --> 00:05:03,445
Получаем 8- 8αβ.

58
00:05:03,445 --> 00:05:08,210
И чтобы найти максимум этой
функции при данном ограничении,

59
00:05:08,210 --> 00:05:12,360
можно, конечно, воспользоваться методом
Лагранжа, но мы поступим чуть-чуть проще.

60
00:05:12,360 --> 00:05:15,928
С помощью небольшого изящного
трюка мы поделим на 1.

61
00:05:15,928 --> 00:05:20,280
Ну, можно любое выражение поделить
на 1 совершенно бесплатно.

62
00:05:20,280 --> 00:05:26,480
(8- 8αβ)/(α² + β²)

63
00:05:26,480 --> 00:05:32,240
А теперь числитель и знаменатель
этого выражения поделим на α².

64
00:05:32,240 --> 00:05:38,130
Получим 8- 8β/α

65
00:05:38,130 --> 00:05:43,355
8- 8β/α, а здесь 1

66
00:05:43,355 --> 00:05:48,750
+ β²/α².

67
00:05:48,750 --> 00:05:55,296
И здесь я вижу,
что хотя α и β у меня связаны,

68
00:05:55,296 --> 00:05:59,237
α² + β² должно равняться 1,

69
00:05:59,237 --> 00:06:02,790
однако пропорция α к β,
отношение α к β может быть любым.

70
00:06:02,790 --> 00:06:07,238
И, таким образом, я свел задачу с
ограничением к задаче без ограничения.

71
00:06:07,238 --> 00:06:13,730
Только надо сделать замену, сказать, что
β/α равняется какой-то новой переменой t,

72
00:06:13,730 --> 00:06:19,760
и наше выражение равняется
(8- 8t)/(1+t²).

73
00:06:19,760 --> 00:06:24,570
И я хочу это выражение промаксимизировать,

74
00:06:24,570 --> 00:06:28,299
подобрав наилучшую пропорцию между α и β.

75
00:06:28,299 --> 00:06:32,595
Ну, давайте это выражение
обзовем какой-нибудь функцией,

76
00:06:32,595 --> 00:06:38,170
это будет функция Q(t), да,
это будет функция Q(t).

77
00:06:38,170 --> 00:06:43,294
Берем ее производную, Q'(t)

78
00:06:43,294 --> 00:06:48,390
= -(1 + t²) в квадрате,

79
00:06:48,390 --> 00:06:53,810
а здесь будет производная
числителя 8 на знаменатель

80
00:06:53,810 --> 00:07:00,116
минус производная знаменателя
2t помножить на числитель 8t.

81
00:07:00,116 --> 00:07:07,118
Приравниваем производную к 0, получаем,

82
00:07:07,118 --> 00:07:15,747
что в числителе получаем
8- 8t² = 0.

83
00:07:15,747 --> 00:07:21,804
Отсюда получаем 2 подозрительных
на экстремум точки: +1 и t = -1.

84
00:07:21,804 --> 00:07:26,115
Ну, давайте посмотрим на нашу функцию.

85
00:07:26,115 --> 00:07:29,416
Наша функция (8- 8t)/(1+t²).

86
00:07:29,416 --> 00:07:33,479
Если я подставлю сюда 1,
то дробь будет вычитаться.

87
00:07:33,479 --> 00:07:37,725
Если я подставлю сюда -1,
то дробь будет прибавляться,

88
00:07:37,725 --> 00:07:40,100
потому что тут минус на минус даст плюс.

89
00:07:40,100 --> 00:07:44,827
Соответственно, точкой максимума,
а я ищу именно максимум,

90
00:07:44,827 --> 00:07:48,245
точкой максимума является t = -1.

91
00:07:48,245 --> 00:07:52,895
Соответственно, мы обнаружили,

92
00:07:52,895 --> 00:07:58,110
что для того, чтобы максимизировать
разброс первой главной компоненты,

93
00:07:58,110 --> 00:08:04,070
нам нужно взять отношение β/α = -1.

94
00:08:04,070 --> 00:08:09,080
Ну, и, конечно,
α-квадрат + β-квадрат обязано равняться 1.

95
00:08:09,080 --> 00:08:14,960
β, стало быть, = -α, подставляем сюда,

96
00:08:14,960 --> 00:08:19,076
получаем α-квадрат + (-α) в квадрате = 1,

97
00:08:19,076 --> 00:08:22,660
2α-квадрат = 1, α-квадрат = 1/2.

98
00:08:22,660 --> 00:08:25,120
И здесь получается 2 решения.

99
00:08:25,120 --> 00:08:29,311
Одно решение: α = 1/√2,

100
00:08:29,311 --> 00:08:35,359
тогда ему соответствует β = -1/√2.

101
00:08:35,359 --> 00:08:41,249
И второе решение: α = -1/√2,

102
00:08:41,249 --> 00:08:44,100
а β = 1/√2.

103
00:08:44,100 --> 00:08:48,609
При этом разброс у первой главной
компоненты будет совершенно одинаковый,

104
00:08:48,609 --> 00:08:53,829
поскольку он определяется только
величиной t, а t в обоих случаях = -1.

105
00:08:53,829 --> 00:08:57,806
Какое из этих двух решений выбрать,
абсолютно неважно.

106
00:08:57,806 --> 00:09:00,730
И то, и то можно назвать
первой главной компонентой.

107
00:09:00,730 --> 00:09:04,800
Давайте просто для определенности
выберем первое решение,

108
00:09:04,800 --> 00:09:08,870
но не ошибкой будет
выбрать и второе решение.

109
00:09:08,870 --> 00:09:14,012
Соответственно, мы получаем,
что наша первая главная компонента

110
00:09:14,012 --> 00:09:21,140
в нашем примере pc₁ = (1/√2)x₁- (1/√2)x₂.

111
00:09:21,140 --> 00:09:25,717
Ну, и поскольку мы

112
00:09:25,717 --> 00:09:30,403
знаем вектора x₁ и x₂, то мы получаем,

113
00:09:30,403 --> 00:09:37,070
что первая главная компонента
равна следующему вектору.

114
00:09:37,070 --> 00:09:42,315
Давайте запишем ее лучше в столбик в
табличку первая главная компонента,

115
00:09:42,315 --> 00:09:47,795
чтобы подчеркнуть, что у нее 3 наблюдения.

116
00:09:47,795 --> 00:09:53,560
0- 2/√2 = -√2;

117
00:09:53,560 --> 00:09:58,560
2/√2 = √2 + √2

118
00:09:58,560 --> 00:10:03,271
= 2√2; и здесь

119
00:10:03,271 --> 00:10:09,130
будет -√2 -√2.

120
00:10:09,130 --> 00:10:13,200
Соответственно, вот она
искусственная новая,

121
00:10:13,200 --> 00:10:17,270
искусственная новая переменная,
которая, с одной стороны,

122
00:10:17,270 --> 00:10:22,268
линейно выражается через центрированные
исходные переменные, а с другой стороны,

123
00:10:22,268 --> 00:10:26,086
имеет максимальную дисперсию,
максимальный разброс, и,

124
00:10:26,086 --> 00:10:30,480
соответственно, ее можно использовать
для дальнейшего анализа.

125
00:10:30,480 --> 00:10:34,769
На этом простом примере мы поняли,
как считать главные компоненты.

126
00:10:34,769 --> 00:10:39,843
Давайте теперь узнаем,
какими свойствами они обладают и зачем

127
00:10:39,843 --> 00:10:45,350
они могут пригодиться.

