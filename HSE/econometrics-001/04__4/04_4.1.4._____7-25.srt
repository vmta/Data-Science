1
00:00:13,250 --> 00:00:20,016
Теперь перейдем к очень ценному
методу главных компонентов.

2
00:00:20,016 --> 00:00:24,404
Он может пригодиться в разных задачах: и
когда у вас много-много-много переменных,

3
00:00:24,404 --> 00:00:27,300
а вы хотите хоть как-то
представить себе ваш набор данных,

4
00:00:27,300 --> 00:00:32,294
и визуализировать его,
или сохранить максимум информации о

5
00:00:32,294 --> 00:00:35,650
ваших данных в минимальном
количестве переменных.

6
00:00:35,650 --> 00:00:38,700
Для всего этого вам пригодится
метод главных компонентов.

7
00:00:38,700 --> 00:00:41,880
Еще он может пригодиться и в
борьбе с мультиколлинеарностью.

8
00:00:41,880 --> 00:00:45,491
Соответственно, в чем суть
метода главных компонентов?

9
00:00:45,491 --> 00:00:50,700
Он позволяет уменьшить число переменных,
выбрав самые изменчивые из них.

10
00:00:50,700 --> 00:00:56,502
А именно, по своей математической
сути — это просто замена переменных,

11
00:00:56,502 --> 00:00:58,027
переход к новым переменным.

12
00:00:58,027 --> 00:01:02,076
Ну если рассмотреть совсем-совсем
простой пример: было у вас две исходных

13
00:01:02,076 --> 00:01:05,072
переменных, давайте для
простоты представим себе,

14
00:01:05,072 --> 00:01:09,473
что они центрированы,
то есть у них среднее значение равно нулю.

15
00:01:09,473 --> 00:01:13,941
Итак, было у вас два исходных
регрессора: x1 и x2.

16
00:01:13,941 --> 00:01:19,265
И метод главных компонент
позволит из этих регрессоров,

17
00:01:19,265 --> 00:01:22,561
возможно сильно
коррелированных между собой,

18
00:01:22,561 --> 00:01:27,361
получить две новых переменных, которые
будут между собой некоррелированы и

19
00:01:27,361 --> 00:01:31,540
которые будут представлять собой
взвешенные исходные переменные.

20
00:01:31,540 --> 00:01:33,850
Ну, например, так может оказаться,

21
00:01:33,850 --> 00:01:38,106
что первая главная компонента равна 1
делить на корень из двух помножить на

22
00:01:38,106 --> 00:01:42,540
первый регрессор плюс 1 делить на корень
из двух помножить на второй регрессор.

23
00:01:42,540 --> 00:01:47,025
А вторая главная компонента, например,
так может оказаться равна половине

24
00:01:47,025 --> 00:01:51,510
первого регрессора минус корень из
трех на два второго регрессора.

25
00:01:51,510 --> 00:01:55,926
Вот эти веса они в методе
главных компонентов всегда

26
00:01:55,926 --> 00:01:59,389
должны подчиняться
следующему условию: сумма

27
00:01:59,389 --> 00:02:03,770
квадратов весов любой главной
компоненты должна равняться единице.

28
00:02:03,770 --> 00:02:07,735
То есть в данном случае: один делить на
корень из двух в квадрате — это половина

29
00:02:07,735 --> 00:02:11,420
плюс еще один делить на корень из
двух — это половина, получается один.

30
00:02:11,420 --> 00:02:15,988
То есть сумма весов в каждой
главной компоненте равна единичке.

31
00:02:15,988 --> 00:02:23,018
Итак, метод главных компонент создает
нам новые переменные, исходя из старых.

32
00:02:23,018 --> 00:02:28,038
При этом, какова же цель
создания этих новых переменных?

33
00:02:28,038 --> 00:02:32,152
А цель такая: надо выбрать
максимально изменчивые переменные,

34
00:02:32,152 --> 00:02:33,920
забрать всю изменчивость.

35
00:02:33,920 --> 00:02:38,415
Поэтому, первая главная
компонента pc1 имеет

36
00:02:38,415 --> 00:02:42,910
максимальную выборочную дисперсию,
то есть алгоритм так подбирает веса,

37
00:02:42,910 --> 00:02:47,867
чтобы разброс первой главной компоненты
был максимально возможным, ну,

38
00:02:47,867 --> 00:02:52,508
естественно, при ограничении,
что сумма квадратов весов каждого

39
00:02:52,508 --> 00:02:57,820
входящего регрессора в первую главную
компоненту равнялась бы единичке.

40
00:02:57,820 --> 00:03:01,141
Затем, когда у нас сформирована
первая главная компонента,

41
00:03:01,141 --> 00:03:03,899
мы можем сформировать
вторую главную компоненту.

42
00:03:03,899 --> 00:03:07,707
Вторая главная компонента ее
веса алгоритм подбирает так,

43
00:03:07,707 --> 00:03:12,878
чтобы с одной стороны, эта вторая
главная компонента была некоррелирована

44
00:03:12,878 --> 00:03:16,803
с первой главной компонентой,
а с другой, чтобы эта вторая главная

45
00:03:16,803 --> 00:03:21,680
компонента имела тоже дисперсию выборочную
побольше, максимальную из возможных.

46
00:03:21,680 --> 00:03:28,120
И так далее подбираются веса каждой
последующей главной компоненты.

47
00:03:28,120 --> 00:03:32,542
Соответственно, веса третьей
главной компоненты подбираются так,

48
00:03:32,542 --> 00:03:36,647
чтобы третья главная компонента,
третья искусственная переменная была

49
00:03:36,647 --> 00:03:40,363
некоррелирована с первой главной
компонентой, некоррелирована со второй

50
00:03:40,363 --> 00:03:45,420
главной компонентой и имела при этих двух
условиях максимально возможную дисперсию.

51
00:03:45,420 --> 00:03:49,440
Давайте рассмотрим игрушечный
пример для пояснения этой идеи.

52
00:03:49,440 --> 00:03:56,070
Рассмотрим результаты, скажем, по
биологии и по математике различных людей.

53
00:03:56,070 --> 00:03:59,430
Вот у нас есть оценки по
биологии и по математике.

54
00:03:59,430 --> 00:04:04,946
Если наша задача как можно сильней
дифференцировать школьников,

55
00:04:04,946 --> 00:04:10,497
то есть отобрать предмет, который бы
сильней всего их дифференцировал.

56
00:04:10,497 --> 00:04:13,230
Мы видим,
что по биологии почти у всех стоит 4.

57
00:04:13,230 --> 00:04:17,591
Поэтому, для задачи
дифференциации школьников

58
00:04:17,591 --> 00:04:22,040
биологию использовать в
данном примере нехорошо.

59
00:04:22,040 --> 00:04:26,130
Гораздо удобней использовать математику,
поскольку выше разброс оценок.

60
00:04:26,130 --> 00:04:30,799
И поэтому в данном игрушечном примере
первой главной компонентой будет

61
00:04:30,799 --> 00:04:34,740
математика, а вторая главная
компонента это будет биология.

62
00:04:34,740 --> 00:04:38,053
Сейчас мы на простом примере
попробуем проиллюстрировать,

63
00:04:38,053 --> 00:04:41,762
что такое главная компонента, ну и заодно
посчитать первую главную компоненту при

64
00:04:41,762 --> 00:04:43,290
небольшом количестве наблюдений.

65
00:04:43,290 --> 00:04:51,636
Итак, представим себе, что у нас есть две
переменные: a1 и a2 и какие-то наблюдения.

66
00:04:51,636 --> 00:04:56,320
Соответственно, на
плоскости можно представить

67
00:04:56,320 --> 00:05:01,230
наш набор наблюдений в виде облака точек.

68
00:05:01,230 --> 00:05:07,090
Есть координаты a₁,
a₂ и некое облако точек.

69
00:05:07,090 --> 00:05:10,976
Для удобства мы центрируем
наши переменные.

70
00:05:10,976 --> 00:05:14,970
То есть находим
геометрический центр облака,

71
00:05:14,970 --> 00:05:20,580
и получаем новые переменные:

72
00:05:20,580 --> 00:05:26,573
x₂ и

73
00:05:26,573 --> 00:05:31,140
x₁.

74
00:05:31,140 --> 00:05:36,620
То есть x₁ = a₁ – a₁ среднее

75
00:05:36,620 --> 00:05:41,960
и x₂ = a₂ – a₂ среднее.

76
00:05:41,960 --> 00:05:44,891
Это одна из возможных замен переменных,

77
00:05:44,891 --> 00:05:49,568
и главная компонента — это всего
лишь другая замена переменных.

78
00:05:49,568 --> 00:05:56,485
Главные компоненты вводят новые, точно
так же перпендикулярные оси pc1 и pc2.

79
00:05:56,485 --> 00:06:01,880
Причем, первая главная компонента,

80
00:06:01,880 --> 00:06:07,836
она устроена таким образом,
она проходит так,

81
00:06:07,836 --> 00:06:13,060
чтобы вдоль нее изменчивость
показателей была максимальной.

82
00:06:13,060 --> 00:06:18,574
То есть в данном случае облако вытянуто
в этом направлении, а в этом оно сжатое.

83
00:06:18,574 --> 00:06:24,348
Соответственно, первая главная
компонента пройдет примерно вот так вот.

84
00:06:24,348 --> 00:06:28,070
Это будет первая главная компонента.

85
00:06:28,070 --> 00:06:33,220
А вторая главная компонента
будет перпендикулярна первой.

86
00:06:38,630 --> 00:06:43,073
Соответственно, у каждой

87
00:06:43,073 --> 00:06:47,748
точки будут старые координаты.

88
00:06:47,748 --> 00:06:54,660
Если это точка A,
то у нее есть старые координаты — a₁(A),

89
00:06:54,660 --> 00:06:58,850
есть a₂(A),

90
00:06:58,850 --> 00:07:03,974
и есть новые координаты —
координаты в главных компонентах

91
00:07:03,974 --> 00:07:08,311
— pc1(A) и

92
00:07:08,311 --> 00:07:13,170
pc2(A).

93
00:07:13,170 --> 00:07:18,361
Ну а теперь давайте попробуем на
простом численном примере найти

94
00:07:18,361 --> 00:07:25,610
эти самые новые координаты.

