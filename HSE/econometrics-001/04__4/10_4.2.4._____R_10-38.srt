1
00:00:13,470 --> 00:00:19,002
Теперь перейдем к методу
главных компонент.

2
00:00:19,002 --> 00:00:20,668
Метод главных компонент, в частности,

3
00:00:20,668 --> 00:00:25,675
позволяет среди сильно коррелированных
переменных выбрать одну или две,

4
00:00:25,675 --> 00:00:31,240
которые бы поймали практически всю
совокупную дисперсию набора переменных.

5
00:00:31,240 --> 00:00:36,710
Второй сюжет — это метод
главных компонент.

6
00:00:36,710 --> 00:00:40,610
Давайте возьмем данные по многоборью.

7
00:00:40,610 --> 00:00:45,510
Набор данных heptathlon,
встроенный в пакет HSAUR.

8
00:00:45,510 --> 00:00:49,296
Можно почитать к нему документацию.

9
00:00:49,296 --> 00:00:55,535
help(heptathlon) Это

10
00:00:55,535 --> 00:00:59,768
результаты Сеульских Олимпийских
игр 1988-го года.

11
00:00:59,768 --> 00:01:04,335
И давайте посмотрим,
бросим взгляд на набор данных h.

12
00:01:04,335 --> 00:01:11,630
Соответственно, здесь есть результаты
бега с препятствиями в секундах,

13
00:01:11,630 --> 00:01:15,820
есть прыжки в высоту,
есть забег 200 метров,

14
00:01:15,820 --> 00:01:20,776
есть javelin (метание копья) и так далее.

15
00:01:20,776 --> 00:01:24,084
Score — это результат за многоборье,

16
00:01:24,084 --> 00:01:27,140
который рассчитывается на основании
исходных семи переменных.

17
00:01:27,140 --> 00:01:31,597
Давайте удалим его,
поскольку она искусственно рассчитывается.

18
00:01:31,597 --> 00:01:35,556
Мы из набора данных h
удалим переменную score,

19
00:01:35,556 --> 00:01:39,176
поэтому мы пишем: select(h, -score).

20
00:01:39,176 --> 00:01:43,291
Удалили переменную,
отвечающую за итоговые результаты,

21
00:01:43,291 --> 00:01:49,140
и оставили только семь исходных
результатов по разным видам спорта.

22
00:01:49,140 --> 00:01:54,468
Соответственно, давайте посмотрим
описательные статистики для

23
00:01:54,468 --> 00:01:59,360
нашего набора данных h.

24
00:01:59,360 --> 00:02:01,612
Как мы и ожидали, мы видим, что, конечно,

25
00:02:01,612 --> 00:02:04,950
средние значения по каждой
переменной существенно отличаются.

26
00:02:04,950 --> 00:02:10,082
По бегу с препятствиями среднее

27
00:02:10,082 --> 00:02:14,948
время — это 13,84,
а средний результат метания копья,

28
00:02:14,948 --> 00:02:19,208
он совершенно в других единицах,
в метрах — и это 41,48.

29
00:02:19,208 --> 00:02:23,286
Как видно, стандартные отклонения
тоже сильно отличаются.

30
00:02:23,286 --> 00:02:28,908
Стандартное отклонение самое маленькое
— 0,08, а самое большое стандартное

31
00:02:28,908 --> 00:02:33,597
отклонение — 8,2,
то есть отличие в сотню раз.

32
00:02:33,597 --> 00:02:37,996
Поэтому применять без стандартизации
переменных метод главных компонент к

33
00:02:37,996 --> 00:02:39,905
нашему набору данных неразумно.

34
00:02:39,905 --> 00:02:42,755
У нас переменные имеют
разные единицы измерения.

35
00:02:42,755 --> 00:02:44,020
У них разный разброс.

36
00:02:44,020 --> 00:02:51,045
Нам метод главных компонент,
если применять его просто в лоб,

37
00:02:51,045 --> 00:02:55,568
даст с большим весом бег на 800 метров,

38
00:02:55,568 --> 00:02:59,340
как самую переменную,
имеющую наибольший разброс.

39
00:02:59,340 --> 00:03:02,895
А нам надо поймать переменные,

40
00:03:02,895 --> 00:03:08,300
которые наиболее информативно
описывают разницу между спортсменами.

41
00:03:08,300 --> 00:03:13,447
Соответственно, мы будем
применять метод главных компонент,

42
00:03:13,447 --> 00:03:17,214
но предварительно
стандартизируем наши переменные.

43
00:03:17,214 --> 00:03:21,600
Еще можно перед методом главных
компонент посмотреть на корреляции.

44
00:03:21,600 --> 00:03:25,273
И здесь как раз мы видим,
что корреляции бывают довольно высокие.

45
00:03:25,273 --> 00:03:29,972
Ну, вот, например, корреляция
между прыжками в длину и бегом с

46
00:03:29,972 --> 00:03:33,550
препятствиями — минус 0,91.

47
00:03:33,550 --> 00:03:35,682
Ну, тут связано, конечно...

48
00:03:35,682 --> 00:03:42,050
Отрицательность корреляции означает то,
что прыжок в длину чем длиннее,

49
00:03:42,050 --> 00:03:47,828
тем лучше, а результат бега с
препятствиями — чем меньше время,

50
00:03:47,828 --> 00:03:51,403
тем лучше, поэтому корреляция разумно,
что она отрицательная.

51
00:03:51,403 --> 00:03:52,532
Это хороший знак.

52
00:03:52,532 --> 00:03:55,620
И, наконец,
применим метод главных компонент.

53
00:03:55,620 --> 00:04:01,070
Для этого мы воспользуемся функцией
prcomp (principal component, сокращение).

54
00:04:01,070 --> 00:04:06,957
Возьмем наш набор данных h и
обязательно укажем опцию scale=TRUE,

55
00:04:06,957 --> 00:04:11,330
то есть нужна стандартизация переменных,
поскольку они в разных единицах измерения.

56
00:04:11,330 --> 00:04:14,149
Всё, компьютер нам оценил
главные компоненты.

57
00:04:14,149 --> 00:04:17,850
Можно их достать, посмотреть,
попытаться визуализировать.

58
00:04:17,850 --> 00:04:20,342
Давайте сначала достанем.

59
00:04:20,342 --> 00:04:27,910
Первая главная компонента: из h.pca
вытащим первый столбик новых иксов.

60
00:04:27,910 --> 00:04:28,988
Новые иксы.

61
00:04:28,988 --> 00:04:30,360
То есть мы...

62
00:04:30,360 --> 00:04:32,910
новые иксы, первый столбик.

63
00:04:32,910 --> 00:04:36,710
И давайте вытащим веса
первой главной компоненты.

64
00:04:36,710 --> 00:04:41,750
Значит, из всех оцененных компонент
вытащим компоненту rotation.

65
00:04:41,750 --> 00:04:43,821
Тоже первый столбик.

66
00:04:43,821 --> 00:04:46,330
Давайте посмотрим на v1.

67
00:04:46,330 --> 00:04:51,020
v1 — это веса,
с которыми старые переменные

68
00:04:51,020 --> 00:04:55,710
результаты отдельных видов спорта входят
в новую синтетическую переменную.

69
00:04:55,710 --> 00:05:00,909
Здесь мы видим, что в первую главную
компоненту бег с препятствиями

70
00:05:00,909 --> 00:05:08,662
входит с весом 0,45 прыжки в высоту
входят с весом минус 0,37 и так далее.

71
00:05:08,662 --> 00:05:12,470
Бег на 800 метров входит с весом 0,37.

72
00:05:12,470 --> 00:05:17,829
Соответственно, можно сказать,
что несколько наиболее

73
00:05:17,829 --> 00:05:25,018
важных переменных в первой главной
компоненте — это бег с препятствиями,

74
00:05:25,018 --> 00:05:29,044
бег на 200 метров, прыжки в длину.

75
00:05:29,044 --> 00:05:30,203
А вот, например,

76
00:05:30,203 --> 00:05:34,850
метание копья входит в первую главную
компоненту с очень маленьким весом.

77
00:05:34,850 --> 00:05:38,513
Ну и можно, в принципе,

78
00:05:38,513 --> 00:05:43,501
посмотреть на первую главную компоненту,
на ее начало.

79
00:05:43,501 --> 00:05:46,283
Поскольку у нас тут
много спортсменов — 25,

80
00:05:46,283 --> 00:05:49,690
но мы все 25 наблюдений смотреть не будем,
но начало посмотрим.

81
00:05:49,690 --> 00:05:54,209
Соответственно, вот это значение новой
искусственной переменной первой главной

82
00:05:54,209 --> 00:05:57,870
компоненты для разных
спортсменов разных стран.

83
00:05:57,870 --> 00:06:05,280
Давайте посмотрим описание
результатов оценивания.

84
00:06:05,280 --> 00:06:10,304
Значит, summary по pca, по главным

85
00:06:10,304 --> 00:06:15,928
компонентам у нас идет следующее:
первая главная компонента

86
00:06:15,928 --> 00:06:20,690
ловит 63 % дисперсии
совокупно-исходного набора данных.

87
00:06:20,690 --> 00:06:25,083
Первая и вторая главная
компоненты в сумме уже ловят 80

88
00:06:25,083 --> 00:06:27,915
% дисперсии исходного набора данных.

89
00:06:27,915 --> 00:06:33,139
Соответственно, видно, что уже
несколько первых главных компонент, ну,

90
00:06:33,139 --> 00:06:40,249
например, первые четыре главных компоненты
ловят 95 % разброса исходных данных.

91
00:06:40,249 --> 00:06:44,715
То есть вместо семи переменных,
оказывается, что тот же самый набор данных

92
00:06:44,715 --> 00:06:49,665
примерно можно описать всего с
помощью четырех главных компонент.

93
00:06:49,665 --> 00:06:55,925
И первые две главных компоненты позволяют
нам визуализировать наши результаты.

94
00:06:55,925 --> 00:07:02,753
Давайте предварительно, во-первых,
увидим, что первая главная компонента,

95
00:07:02,753 --> 00:07:07,202
она связана очень сильно с результатом.

96
00:07:07,202 --> 00:07:12,974
Если посчитать корреляцию между

97
00:07:12,974 --> 00:07:18,145
результатом семиборья, который

98
00:07:18,145 --> 00:07:24,860
рассчитывается по формуле олимпийской
и нашей первой главной компоненты,

99
00:07:24,860 --> 00:07:29,760
то оказывается,
что это практически одно и то же.

100
00:07:29,760 --> 00:07:34,245
Корреляция равна минус 0,99,
хотя, конечно,

101
00:07:34,245 --> 00:07:38,325
олимпийский комитет использует не первую
главную компоненту, а другую формулу,

102
00:07:38,325 --> 00:07:42,489
которая учитывает веса всех видов спорта.

103
00:07:42,489 --> 00:07:46,618
Давайте кое-что визуализируем
в методе главных компонент.

104
00:07:46,618 --> 00:07:51,810
Во-первых, визуализируем долю объясняемой
дисперсии разными компонентами.

105
00:07:51,810 --> 00:07:56,564
Соответственно, какой размер
дисперсии объясняет каждая

106
00:07:56,564 --> 00:08:01,465
главная компонента: первая вторая,
третья и так далее.

107
00:08:01,465 --> 00:08:06,537
И также можно визуализировать
наши наблюдения в осях, где по

108
00:08:06,537 --> 00:08:12,250
оси х будет первая главная компонента, а
по оси у будет вторая главная компонента.

109
00:08:12,250 --> 00:08:17,300
biplot(h.pca И давайте я
сразу поставлю границы

110
00:08:17,300 --> 00:08:22,440
немножко пошире по х от минус 1 до 1,

111
00:08:22,440 --> 00:08:29,560
и посмотрим, что видно на этом графике.

112
00:08:33,785 --> 00:08:38,010
Что видно на этом графике?

113
00:08:38,010 --> 00:08:41,068
На этом графике по горизонтали
отложена первая главная компонента,

114
00:08:41,068 --> 00:08:43,050
по вертикали — вторая главная компонента.

115
00:08:43,050 --> 00:08:48,435
И, соответственно, каждый спортсмен
изображен в координатах не исходных

116
00:08:48,435 --> 00:08:51,630
результатов спорта, а искусственных
первых и вторых главных компонент.

117
00:08:51,630 --> 00:08:53,621
Что бросается в глаза на этом графике?

118
00:08:53,621 --> 00:08:55,974
Во-первых, этот график сразу показывает,

119
00:08:55,974 --> 00:09:00,484
что есть особая спортсменка — вот Launa
из PNG (PNG — это сокращение от Папуа –

120
00:09:00,484 --> 00:09:05,176
Новая Гвинея) вот Launa из Папуа –
Новой Гвинеи она совсем не такая, как все.

121
00:09:05,176 --> 00:09:09,093
У нее результаты существенно отличаются.

122
00:09:09,093 --> 00:09:11,510
Дальше красным...

123
00:09:11,510 --> 00:09:17,068
красные векторы — это,
соответственно, в координатах

124
00:09:17,068 --> 00:09:24,112
первой главной и второй главной компоненты
у нас отмерены исходные переменные.

125
00:09:24,112 --> 00:09:29,706
Соответственно, я вижу,
что вторая главная компонента,

126
00:09:29,706 --> 00:09:33,985
она в себе берет с большим
весом метание копья,

127
00:09:33,985 --> 00:09:40,382
а первая главная компонента,
в нее примерно с равными весами входят и

128
00:09:40,382 --> 00:09:45,780
вот longjump и hurdles примерно направлен
в соответствии первой главной компоненты.

129
00:09:45,780 --> 00:09:50,808
То есть можно сказать, какие переменные
составляют первую главную компоненту.

130
00:09:50,808 --> 00:09:55,737
Кроме того, можно, например,
обнаружить по этому графику, что,

131
00:09:55,737 --> 00:10:01,052
скажем, корреляция между
прыжками в длину (longjump)

132
00:10:01,052 --> 00:10:07,202
и корреляция между временем бега
с барьерами она отрицательная,

133
00:10:07,202 --> 00:10:12,620
потому что в терминах главных компонент
эти вектора направлены в разные стороны.

134
00:10:12,620 --> 00:10:17,671
И если повезет,
если данные хорошо кластеризуются, то,

135
00:10:17,671 --> 00:10:22,230
соответственно, метод главных компонент
позволяет получить несколько кластеров.

136
00:10:22,230 --> 00:10:26,803
У нас в данном случае, правда, кластеров
вышло всего два: все спортсмены и Launa,

137
00:10:26,803 --> 00:10:32,001
но тем не менее иногда это позволяет дать
легкую наглядную интерпретацию сложного

138
00:10:32,001 --> 00:10:38,410
многомерного набора данных.

