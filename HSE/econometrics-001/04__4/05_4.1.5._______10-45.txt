
﻿1
00:00:13,250 --> 00:00:18,940
Посчитаем первую главную компоненту.
Перед нами простой набор
данных с двумя переменными,
a₁ и a₂, и тремя наблюдениями.
2, 4, 0 по переменной a₁ и 5,
1, 3 по переменной a₂.
И наша задача – посчитать
первую главную компоненту,
то есть как выглядит в этом наборе
данных новая искусственная переменная,
так называемая первая главная компонента.
Как всегда в методе главных компонент,
сначала мы центрируем наше наблюдение,
то есть мы от a₁ и a₂ переходим к x₁,
x₁ = a₁- a₁ среднее,
вектор x₂ = a₂- a₂ среднее.
Ну, нетрудно посчитать, что в нашем
примере a₁ среднее равно 2, а a₂ среднее,
среднее арифметическое этих
чисел (5 +1 + 3)/3 = 3.
Соответственно, наши новые переменные,
с которыми удобно находить
главные компоненты,
имеют вид 0, 2,
-2 и 2,
-2 и 0.
И теперь мы переходим непосредственно
к поиску первой главной компоненты.
Я напомню, что первая главная компонента –
это некая комбинация линейная с некоторыми
весами x₁ и x₂,
то есть это число αx₁ + βx₂.
Я обращу внимание, что α и β – это числа,
α и β – это числа, а, соответственно, x₁,
x₂ и pc₁ – это вектора.
И мы хотим подобрать такие веса,
которые, с одной стороны,
невелики в том смысле,
что α² + β² = 1,
а с другой стороны, мы хотим подобрать
такую пропорцию между x₁ и x₂,
чтобы первая главная компонента
имела наибольший разброс.
Ну, в данном случае наибольший разброс,
мы имеем в виду,
что выборочная дисперсия первой главной
компоненты должна быть максимальна,
и мы это будем максимизировать по α₁ и α₂.
Поскольку x₁ и x₂ имеют нулевое среднее,
мы специально отцентрировали переменные,
чтобы получилось нулевое среднее, то
поэтому максимизация выборочной дисперсии,
она равносильна максимизации
просто длины вектора pc₁.
То есть можно просто максимизировать
длину вектора pc₁ или квадрат длины,
чтобы не извлекать корень, можно просто
максимизировать квадрат длины вектора
pc₁ по α и β, то есть максимизировать
сумму квадратов его компонентов.
Ну, посчитаем эту первую
главную компоненту.
Значит, первая главная компонента.
Для первого наблюдения это αx₁ + βx₂,
то есть это β*2.
Для второго наблюдения это α*2- β*2,
и для третьего наблюдения
это -2α, α*(-2).
Соответственно, квадрат длины первой
главной компоненты – это есть
(2β)² + (2α-
2β)² + (-2α)²
Раскрываем скобки и
приводим подобные слагаемые.
4β² + 4α² - 8αβ
+ 4β² + 4α²
= 8α² +
8β² - 8αβ.
Можно немножко эту функцию упростить.
Из-за того,
что у нас α² + β² = 1,
то вот это выражение 8α² +
8β² у нас обязано равняться 8.
Получаем 8- 8αβ.
И чтобы найти максимум этой
функции при данном ограничении,
можно, конечно, воспользоваться методом
Лагранжа, но мы поступим чуть-чуть проще.
С помощью небольшого изящного
трюка мы поделим на 1.
Ну, можно любое выражение поделить
на 1 совершенно бесплатно.
(8- 8αβ)/(α² + β²)
А теперь числитель и знаменатель
этого выражения поделим на α².
Получим 8- 8β/α
8- 8β/α, а здесь 1
+ β²/α².
И здесь я вижу,
что хотя α и β у меня связаны,
α² + β² должно равняться 1,
однако пропорция α к β,
отношение α к β может быть любым.
И, таким образом, я свел задачу с
ограничением к задаче без ограничения.
Только надо сделать замену, сказать, что
β/α равняется какой-то новой переменой t,
и наше выражение равняется
(8- 8t)/(1+t²).
И я хочу это выражение промаксимизировать,
подобрав наилучшую пропорцию между α и β.
Ну, давайте это выражение
обзовем какой-нибудь функцией,
это будет функция Q(t), да,
это будет функция Q(t).
Берем ее производную, Q'(t)
= -(1 + t²) в квадрате,
а здесь будет производная
числителя 8 на знаменатель
минус производная знаменателя
2t помножить на числитель 8t.
Приравниваем производную к 0, получаем,
что в числителе получаем
8- 8t² = 0.
Отсюда получаем 2 подозрительных
на экстремум точки: +1 и t = -1.
Ну, давайте посмотрим на нашу функцию.
Наша функция (8- 8t)/(1+t²).
Если я подставлю сюда 1,
то дробь будет вычитаться.
Если я подставлю сюда -1,
то дробь будет прибавляться,
потому что тут минус на минус даст плюс.
Соответственно, точкой максимума,
а я ищу именно максимум,
точкой максимума является t = -1.
Соответственно, мы обнаружили,
что для того, чтобы максимизировать
разброс первой главной компоненты,
нам нужно взять отношение β/α = -1.
Ну, и, конечно,
α-квадрат + β-квадрат обязано равняться 1.
β, стало быть, = -α, подставляем сюда,
получаем α-квадрат + (-α) в квадрате = 1,
2α-квадрат = 1, α-квадрат = 1/2.
И здесь получается 2 решения.
Одно решение: α = 1/√2,
тогда ему соответствует β = -1/√2.
И второе решение: α = -1/√2,
а β = 1/√2.
При этом разброс у первой главной
компоненты будет совершенно одинаковый,
поскольку он определяется только
величиной t, а t в обоих случаях = -1.
Какое из этих двух решений выбрать,
абсолютно неважно.
И то, и то можно назвать
первой главной компонентой.
Давайте просто для определенности
выберем первое решение,
но не ошибкой будет
выбрать и второе решение.
Соответственно, мы получаем,
что наша первая главная компонента
в нашем примере pc₁ = (1/√2)x₁- (1/√2)x₂.
Ну, и поскольку мы
знаем вектора x₁ и x₂, то мы получаем,
что первая главная компонента
равна следующему вектору.
Давайте запишем ее лучше в столбик в
табличку первая главная компонента,
чтобы подчеркнуть, что у нее 3 наблюдения.
0- 2/√2 = -√2;
2/√2 = √2 + √2
= 2√2; и здесь
будет -√2 -√2.
Соответственно, вот она
искусственная новая,
искусственная новая переменная,
которая, с одной стороны,
линейно выражается через центрированные
исходные переменные, а с другой стороны,
имеет максимальную дисперсию,
максимальный разброс, и,
соответственно, ее можно использовать
для дальнейшего анализа.
На этом простом примере мы поняли,
как считать главные компоненты.
Давайте теперь узнаем,
какими свойствами они обладают и зачем
они могут пригодиться.

