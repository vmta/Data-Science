1
00:00:13,270 --> 00:00:18,740
Применив метод наименьших квадратов
к двум простым моделям, мы

2
00:00:18,740 --> 00:00:23,940
получили следующие результаты: в модели,
где нет фактически объясняющих переменных,

3
00:00:23,940 --> 00:00:31,643
где y_i = β + ε_i в такой модели мы
получили оценку метода наименьших

4
00:00:31,643 --> 00:00:37,409
квадратов — β с крышкой равно просто y
среднему, среднему арифметическому всех y.

5
00:00:37,409 --> 00:00:44,840
В линейной модели, где y_i = β₁ + β₂x_i +
ε_i мы получили более сложные формулы.

6
00:00:44,840 --> 00:00:48,770
Формулу для β₂ с крышкой,
она немножко громоздкая,

7
00:00:48,770 --> 00:00:54,623
ее трудно напрямую проинтерпретировать,
что это отношение ∑(x_i-

8
00:00:54,623 --> 00:00:56,721
x среднее) * (y_i-

9
00:00:56,721 --> 00:01:00,440
y среднее) деленное на ∑(x_i-

10
00:01:00,440 --> 00:01:03,420
x среднее) в квадрате.

11
00:01:03,420 --> 00:01:08,286
И в этой же модели β₁
с крышкой = y среднее-

12
00:01:08,286 --> 00:01:11,320
β₂ с крышкой * x среднее.

13
00:01:11,320 --> 00:01:17,065
То есть второе уравнение означает,
что линия регрессии y с крышкой

14
00:01:17,065 --> 00:01:23,510
= β₁ с крышкой + β₂ с крышкой * х проходит
через точку (х среднее, у среднее).

15
00:01:23,510 --> 00:01:29,234
Еще раз подведем итог всей
используемой терминологии:

16
00:01:29,234 --> 00:01:32,930
y_i — зависимая или объясняемая
переменная (синонимы).

17
00:01:32,930 --> 00:01:35,990
x_i — регрессор или объясняющая переменная.

18
00:01:35,990 --> 00:01:38,540
ε_i — просто ошибка или ошибка модели,

19
00:01:38,540 --> 00:01:41,846
или случайная составляющая,
или случайная ошибка.

20
00:01:41,846 --> 00:01:46,821
То есть та величина, которая для нас
непредсказуема, мы ее не моделируем.

21
00:01:46,821 --> 00:01:51,012
y_i с крышкой — прогноз
или прогнозное значение.

22
00:01:51,012 --> 00:01:53,840
ε_i с крышкой — остаток, ошибка прогноза.

23
00:01:53,840 --> 00:01:58,550
И RSS (residual sum of squares)
— сумма квадратов остатков,

24
00:01:58,550 --> 00:02:03,170
сумма квадратов ошибок прогнозов,
∑ε_i с крышкой в квадрате.

25
00:02:03,170 --> 00:02:07,805
Нарисуем на графике,
покажем наше стандартное обозначение.

26
00:02:07,805 --> 00:02:16,790
Итак, у нас есть набор данных: (x_i,
y_i, x_1, y_1, x_2, y_2) и так далее.

27
00:02:16,790 --> 00:02:23,100
Этому множеству наблюдений соответствует
облако точек на плоскости.

28
00:02:23,100 --> 00:02:28,845
Ось х, ось у и некоторое облако точек.

29
00:02:28,845 --> 00:02:35,330
Заметим, что есть некий
геометрический центр этого облака,

30
00:02:35,330 --> 00:02:39,197
этот геометрический центр не обязан
совпадать ни с одной из точек, ну может,

31
00:02:39,197 --> 00:02:40,790
конечно, случайно так выйти.

32
00:02:40,790 --> 00:02:42,772
Ну в принципе, не обязан.

33
00:02:42,772 --> 00:02:47,630
То есть это некая точка в центре облака
с формальной математической точки

34
00:02:47,630 --> 00:02:54,770
зрения определяется как х среднее
арифметическое и у среднее арифметическое.

35
00:02:54,770 --> 00:02:59,966
И когда мы оцениваем модель y_i =

36
00:02:59,966 --> 00:03:04,438
β₁ + β₂*x_i + ε_i мы получаем по

37
00:03:04,438 --> 00:03:10,070
методу МНК — методу наименьших квадратов
оценки β₁ с крышкой и β₂ с крышкой.

38
00:03:10,070 --> 00:03:14,117
Есть некая достаточно большая
формула для β₂ с крышкой,

39
00:03:14,117 --> 00:03:17,430
выражаемая через отклонение ∑(x_i-

40
00:03:17,430 --> 00:03:20,220
x среднее) * (y_i-

41
00:03:20,220 --> 00:03:23,862
y среднее) делить на ∑(x_i-

42
00:03:23,862 --> 00:03:26,615
x среднее) в квадрате.

43
00:03:26,615 --> 00:03:29,087
И β₁ с крышкой = y среднее-

44
00:03:29,087 --> 00:03:31,460
β₂ с крышкой * х среднее.

45
00:03:31,460 --> 00:03:39,585
Ну еще второе уравнение можно трактовать

46
00:03:39,585 --> 00:03:48,710
как β₁ с крышкой + β₂ с крышкой
* х среднее равняется у среднее.

47
00:03:48,710 --> 00:03:55,000
То есть мы проводим некоторую прямую,
которая заменяет это облако точек.

48
00:03:55,000 --> 00:04:00,090
Вот какая-то такая

49
00:04:00,090 --> 00:04:05,180
прямая.

50
00:04:05,180 --> 00:04:11,256
Заметим, что эта прямая y с крышкой
= β₁ с крышкой + β₂ с крышкой * х,

51
00:04:11,256 --> 00:04:18,350
эта прямая обязана проходить через
геометрический центр облака точек,

52
00:04:18,350 --> 00:04:25,030
потому что y среднее = β₁ с крышкой
+ β₂ с крышкой * х среднее.

53
00:04:25,030 --> 00:04:30,622
Кроме того на этой прямой можно
изобразить значение β₁ с крышкой.

54
00:04:30,622 --> 00:04:34,832
Вот эта величина — это β₁ с крышкой,
потому что при х = 0,

55
00:04:34,832 --> 00:04:38,100
у с крышкой = β₁ с крышкой.

56
00:04:38,100 --> 00:04:45,125
И именно поэтому,
из-за того что β₁ с крышкой

57
00:04:45,125 --> 00:04:50,440
— это пересечение нашей прямой
регрессии с вертикальной осью,

58
00:04:50,440 --> 00:04:54,570
то поэтому по английски β₁ с крышкой
называется intercept (пересечение).

59
00:04:54,570 --> 00:04:58,820
Дальше, рассмотрим какое-нибудь
типичное наблюдение,

60
00:04:58,820 --> 00:05:03,940
вот это пусть это будет
первое наблюдение (х_1,у_1).

61
00:05:03,940 --> 00:05:12,890
Соответственно для заданного х
мы прогнозируем вот такой вот у.

62
00:05:12,890 --> 00:05:16,220
Эта высота — это настоящий у_1,

63
00:05:16,220 --> 00:05:22,338
то есть вот если так мы обозначим:
это будет у_1, а это будет х_1.

64
00:05:22,338 --> 00:05:27,928
А вот эта величина — это, соответственно,

65
00:05:27,928 --> 00:05:35,040
будет у_1 с крышечкой — прогноз,
который соответствует первому наблюдению.

66
00:05:35,040 --> 00:05:40,077
А ошибка — разница между
первым у и первым у с

67
00:05:40,077 --> 00:05:44,700
крышечкой — это будет ошибка
прогноза ε_1 с крышечкой.

68
00:05:44,700 --> 00:05:51,454
Соответственно, метод наименьших
квадратов, он подбирает прямую так,

69
00:05:51,454 --> 00:05:55,580
чтобы ошибки вот они, я нарисую ошибки —

70
00:05:55,580 --> 00:06:00,575
это расстояние от каждой точки до прямой,
измеренное по вертикали.

71
00:06:00,575 --> 00:06:04,700
Соответственно, метод наименьших
квадратов подбирает прямую так,

72
00:06:04,700 --> 00:06:11,321
чтобы сумма квадратов
ошибок была минимальна.

73
00:06:11,321 --> 00:06:16,625
Теперь перейдем к случаю большого
количества объясняющих переменных.

74
00:06:16,625 --> 00:06:20,260
К счастью, случай двадцати объясняющих
переменных концептуально ничем не

75
00:06:20,260 --> 00:06:23,510
отличается от случая всего лишь
двух объясняющих переменных x и z,

76
00:06:23,510 --> 00:06:28,351
поэтому соответствующие
выкладки мы будем делать для

77
00:06:28,351 --> 00:06:33,318
модели y_i = β₁ + β₂x_i + β₃z_i + ε_i.

78
00:06:33,318 --> 00:06:37,070
И наша задача выписать систему уравнений,

79
00:06:37,070 --> 00:06:42,060
из которой будут находиться β₁ с крышкой,β₂ с крышкой и β₃ с крышкой.

80
00:06:42,060 --> 00:06:45,904
Что произойдет в случае большого
количества объясняющих переменных?

81
00:06:45,904 --> 00:06:51,059
Мы рассмотрим на примере двух, потому
что даже уже с двумя готовые формулы для

82
00:06:51,059 --> 00:06:55,030
β с крышкой в явном виде будут
иметь слишком громоздкий вид.

83
00:06:55,030 --> 00:07:01,080
Итак, у нас имеется модель
y_i = β₁ + β₂x_i + β₃z_i + ε_i.

84
00:07:01,080 --> 00:07:06,750
Поскольку ε_i — непрогнозируемая часть,

85
00:07:06,750 --> 00:07:13,850
то формулы для прогнозов будут иметь

86
00:07:13,850 --> 00:07:19,535
вид y_i с крышкой = β₁ с крышкой + β₂
с крышкой * x_i + β₃ с крышкой * z_i.

87
00:07:19,535 --> 00:07:24,737
Ошибка прогноза ε_i с крышкой,
соответственно, равняется y_i-

88
00:07:24,737 --> 00:07:25,906
y_i с крышкой.

89
00:07:25,906 --> 00:07:33,720
И метод наименьших квадратов минимизирует
сумму ε_i с крышкой в квадрате.

90
00:07:33,720 --> 00:07:40,690
Эта величина — это функция от β₁ с
крышкой, β₂ с крышкой и β₃ с крышкой.

91
00:07:40,690 --> 00:07:44,807
Мы хотим приравнять производную
по каждой переменной к нулю и

92
00:07:44,807 --> 00:07:48,300
посмотреть какие условия
первого порядка выйдут.

93
00:07:48,300 --> 00:07:54,500
Соответственно, давайте заметим,
что вот у_i они от β с крышкой не зависят.

94
00:07:54,500 --> 00:08:00,420
От β с крышкой зависят только прогнозы,
поэтому если я возьму производную

95
00:08:00,420 --> 00:08:06,881
от ε_i с крышкой по dβ₁ с крышкой,
то от у_i там нет β₁ с крышкой,

96
00:08:06,881 --> 00:08:12,189
там только настоящий β₁ есть,
который мы не знаем и никогда не узнаем.

97
00:08:12,189 --> 00:08:15,777
А производная от у с крышкой
по β с крышкой — это единичка.

98
00:08:15,777 --> 00:08:18,460
Соответственно, это будет минус единичка.

99
00:08:18,460 --> 00:08:22,935
Производная ε_i с крышкой по dβ₂ по

100
00:08:22,935 --> 00:08:27,680
аналогичным соображениям
— это будет минус x_i.

101
00:08:27,680 --> 00:08:35,430
И производная ε_i с крышкой по β₃
с крышкой — это будет минус z_i.

102
00:08:35,430 --> 00:08:38,938
Ну теперь мы можем выписать
условие первого порядка.

103
00:08:38,938 --> 00:08:45,874
Условие первого порядка будет
производная Q по β₁ с крышкой =

104
00:08:45,874 --> 00:08:53,000
0 Производная Q по β₂ с крышкой = 0.

105
00:08:53,000 --> 00:08:55,454
Производная Q по β₃ с крышкой = 0.

106
00:08:55,454 --> 00:08:57,434
Берем производное от суммы.

107
00:08:57,434 --> 00:08:59,980
Соответственно, получаем первую.

108
00:08:59,980 --> 00:09:04,018
Сумма, производное от квадрата —

109
00:09:04,018 --> 00:09:09,425
это 2 умножить на ε_i с крышкой
на производное от ε с крышкой.

110
00:09:09,425 --> 00:09:12,640
А производное от ε с крышкой это минус 1.

111
00:09:12,640 --> 00:09:14,714
Равняется нулю.

112
00:09:14,714 --> 00:09:21,170
Берем производную это условие dQ
по dβ₁ с крышкой равняется нулю.

113
00:09:21,170 --> 00:09:26,775
Аналогично берем производную
от этой суммы по β₂ с крышкой

114
00:09:26,775 --> 00:09:32,878
получаем сумму 2 * ε_i с крышкой
на производную ε с крышкой по β₂.

115
00:09:32,878 --> 00:09:36,020
Получаем минус x_i = 0.

116
00:09:36,020 --> 00:09:44,075
И аналогично взяв производную от суммы
ε_i с крышкой по β₃ с крышкой мы получим

117
00:09:44,075 --> 00:09:51,110
сумму 2 * ε_i с крышкой на
минус z_i равняется нулю.

118
00:09:59,110 --> 00:10:05,680
Мы получили три условия первого порядка

119
00:10:05,680 --> 00:10:11,352
и из этой системы из трех уравнений мы
можем найти три неизвестных: β₁ с крышкой,

120
00:10:11,352 --> 00:10:13,262
β₂ с крышкой и β₃ с крышкой.

121
00:10:13,262 --> 00:10:15,723
Можно немножко упростить эту систему,

122
00:10:15,723 --> 00:10:19,822
поделить на минус 2 и получится
вот такая вот симпатичная система,

123
00:10:19,822 --> 00:10:22,840
из которой находятся неизвестные
оценки коэффициентов.

124
00:10:22,840 --> 00:10:26,323
Сумма ε_i с крышкой на
единичку равняется нулю.

125
00:10:26,323 --> 00:10:30,770
Опять же единичку можно не писать,
но для ясности я напишу.

126
00:10:30,770 --> 00:10:35,985
Сумма ε_i с крышкой на x_i равняется нулю.

127
00:10:35,985 --> 00:10:41,200
И сумма ε_i с крышкой на z_i равняется нулю.

128
00:10:41,200 --> 00:10:44,896
Оказывается у этих условий есть
очень интересная интерпретация,

129
00:10:44,896 --> 00:10:46,980
о которой мы поговорим прямо сейчас.

130
00:10:46,980 --> 00:10:51,545
Итак, решая эту систему мы
получили следующий вывод: что

131
00:10:51,545 --> 00:10:55,046
неизвестные оценки β₁ с крышкой,
β₂ с крышкой,

132
00:10:55,046 --> 00:11:01,440
β₃ с крышкой — три неизвестных числа
находятся из системы трех уравнений.

133
00:11:01,440 --> 00:11:04,097
Сумма ε_i с крышкой равно нулю.

134
00:11:04,097 --> 00:11:08,400
Сумма произведений ε_i с
крышкой на x_i равно нулю.

135
00:11:08,400 --> 00:11:12,540
И сумма ε_i с крышкой на z_i равно нулю.

