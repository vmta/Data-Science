1
00:00:13,245 --> 00:00:19,199
Для двух простых моделей
 на небольшом наборе

2
00:00:19,199 --> 00:00:24,652
данных получим оценки
методом наименьших квадратов.

3
00:00:24,652 --> 00:00:30,480
Простой набор данных,
есть три человека: Вася, Коля и Петя.

4
00:00:30,480 --> 00:00:35,515
И есть данные по их весу в

5
00:00:35,515 --> 00:00:41,270
килограммах и росту в сантиметрах.

6
00:00:41,270 --> 00:00:45,100
И мы предполагаем,
что вес будет зависеть как-то от роста,

7
00:00:45,100 --> 00:00:48,350
попытаемся восстановить
 уравнение зависимости.

8
00:00:48,350 --> 00:00:55,714
Вес 60, 70 у Коли,
80 у Пети и рост 170, 170 и 181.

9
00:00:55,714 --> 00:01:00,045
Модель 1, которую мы оценим методом

10
00:01:00,045 --> 00:01:04,920
наименьших квадратов, это y_i = β + ε_i,

11
00:01:04,920 --> 00:01:10,326
и модель 2, которую мы оценим y_i =

12
00:01:10,326 --> 00:01:15,832
β₁ + β₂ x_i + ε_i Нам нужно получить

13
00:01:15,832 --> 00:01:20,844
β с крышкой с помощью метода
 наименьших квадратов,

14
00:01:20,844 --> 00:01:27,080
β₁ с крышкой и β₂ с крышкой с
помощью метода наименьших квадратов.

15
00:01:27,080 --> 00:01:29,579
Давайте немножко про смысл модели.

16
00:01:29,579 --> 00:01:35,452
Первая модель предполагает,
что вес не зависит от роста,

17
00:01:35,452 --> 00:01:40,308
то есть вес каждого человека - это 
просто какая-то мировая константа

18
00:01:40,308 --> 00:01:44,600
среднего веса плюс случайная составляющая, 
своя для каждого человека.

19
00:01:44,600 --> 00:01:49,720
Вторая модель предполагает,
что вес зависит от роста линейно,

20
00:01:49,720 --> 00:01:54,793
β₁ + β₂x — это линейная зависимость,
плюс случайная

21
00:01:54,793 --> 00:02:00,140
составляющая ε_i,
и нам нужно оценить эти две модели.

22
00:02:00,140 --> 00:02:01,490
Поехали.

23
00:02:01,490 --> 00:02:06,330
Значит, что делает метод
 наименьших квадратов?

24
00:02:06,330 --> 00:02:12,830
Он минимизирует величину RSS,
то есть мы минимизируем

25
00:02:12,830 --> 00:02:17,661
сумму (y_i-

26
00:02:17,661 --> 00:02:22,310
y_i с крышкой), и все это в квадрате,

27
00:02:22,310 --> 00:02:26,520
подбирая коэффициенты β с крышкой.

28
00:02:26,520 --> 00:02:28,973
Ну, давайте попробуем.

29
00:02:28,973 --> 00:02:33,162
Для модели 1 y_i с крышкой, соответственно,

30
00:02:33,162 --> 00:02:39,458
вместо настоящего коэффициента мы
пишем его оценку, а случайная ошибка,

31
00:02:39,458 --> 00:02:44,570
она непрогнозируема,
мы пишем вместо нее 0.

32
00:02:44,570 --> 00:02:48,881
Если, соответственно, в модели 1 рост 
каждого человека прогнозируется вот этой

33
00:02:48,881 --> 00:02:54,607
самой оцененной мировой константой,
то мы получаем,

34
00:02:54,607 --> 00:02:58,631
что в модели 1 сумма ошибок прогнозов,

35
00:02:58,631 --> 00:03:03,787
квадратов ошибок прогнозов,
по i от единички до 3,

36
00:03:03,787 --> 00:03:08,680
у нас 3 наблюдения,
 равняется сумма по i от

37
00:03:08,680 --> 00:03:13,901
единички до 3 y_i минус,
поскольку прогноз для

38
00:03:13,901 --> 00:03:19,048
каждого наблюдения – это β с крышкой,
то мы получаем такую простую формулу.

39
00:03:19,048 --> 00:03:23,573
Ну, чтобы вы понимали, что здесь,
это просто обычная сумма,

40
00:03:23,573 --> 00:03:25,836
тут нет никаких секретов: (y_1-

41
00:03:25,836 --> 00:03:28,023
β с крышкой) в квадрате + (y_2-

42
00:03:28,023 --> 00:03:33,180
β с крышкой) в квадрате,
+ (y_3 минус β с крышкой) в квадрате.

43
00:03:33,180 --> 00:03:38,670
Давайте назовем эту 
функцию Q от β с крышкой,

44
00:03:38,670 --> 00:03:42,574
и мы берем производную,
чтобы найти максимум.

45
00:03:42,574 --> 00:03:46,490
Хотя нет,
давайте для начала раскроем скобки,

46
00:03:46,490 --> 00:03:51,920
чтобы было совсем просто и понятно,
что это за функция.

47
00:03:51,920 --> 00:03:56,480
Это есть сумма, и раскрываем здесь скобки,

48
00:03:56,480 --> 00:04:00,104
по i от 1 до 3, (y_i квадрат-

49
00:04:00,104 --> 00:04:05,670
2β с крышкой)y_i + β с крышкой в квадрате

50
00:04:05,670 --> 00:04:12,207
или сумма по i от 1 до 3 y_i квадрат -

51
00:04:12,207 --> 00:04:19,494
сумма по i от 1 до 3 2β с крышкой

52
00:04:19,494 --> 00:04:25,800
Yi + сумма по i от 1 до 3
β с крышкой в квадрате.

53
00:04:25,800 --> 00:04:30,595
Давайте заметим, что последняя сумма,

54
00:04:30,595 --> 00:04:34,690
— здесь складываются слагаемые,
которые не зависят от i,

55
00:04:34,690 --> 00:04:40,535
то есть что-то из себя представляет сумма 
по i от 1 до 3 β с крышкой в квадрате.

56
00:04:40,535 --> 00:04:45,130
Соответственно, β с крышкой в
квадрате + β с крышкой в квадрате

57
00:04:45,130 --> 00:04:48,442
+ β с крышкой в квадрате.

58
00:04:48,442 --> 00:04:51,310
И, соответственно,

59
00:04:51,310 --> 00:04:56,550
это 3 * β с крышкой в квадрате.

60
00:04:56,550 --> 00:04:59,888
В общем случае,
если у меня было бы не три наблюдения,

61
00:04:59,888 --> 00:05:04,550
а N наблюдений, в общем случае здесь бы
 я получил N на β с крышкой в квадрате.

62
00:05:04,550 --> 00:05:08,134
Второе слагаемое,

63
00:05:08,134 --> 00:05:14,665
сумма 2β с крышкой y_i по i от 1 до 3.

64
00:05:14,665 --> 00:05:18,789
Здесь я вижу,
что 2β с крышкой — это величина,

65
00:05:18,789 --> 00:05:21,075
которая не зависит от слагаемого.

66
00:05:21,075 --> 00:05:25,330
При i = 1, 2β с крышкой,
при i, = 2 и так далее,

67
00:05:25,330 --> 00:05:29,550
а раз это константа, то ее можно вынести
 за знак суммы как общий множитель.

68
00:05:29,550 --> 00:05:35,470
Получится 2β с крышкой умножить
 на сумму у_i по i от 1 до 3.

69
00:05:35,470 --> 00:05:44,110
И, соответственно, мое выражение Q от β с
крышкой равняется сумма y_i в квадрате -

70
00:05:44,110 --> 00:05:50,353
2β с крышкой на сумму

71
00:05:50,353 --> 00:05:55,500
y_i плюс N, ну, N в моем примере равно 3,

72
00:05:55,500 --> 00:05:59,726
но я заодно выведу общую формулу,
β с крышкой в квадрате.

73
00:05:59,726 --> 00:06:06,635
Это универсальная формула для модели 
типа 1 при любом количестве наблюдений.

74
00:06:06,635 --> 00:06:12,459
Берем производную,
получаем Q штрих от β с крышкой = -2

75
00:06:12,459 --> 00:06:17,621
сумма y_i + 2β с крышкой.

76
00:06:17,621 --> 00:06:22,407
Заметим, что наша функция является

77
00:06:22,407 --> 00:06:28,370
относительно β с крышкой
 параболой с ветвями,

78
00:06:28,370 --> 00:06:31,690
направленными вверх,

79
00:06:31,690 --> 00:06:35,379
потому что коэффициент при β с крышкой
 в квадрате, N, количество наблюдений,

80
00:06:35,379 --> 00:06:39,650
положительный, то есть наша зависимость 
имеет какой-то вот такой вид.

81
00:06:39,650 --> 00:06:41,737
Вот это Q от β с крышкой.

82
00:06:41,737 --> 00:06:43,931
Ну и, соответственно,

83
00:06:43,931 --> 00:06:49,202
минимум у параболы единственный, и та
 подозрительная точка, которую мы найдем,

84
00:06:49,202 --> 00:06:52,640
приравняв производную к нулю, она,
естественно, будет точкой минимума.

85
00:06:52,640 --> 00:06:56,530
Вот это, соответственно,
β с крышкой методом наименьших квадратов.

86
00:06:56,530 --> 00:07:00,074
Приравниваем к 0,

87
00:07:00,074 --> 00:07:05,760
получаем… Я пропустил N здесь.

88
00:07:05,760 --> 00:07:10,485
Здесь N на β с крышкой в квадрате,
2β с крышкой на N.

89
00:07:10,485 --> 00:07:15,893
Выражаем отсюда β с крышкой, получаем,
что β с крышкой равняется сумма y_i,

90
00:07:15,893 --> 00:07:20,262
деленная на N, или просто,
если сложить все Y и поделить на N,

91
00:07:20,262 --> 00:07:24,340
мы эту величину обозначаем Y с черточкой,
это Y среднее.

92
00:07:24,340 --> 00:07:29,743
Соответственно, в модели 1 мы получили 
общую формулу, как выглядит β с крышкой,

93
00:07:29,743 --> 00:07:33,651
и конкретно в этом случае мы 
получаем такой естественный,

94
00:07:33,651 --> 00:07:38,746
интуитивно понятный результат,
что если у меня есть три числа,

95
00:07:38,746 --> 00:07:43,510
несколько чисел — 60, 70,
80 и так далее, и я предполагаю,

96
00:07:43,510 --> 00:07:48,860
что каждое из этих чисел это некая единая 
мировая константа плюс случайная ошибка,

97
00:07:48,860 --> 00:07:51,858
то метод наименьших квадратов говорит,
 ну, возьмите в

98
00:07:51,858 --> 00:07:56,490
качестве оценки этой неизвестной, общей 
константы просто среднее арифметическое.

99
00:07:56,490 --> 00:08:01,400
То есть в данной модели мы получаем,
что β с крышкой для модели 1,

100
00:08:01,400 --> 00:08:06,588
β с крышкой метода наименьших квадратов равняется (60

101
00:08:06,588 --> 00:08:11,840
+ 70 + 80), деленное на 3, равняется 70.

