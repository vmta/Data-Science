
﻿1
00:00:12,725 --> 00:00:20,200
Теперь рассмотрим ту же самую ситуацию,
когда у нас много регрессоров.
Я напомню, что мы с вами вывели
условие первого порядка,
что сумма ε_i с крышкой
на единичке равна нулю,
сумма ε_i с крышкой на х_i равна нулю и
сумма ε_i с крышкой на z_i тоже равна нулю.
И геометрически это означает,
что вектор ε с крышкой
перпендикулярен вектору из единичек,
ε с крышкой перпендикулярен вектору Х и
ε с крышкой перпендикулярен вектору Z.
Соответственно, мы можем проиллюстрировать
метод наименьших квадратов для
случая множества объясняющих переменных.
Заодно на этом рисунке мы увидим,
где находится TSS, RSS и ESS.
Сейчас мы проиллюстрируем в многомерном
пространстве случай множественной
регрессии, то есть проиллюстрируем
оценку модели y_i = β₁ + β₂x_i
+ β₃z_i + ε_i с помощью метода
наименьших квадратов.
Я напомню, что мы выяснили, условие
первого порядка для оценки неизвестных
коэффициентов β₁, β₂ и β₃ имеет
следующий вид: ε с крышкой должно быть
перпендикулярно вектору из единичек,
ε с крышкой должно быть перпендикулярно
вектору x и ε с крышкой должно
быть перпендикулярно вектору z.
Это первый факт, который легко
иллюстрировать геометрически.
Второй факт.
Да, из этой системы уравнений
мы находим β₁ с крышкой,
— оценки неизвестных β₁, β₂ и β₃.
Кроме того, мы знаем,
что ε_i с крышкой — это
ошибка прогноза y_i минус y_i с крышкой,
отсюда получается,
что y_i равняется y_i с
крышкой плюс ε_i с крышкой или
в векторной форме вектор y равен
вектор y с крышкой плюс ε с крышкой.
И этот факт, конечно, тоже прекрасно
иллюстрируется геометрически.
Это означает, что можно пройти вектор y,
а можно пройти вектор y с крышкой,
а потом пройти вектор ε с крышкой,
и мы придем в одну и ту же точку.
Теперь мы можем спокойно иллюстрировать.
Кроме того, пожалуй,
стоит еще отметить, что y с
крышкой равен β₁ с крышкой на вектор
из единичек плюс β₂ с крышкой на вектор
Х плюс β₃ с крышкой на вектор z.
То есть вектор y с крышкой можно выразить,
взяв,
сложив с какими-то весами: вектор из
одних единичек, вектор x и вектор z.
Теперь рисуем.
Вот это у нас вектор из одних единичек,
это продолжение: он
задает некоторую прямую.
Будет у нас начало координат.
Я напомню, что пространство у нас
n-мерное, n — это количество наблюдений,
поэтому… и n, как правило, велико,
например, 100 наблюдений, поэтому,
например, в этом пространстве мы можем
нарисовать 20 векторов, перпендикулярных
друг другу, и при этом все попарно
будут перпендикулярны друг другу.
Это — вектор x, это — вектор z.
Это будет вектор y.
Во-первых, я все множество векторов,
которые можно получить,
складывая с каким-то весом вектор x,
вектор z и вектор из единичек,
обозначил вот таким вот облачком.
То есть облачко — это все те вектора,
которые можно получить,
складывая с некоторыми весами вектор x,
вектор z и вектор из единичек.
Итак, как я геометрически интерпретирую
условие первого порядка и факт,
что ε с крышкой — это разница
между y и y с крышкой.
Во-первых, y с крышкой можно
выразить через вектор из единичек,
через вектор x и через вектор z.
Вот она, формула выражающая.
Значит, он лежит в этом облачке, в этой,
говоря умными словами, гиперплоскости.
Значит, вектор y с крышкой,
давайте он будет другого цвета.
Это вектор y с крышкой.
Заметим, что вектор ε с крышкой
в сумме с вектором y с
крышкой дает вектор Y.
Кроме того, поскольку плоскость,
эта гиперплоскость, это облачко образовано
вектором из единичек, вектором x и
вектором z, а всем им вектор ε с крышкой
перпендикулярен, значит ε с крышкой
перпендикулярен всей гиперплоскости,
всему облачку, и, соответственно,
вот здесь вот мы получаем прямой угол.
Таким образом, мы получили следующую
интерпретацию метода наименьших квадратов.
y с крышкой, прогнозы, которые мы
получаем по методу наименьших квадратов,
это проекция, проекция исходного
вектора зависимых
переменных y на множество,
на множество векторов,
получаемых с помощью,
получаемых с помощью сложения с разными
весами: вектора из единичек,
вектора x и вектора z.
Это первый геометрический факт.
Заметим другие геометрические факты.
Во-первых, отметим,
что из условия первого порядка,
что ε с крышкой перпендикулярен
вектору из единичек,
у нас получается,
что сумма ε_i с крышкой равняется нулю,
или то, что сумма y_i минус
y_i с крышкой равняется нулю,
или, что сумма y_i равняется
сумме y_i с крышкой,
или y среднее равняется
y с крышкой среднее.
То есть среднее значение фактических
зависимых переменных равно
среднему значению прогнозов.
Но мы знаем,
что среднее значение можно получить,
спроецировав любой вектор на прямую,
порождаемую вектором из одних единичек.
Соответственно, вот этот факт
геометрически означает следующее.
Если я спроецирую вектор y на прямую,
порождаемую вектором из единичек,
и спроецирую y с крышкой
на ту же самую прямую,
то эти проекции попадут
в одну и ту же точку.
Ну, еще в школе этот факт в одиннадцатом
классе назывался теоремой о
трех перпендикулярах.
Вот здесь он чудесным образом проявляется.
Здесь я получу вектор y с крышкой
помножить на вектор из единичек,
вернее, вектор, число y с крышкой
помножить на вектор из единичек.
И вот здесь будет та же самая проекция.
И давайте посмотрим на
получающийся треугольник с
вершинами в кончике вектора y с крышкой,
вершиной в кончике, вершина в
кончике вектора y, вершина в кончике
вектора y с крышкой и вершина в кончике
растянутого вектора из единичек.
Вот у нас получился некий треугольник.
Этот треугольник прямоугольный.
Давайте я для удобства назову точки: А,
B, C.
Этот треугольник прямоугольный, потому
что ε с крышкой перпендикулярен всему,
что лежит в облаке, а отрезок BC лежит
в облаке, поэтому этот треугольник
прямоугольный, и, соответственно, в нем
действует теорема Пифагора, а именно то,
что гипотенуза — это у нас будет третий
геометрический факт, — а именно то,
что AB квадрат равняется
AC квадрат + BC квадрат.
Ну, давайте посмотрим на
смысл каждого показателя,
как он у нас интерпретируется
содержательно-эконометрически.
AC квадтрат — это длина вектора
ε с крышкой в квадрате.
Но AC квадрат — это длина
вектора ε с крышкой в квадрате,
это сумма ε_i с крышкой в квадрате,
это есть RSS.
Вектор AB квадрат, AB квадрат,
ну это длина вектора AB в квадрате.
Ну, вектор AB — это разница между y
и y среднее помножить на единичный.
Соответственно, это
длина вектора y минус y
среднее помножить на вектор из единичек,
и все в квадрате.
Ну, стало быть, это сумма y_i минус y
среднее в квадрате, стало быть, это TSS.
И, наконец,
BC квадрат — это длина вектора BC.
BC — это разница двух
векторов: вектора y с
крышкой и растянутого вектора из единичек.
Соответственно, это длина
вектора y с крышкой минус Y
среднее помножить на вектор из единичек,
в квадрате.
Стало быть,
это сумма y_i с крышкой минус y среднее,
в квадрате, и, стало быть, это ESS.
Таким образом, мы доказали,
что между показателями RSS,
TSS и ESS имеет место следующее
соотношение, а именно теорема Пифагора.
TSS равняется ESS плюс RSS.
Но на этом чудеса геометрической
интерпретации не заканчиваются.
Давайте посмотрим на четвертый факт,
а именно то, что отношение ESS,
деленное на TSS, это отношение квадрата
вот этого катета к длине гипотенузы,
поэтому отношение ESS к TSS,
которое мы дальше будем интерпретировать,
— это косинус квадрат, это отношение ESS,
это у нас BC квадрат делить на TSS,
это AB квадрат,
соответственно, это BC,
деленное на AB, в квадрате,
и это и есть отношение катета к
гипотенузе, это и есть косинус угла.
Соответственно, это есть косинус
некоего угла φ в квадрате.
Нам оно потребуется,
и я сразу покажу его геометрический смысл.
Значит, угол между BC и AB — это угол φ,
и косинус этого угла — это
есть отношение ESS к TSS.
И этими четырьмя фактами геометрическими
очень удобно оперировать,
чтобы понять смысл метода наименьших
квадратов, а именно y с крышкой —
это проекция у на множество векторов,
порождаемых с помощью регрессоров.
Второй факт,
что y среднее равен y с крышечкой среднее,
это вызвано первым условием, а именно тем,
что у нас включен в модель свободный член.
Отсюда при взятии производной по β₁
с крышкой получается вот это условие.
И благодаря этому факту, мы получаем,
что TSS = ESS + RSS, действует теорема
Пифагора, и отношение ESS к TSS,
которое имеет смысл, это, оказывается,
косинус квадрат некоторого угла.

