1
00:00:12,725 --> 00:00:20,200
Теперь рассмотрим ту же самую ситуацию,
когда у нас много регрессоров.

2
00:00:20,200 --> 00:00:24,882
Я напомню, что мы с вами вывели
условие первого порядка,

3
00:00:24,882 --> 00:00:28,025
что сумма ε_i с крышкой
на единичке равна нулю,

4
00:00:28,025 --> 00:00:32,977
сумма ε_i с крышкой на х_i равна нулю и
сумма ε_i с крышкой на z_i тоже равна нулю.

5
00:00:32,977 --> 00:00:35,339
И геометрически это означает,

6
00:00:35,339 --> 00:00:38,900
что вектор ε с крышкой
перпендикулярен вектору из единичек,

7
00:00:38,900 --> 00:00:43,357
ε с крышкой перпендикулярен вектору Х и
ε с крышкой перпендикулярен вектору Z.

8
00:00:43,357 --> 00:00:48,265
Соответственно, мы можем проиллюстрировать
метод наименьших квадратов для

9
00:00:48,265 --> 00:00:51,290
случая множества объясняющих переменных.

10
00:00:51,290 --> 00:00:56,885
Заодно на этом рисунке мы увидим,
где находится TSS, RSS и ESS.

11
00:00:56,885 --> 00:01:01,094
Сейчас мы проиллюстрируем в многомерном
пространстве случай множественной

12
00:01:01,094 --> 00:01:06,897
регрессии, то есть проиллюстрируем
оценку модели y_i = β₁ + β₂x_i

13
00:01:06,897 --> 00:01:14,030
+ β₃z_i + ε_i с помощью метода
наименьших квадратов.

14
00:01:14,030 --> 00:01:19,508
Я напомню, что мы выяснили, условие
первого порядка для оценки неизвестных

15
00:01:19,508 --> 00:01:25,075
коэффициентов β₁, β₂ и β₃ имеет
следующий вид: ε с крышкой должно быть

16
00:01:25,075 --> 00:01:31,451
перпендикулярно вектору из единичек,
ε с крышкой должно быть перпендикулярно

17
00:01:31,451 --> 00:01:36,710
вектору x и ε с крышкой должно
быть перпендикулярно вектору z.

18
00:01:36,710 --> 00:01:40,680
Это первый факт, который легко
иллюстрировать геометрически.

19
00:01:40,680 --> 00:01:41,850
Второй факт.

20
00:01:41,850 --> 00:01:46,531
Да, из этой системы уравнений
мы находим β₁ с крышкой,

21
00:01:46,531 --> 00:01:52,342
β₂ с крышкой и β₃ с крышкой,
— оценки неизвестных β₁, β₂ и β₃.

22
00:01:52,342 --> 00:01:56,493
Кроме того, мы знаем,
что ε_i с крышкой — это

23
00:01:56,493 --> 00:02:02,880
ошибка прогноза y_i минус y_i с крышкой,
отсюда получается,

24
00:02:02,880 --> 00:02:08,309
что y_i равняется y_i с
крышкой плюс ε_i с крышкой или

25
00:02:08,309 --> 00:02:14,410
в векторной форме вектор y равен
вектор y с крышкой плюс ε с крышкой.

26
00:02:14,410 --> 00:02:19,473
И этот факт, конечно, тоже прекрасно
иллюстрируется геометрически.

27
00:02:19,473 --> 00:02:25,295
Это означает, что можно пройти вектор y,
а можно пройти вектор y с крышкой,

28
00:02:25,295 --> 00:02:29,770
а потом пройти вектор ε с крышкой,
и мы придем в одну и ту же точку.

29
00:02:29,770 --> 00:02:33,002
Теперь мы можем спокойно иллюстрировать.

30
00:02:33,002 --> 00:02:39,000
Кроме того, пожалуй,
стоит еще отметить, что y с

31
00:02:39,000 --> 00:02:45,075
крышкой равен β₁ с крышкой на вектор

32
00:02:45,075 --> 00:02:50,537
из единичек плюс β₂ с крышкой на вектор
Х плюс β₃ с крышкой на вектор z.

33
00:02:50,537 --> 00:02:53,953
То есть вектор y с крышкой можно выразить,
взяв,

34
00:02:53,953 --> 00:02:58,650
сложив с какими-то весами: вектор из
одних единичек, вектор x и вектор z.

35
00:02:58,650 --> 00:03:00,311
Теперь рисуем.

36
00:03:00,311 --> 00:03:04,230
Вот это у нас вектор из одних единичек,

37
00:03:04,230 --> 00:03:08,560
это продолжение: он
задает некоторую прямую.

38
00:03:08,560 --> 00:03:10,488
Будет у нас начало координат.

39
00:03:10,488 --> 00:03:15,540
Я напомню, что пространство у нас
n-мерное, n — это количество наблюдений,

40
00:03:15,540 --> 00:03:19,917
поэтому… и n, как правило, велико,
например, 100 наблюдений, поэтому,

41
00:03:19,917 --> 00:03:25,616
например, в этом пространстве мы можем
нарисовать 20 векторов, перпендикулярных

42
00:03:25,616 --> 00:03:31,660
друг другу, и при этом все попарно
будут перпендикулярны друг другу.

43
00:03:31,660 --> 00:03:40,550
Это — вектор x, это — вектор z.

44
00:03:40,550 --> 00:03:48,800
Это будет вектор y.

45
00:03:48,800 --> 00:03:54,312
Во-первых, я все множество векторов,
которые можно получить,

46
00:03:54,312 --> 00:03:56,611
складывая с каким-то весом вектор x,

47
00:03:56,611 --> 00:04:01,610
вектор z и вектор из единичек,
обозначил вот таким вот облачком.

48
00:04:01,610 --> 00:04:05,094
То есть облачко — это все те вектора,
которые можно получить,

49
00:04:05,094 --> 00:04:09,040
складывая с некоторыми весами вектор x,
вектор z и вектор из единичек.

50
00:04:09,040 --> 00:04:13,240
Итак, как я геометрически интерпретирую
условие первого порядка и факт,

51
00:04:13,240 --> 00:04:17,440
что ε с крышкой — это разница
между y и y с крышкой.

52
00:04:17,440 --> 00:04:22,265
Во-первых, y с крышкой можно
выразить через вектор из единичек,

53
00:04:22,265 --> 00:04:23,831
через вектор x и через вектор z.

54
00:04:23,831 --> 00:04:25,398
Вот она, формула выражающая.

55
00:04:25,398 --> 00:04:30,920
Значит, он лежит в этом облачке, в этой,
говоря умными словами, гиперплоскости.

56
00:04:30,920 --> 00:04:40,355
Значит, вектор y с крышкой,
давайте он будет другого цвета.

57
00:04:40,355 --> 00:04:47,960
Это вектор y с крышкой.

58
00:04:47,960 --> 00:04:55,600
Заметим, что вектор ε с крышкой

59
00:04:59,645 --> 00:05:02,759
в сумме с вектором y с
крышкой дает вектор Y.

60
00:05:02,759 --> 00:05:07,775
Кроме того, поскольку плоскость,
эта гиперплоскость, это облачко образовано

61
00:05:07,775 --> 00:05:13,017
вектором из единичек, вектором x и
вектором z, а всем им вектор ε с крышкой

62
00:05:13,017 --> 00:05:18,101
перпендикулярен, значит ε с крышкой
перпендикулярен всей гиперплоскости,

63
00:05:18,101 --> 00:05:23,850
всему облачку, и, соответственно,
вот здесь вот мы получаем прямой угол.

64
00:05:23,850 --> 00:05:30,120
Таким образом, мы получили следующую
интерпретацию метода наименьших квадратов.

65
00:05:30,120 --> 00:05:37,150
y с крышкой, прогнозы, которые мы
получаем по методу наименьших квадратов,

66
00:05:37,150 --> 00:05:42,770
это проекция, проекция исходного

67
00:05:42,770 --> 00:05:49,374
вектора зависимых
переменных y на множество,

68
00:05:49,374 --> 00:05:57,530
на множество векторов,
получаемых с помощью,

69
00:05:57,530 --> 00:06:04,859
получаемых с помощью сложения с разными

70
00:06:04,859 --> 00:06:11,070
весами: вектора из единичек,
вектора x и вектора z.

71
00:06:11,070 --> 00:06:15,020
Это первый геометрический факт.

72
00:06:15,020 --> 00:06:18,960
Заметим другие геометрические факты.

73
00:06:18,960 --> 00:06:24,817
Во-первых, отметим,
что из условия первого порядка,

74
00:06:24,817 --> 00:06:28,290
что ε с крышкой перпендикулярен
вектору из единичек,

75
00:06:28,290 --> 00:06:33,660
у нас получается,
что сумма ε_i с крышкой равняется нулю,

76
00:06:33,660 --> 00:06:38,790
или то, что сумма y_i минус
y_i с крышкой равняется нулю,

77
00:06:38,790 --> 00:06:44,540
или, что сумма y_i равняется
сумме y_i с крышкой,

78
00:06:44,540 --> 00:06:48,860
или y среднее равняется
y с крышкой среднее.

79
00:06:48,860 --> 00:06:53,388
То есть среднее значение фактических
зависимых переменных равно

80
00:06:53,388 --> 00:06:55,580
среднему значению прогнозов.

81
00:06:55,580 --> 00:07:01,236
Но мы знаем,
что среднее значение можно получить,

82
00:07:01,236 --> 00:07:08,126
спроецировав любой вектор на прямую,
порождаемую вектором из одних единичек.

83
00:07:08,126 --> 00:07:13,853
Соответственно, вот этот факт
геометрически означает следующее.

84
00:07:13,853 --> 00:07:19,513
Если я спроецирую вектор y на прямую,
порождаемую вектором из единичек,

85
00:07:19,513 --> 00:07:22,095
и спроецирую y с крышкой
на ту же самую прямую,

86
00:07:22,095 --> 00:07:24,560
то эти проекции попадут
в одну и ту же точку.

87
00:07:24,560 --> 00:07:28,921
Ну, еще в школе этот факт в одиннадцатом
классе назывался теоремой о

88
00:07:28,921 --> 00:07:30,510
трех перпендикулярах.

89
00:07:30,510 --> 00:07:35,710
Вот здесь он чудесным образом проявляется.

90
00:07:35,710 --> 00:07:44,855
Здесь я получу вектор y с крышкой
помножить на вектор из единичек,

91
00:07:44,855 --> 00:07:50,160
вернее, вектор, число y с крышкой
помножить на вектор из единичек.

92
00:07:50,160 --> 00:07:55,540
И вот здесь будет та же самая проекция.

93
00:08:00,450 --> 00:08:05,697
И давайте посмотрим на
получающийся треугольник с

94
00:08:05,697 --> 00:08:12,189
вершинами в кончике вектора y с крышкой,

95
00:08:12,189 --> 00:08:17,815
вершиной в кончике, вершина в
кончике вектора y, вершина в кончике

96
00:08:17,815 --> 00:08:23,900
вектора y с крышкой и вершина в кончике
растянутого вектора из единичек.

97
00:08:23,900 --> 00:08:27,291
Вот у нас получился некий треугольник.

98
00:08:27,291 --> 00:08:30,290
Этот треугольник прямоугольный.

99
00:08:30,290 --> 00:08:39,138
Давайте я для удобства назову точки: А,
B, C.

100
00:08:39,138 --> 00:08:44,768
Этот треугольник прямоугольный, потому
что ε с крышкой перпендикулярен всему,

101
00:08:44,768 --> 00:08:51,477
что лежит в облаке, а отрезок BC лежит
в облаке, поэтому этот треугольник

102
00:08:51,477 --> 00:08:56,133
прямоугольный, и, соответственно, в нем
действует теорема Пифагора, а именно то,

103
00:08:56,133 --> 00:09:02,952
что гипотенуза — это у нас будет третий
геометрический факт, — а именно то,

104
00:09:02,952 --> 00:09:10,120
что AB квадрат равняется
AC квадрат + BC квадрат.

105
00:09:10,120 --> 00:09:15,488
Ну, давайте посмотрим на
смысл каждого показателя,

106
00:09:15,488 --> 00:09:18,710
как он у нас интерпретируется
содержательно-эконометрически.

107
00:09:18,710 --> 00:09:24,860
AC квадтрат — это длина вектора
ε с крышкой в квадрате.

108
00:09:24,860 --> 00:09:30,877
Но AC квадрат — это длина
вектора ε с крышкой в квадрате,

109
00:09:30,877 --> 00:09:35,573
это сумма ε_i с крышкой в квадрате,
это есть RSS.

110
00:09:35,573 --> 00:09:44,400
Вектор AB квадрат, AB квадрат,
ну это длина вектора AB в квадрате.

111
00:09:44,400 --> 00:09:49,820
Ну, вектор AB — это разница между y
и y среднее помножить на единичный.

112
00:09:49,820 --> 00:09:53,410
Соответственно, это
длина вектора y минус y

113
00:09:53,410 --> 00:09:58,560
среднее помножить на вектор из единичек,
и все в квадрате.

114
00:09:58,560 --> 00:10:06,470
Ну, стало быть, это сумма y_i минус y
среднее в квадрате, стало быть, это TSS.

115
00:10:06,470 --> 00:10:12,771
И, наконец,
BC квадрат — это длина вектора BC.

116
00:10:12,771 --> 00:10:16,432
BC — это разница двух
векторов: вектора y с

117
00:10:16,432 --> 00:10:19,410
крышкой и растянутого вектора из единичек.

118
00:10:19,410 --> 00:10:23,798
Соответственно, это длина
вектора y с крышкой минус Y

119
00:10:23,798 --> 00:10:27,790
среднее помножить на вектор из единичек,
в квадрате.

120
00:10:27,790 --> 00:10:33,167
Стало быть,
это сумма y_i с крышкой минус y среднее,

121
00:10:33,167 --> 00:10:37,050
в квадрате, и, стало быть, это ESS.

122
00:10:37,050 --> 00:10:42,139
Таким образом, мы доказали,
что между показателями RSS,

123
00:10:42,139 --> 00:10:49,520
TSS и ESS имеет место следующее
соотношение, а именно теорема Пифагора.

124
00:10:49,520 --> 00:10:54,250
TSS равняется ESS плюс RSS.

125
00:10:54,250 --> 00:11:00,340
Но на этом чудеса геометрической
интерпретации не заканчиваются.

126
00:11:00,340 --> 00:11:06,074
Давайте посмотрим на четвертый факт,

127
00:11:06,074 --> 00:11:13,990
а именно то, что отношение ESS,

128
00:11:13,990 --> 00:11:20,210
деленное на TSS, это отношение квадрата

129
00:11:24,070 --> 00:11:29,780
вот этого катета к длине гипотенузы,

130
00:11:29,780 --> 00:11:34,920
поэтому отношение ESS к TSS,
которое мы дальше будем интерпретировать,

131
00:11:34,920 --> 00:11:39,661
— это косинус квадрат, это отношение ESS,

132
00:11:39,661 --> 00:11:46,869
это у нас BC квадрат делить на TSS,
это AB квадрат,

133
00:11:46,869 --> 00:11:52,862
соответственно, это BC,
деленное на AB, в квадрате,

134
00:11:52,862 --> 00:11:58,785
и это и есть отношение катета к
гипотенузе, это и есть косинус угла.

135
00:11:58,785 --> 00:12:04,610
Соответственно, это есть косинус
некоего угла φ в квадрате.

136
00:12:04,610 --> 00:12:09,910
Нам оно потребуется,
и я сразу покажу его геометрический смысл.

137
00:12:09,910 --> 00:12:14,890
Значит, угол между BC и AB — это угол φ,

138
00:12:14,890 --> 00:12:20,401
и косинус этого угла — это
есть отношение ESS к TSS.

139
00:12:20,401 --> 00:12:26,692
И этими четырьмя фактами геометрическими
очень удобно оперировать,

140
00:12:26,692 --> 00:12:31,120
чтобы понять смысл метода наименьших
квадратов, а именно y с крышкой —

141
00:12:31,120 --> 00:12:36,330
это проекция у на множество векторов,
порождаемых с помощью регрессоров.

142
00:12:36,330 --> 00:12:41,430
Второй факт,
что y среднее равен y с крышечкой среднее,

143
00:12:41,430 --> 00:12:46,399
это вызвано первым условием, а именно тем,

144
00:12:46,399 --> 00:12:50,472
что у нас включен в модель свободный член.

145
00:12:50,472 --> 00:12:55,590
Отсюда при взятии производной по β₁
с крышкой получается вот это условие.

146
00:12:55,590 --> 00:13:00,827
И благодаря этому факту, мы получаем,

147
00:13:00,827 --> 00:13:06,317
что TSS = ESS + RSS, действует теорема
Пифагора, и отношение ESS к TSS,

148
00:13:06,317 --> 00:13:12,880
которое имеет смысл, это, оказывается,
косинус квадрат некоторого угла.

