Человек практически всю
жизнь говорит прозой,
иногда не осознавая этого, и точно так же,
не осознавая, использует метод
максимального правдоподобия.
Приведем такой пример бытовой ситуации.
Если я приезжаю в какой-то
незнакомый город,
прихожу на главную площадь
и вижу работающий фонтан.
И у меня, например,
в голове возникают две гипотезы.
Первая — что здесь фонтан
работает каждый вечер,
и поэтому я пришел в
случайный вечер и увидел его.
И вторая,
совершенно противоположная гипотеза,
что фонтан на самом деле в этом
городе включают один раз в году,
и просто мне так повезло, что я приехал
как раз в тот день, когда он работал.
Вот две гипотезы,
обе они объясняют мои наблюдения.
Но при первой гипотезе,
что фонтан работает каждый вечер,
вероятность увидеть его,
приехав в случайный день, равна единице.
А при верной второй гипотезе,
что фонтан включают один раз день в году,
а я приехал и в первый вечер увидел
фонтан работающий, то вероятность того,
что я в случайный вечер увижу фонтан,
равна 1/365-ой.
То есть при гипотезе 1 вероятность
получить имеющиеся наблюдения равна
единичке.
А при гипотезе 2 вероятность получить
имеющиеся наблюдения рана 1/365-ой.
Так вот метод максимального правдоподобия
говорит, что выбирайте ту гипотезу,
при которой вероятность имеющихся
наблюдений максимальна.
Соответственно, согласно
этому простому принципу, мы,
приехав в город и увидев в первый
вечер работающий вечером фонтан,
скорей всего предположим, что, наверное,
здесь каждый вечер работает фонтан.
Итак, метод максимального
правдоподобия более формально.
У нас есть некий неизвестный параметр θ,
и мы хотим его оценить, то есть хотим
придумать некое θ с крышкой, которое
бы заменяло нам неизвестный параметр θ.
Метод максимального правдоподобия говорит:
возьмите такое значение θ с крышкой,
при котором вероятность получить
имеющиеся данные максимальна.
Рассмотрим простой пример задачи.
Здесь у нас будет какая-нибудь
дискретная случайная величина.
Пусть мы наблюдаем количество звонков,
сколько раз вам позвонили за первый день,
за второй день,
за третий день и за четвертый.
В первый день вам не позвонили ни разу,
во второй день — один раз,
в третий день — два раза,
в четвертый день — ноль раз.
И у вас есть некая модель, которая
зависит от неизвестного параметра p.
И, соответственно, мы хотим оценить с
помощью метода максимального правдоподобия
неизвестный параметр p.
Сейчас мы решим эту задачу.
Наши наблюдения будут: y_1 = 0,
y_2 = 1, y_3 = 2 и
y_4 = 0 И за кадром есть обязательно
какая-то модель для наших данных.
Предположим, что наша
модель имеет следующий вид.
Что y_i-тые – независимы, и для отдельно
взятого y_i вероятности того,
что он будет равен 0, 1 или 2,
соответственно равны p, 2p и 1-3p.
И оценим неизвестный параметр p с помощью
метода максимального правдоподобия.
Выписываем вероятность
получить имеющиеся у нас
наблюдения: y_1 = 0, вероятность того,
что одновременно y_2 = 1,
y_3 = 2 и 
y_4 = 0.
Поскольку мы предполагаем в модели,
что y_i-тые независимы,
то эта вероятность равна
произведению вероятностей.
Вероятность того, что y_1 = 0,
помножить на вероятность того,
что y_2 = 1, помножить на 
вероятность того,что y_3 = 2,
помножить на вероятность того, что y_4 = 0.
Поскольку у нас задана модель
для отдельно взятых наблюдений,
то мы получаем все эти вероятности.
Первая вероятность равно p,
вторая вероятность равно 2p,
третья вероятность того,
что y = 2, равно 1-3p,
и четвертая вероятность снова равна p.
Соответственно, мы
получили функцию: 2p куб,
помножить на 1-3p, и эту функцию нам надо
максимизировать, подбирая параметр p.
Мы сделаем маленький технических трюк.
Как правило,
максимизировать произведения тяжело.
Гораздо легче максимизировать сумму,
потому что есть такое простое правило,
что производная суммы
равна сумме производных.
Поэтому я, прежде, чем максимизировать
эту функцию, я логарифмирую ее.
Итак, я выпишу логарифм функции
правдоподобия l от p равняется
логарифму от 2p куб, помножить на 1-3p, и,
упростив немножко логарифм,
логарифм превращает произведение в сумму,
буду максимизировать логарифм
функции правдоподобия.
плюс логарифм 1-3p.
Берем производную, l штрих по p
равняется 
3 умножить на 1/p минус 3 
умножить на 1/(1-3p).
Чтобы найти экстремум функции,
приравниваем производную к 0, 3 умножить на 1,
деленное на p с крышечкой, - 3 умножить на 1,
деленное на 1-3p с крышечкой равняется 0.
Сокращаем на 3.
Домножаем на 1-3p на p с крышкой,
получаем: 1-3p с
крышкой - p с крышкой равняется 0.
Отсюда получаем,
что 4p с крышкой равняется 1.
И p с крышкой равняется 1/4.
Таким образом мы получили для
данной задачи оценку неизвестного
параметра p с помощью метода
максимального правдоподобия.
Мы промаксимизировали вероятность
получить имеющиеся у нас наблюдения.

