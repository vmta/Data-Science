Перейдем к оцениванию предельных эффектов.
Тут все просто.
В R уже есть готовая команда для
оценивания предельных эффектов,
надо только указать какие,
в каком смысле средние предельные
эффекты мы имеем в виду.
Если мы просто напишем
maBina(m_logit) и нажмем Ctrl+Enter,
то мы получим предельные эффекты для
среднестатистического пассажира Титаника.
То есть, это означает, что у него будет
средний возраст, это будет некий индивид
среднего пола на сколько-то процентов
мужчина, на сколько-то процентов женщина,
и вот для такого среднестатистического
индивида мы можем сказать, что увеличение
возраста на один год снижает
вероятность выжить на 0.008.
Если же мы хотим посчитать средний эффект,
усреднить его по всем пассажирам Титаника,
то мы должны указать немножко
другую опцию maBina(m_logit) и здесь
указать x.mean равняется FALSE.
Соответственно, вот этот предельный
эффект он рассчитывается по-другому.
Считается насколько увеличение возраста
на 1 год для каждого пассажира,
насколько это увеличит или
уменьшит его вероятность выжить,
а затем берется среднее
арифметическое по всем пассажирам.
Соответственно, при
такой постановке задачи,
если мы каждому пассажиру
увеличим возраст на 1 год,
а потом усредним вероятность
выжить по всем пассажирам,
то получится, что она падает на 0.005.
Проинтерпретируем предельные эффекты.
По умолчанию R выдает предельные эффекты,
рассчитанные для
среднестатистического наблюдения.
Ну, например, предельный эффект
при увеличении возраста на единичку,
предельный эффект на вероятность того,
что пассажир выживет, то есть на
вероятность того, что y равен единичке,
оцененный при средних значениях
регрессоров, давайте я поставлю тут x
среднее, этот предельный
эффект равен –0,008.
Это означает,
что для среднестатистического пассажира,
надо еще понять кто такой
среднестатистический пассажир,
но для среднестатистического пассажира
при увеличении возраста на единичку
вероятность падает на –0.008,
на восемь тысячных,
то есть примерно на один процентный
пункт падает вероятность выжить.
Кто такой среднестатистический пассажир?
Это пассажир, у которого средний возраст,
средний возраст,
средний возраст равен по выборке 30-ти
годам, но более того, это средний
пассажир, который средний, в том числе, по
таким дискретным характеристикам, как пол.
Этот пассажир гипотетический на 36%
женщина и на 64% мужчина.
Этот среднестатистический пассажир
на 25% едет первым классом,
на 21% вторым классом и
на 54% третьим классом.
И для такого среднестатистического
пассажира вот
он эффект увеличения возраста
на 1 год на вероятность выжить.
Сравним предельные эффекты
усредненные по всем пассажирам.
То есть мы рассчитаем
предельный эффект вероятности,
предельный эффект на вероятность выжить от
увеличения возраста для каждого пассажира,
и после этого усредним по всем пассажирам.
То есть мы рассчитываем эту величину
не для среднестатистического пассажира,
а рассчитываем для каждого пассажира,
получаем n эффектов и считаем
средний арифметический
эффект по этим n эффектам.
И он, согласно результатам оценивания,
равен –0.005.
То есть, если я каждому пассажиру
увеличу гипотетически возраст на 1 год,
то в среднем по всем
пассажирам вероятность
выжить уменьшится на пять тысячных,
то есть на половину процентного пункта.
Для дискретных переменных R автоматически
считает разницу вероятностей,
а не производную.
То есть если рассмотреть коэффициент,
предельный эффект при переменной пол,
то R автоматически считает следующую
разницу: вероятность того,
что y_i-тое равно единичке при условии,
что dime-переменная пол равен единичке,
то есть мужчина минус вероятность того,
что y_i-тое равно нулю при условии,
что этот пассажир женщина.
При этом опять же эту
разницу вероятностей можно
считать в двух вариантах.
Один вариант — для
среднестатистического пассажира,
для среднестатистического пассажира,
который имеет возраст 30 лет, на 36%
женщина и на 60% мужчина и так далее,
и усреднять по всем пассажирам,
усреднять по пассажирам.
То есть посчитать эту разницу
для каждого пассажира,
получить n чисел и взять по
ним среднее арифметическое.
В нашем случае эти два способа
подсчета дают один и тот же результат,
и этот предельный эффект равен –0.55.
То есть если сравнить двух пассажиров,
которые, ну, допустим,
рассмотрим двух среднестатистических
пассажиров, один из которых мужчина,
а другой женщина,
то разница в вероятности выжить у
мужчины на 55 процентных пунктов ниже,
чем у женщины.
Теперь сделаем вид, что мы не
знаем про логит и пробит модели и
попробуем применить старый обычный
метод наименьших квадратов.
Что произойдет в этом случае,
если мы применим неподходящий
метод к данному набору данных?
Я еще раз скажу, что его применять
некорректно, но надо всегда иметь в виду,
что вы можете реализовать применить
даже тот метод оценивания на компьютере,
который к этому набору данных не применим.
Здесь надо всегда иметь в виду, что
компьютер какие-то результаты да выдаст,
но вот интерпретировать
их надо будет осторожно.
Давайте попробуем.
Возьмем нашу формулу,
по которой мы оценивали логит модель.
Так, вот она.
И теперь вместо логит модели
оценим обычный метод наименьших квадратов.
Модель ols — это уже не обобщенная,
а просто линейная модель.
И здесь еще нужно одно
маленькое изменение.
Поскольку мы переменную survived
закодировали как факторную, а для метода
наименьших квадратов она должна считаться
количественной, ну давайте скажем,
чтобы компьютер трактовал ее как
количественную as.numeric(survived).
Соответственно, мы оценили модель
методом наименьших квадратов,
можем как всегда посмотреть
на значение коэффициентов,
оценки, проверку гипотез.
Давайте попробуем с помощью этой
модели предсказать вероятности,
как мы предсказывали их
с помощью модели логит.
Предсказанные вероятности
по модели ols predict,
модель ols для набора данных newdata.
А теперь посмотрим на сами
предсказанные вероятности.
На первые несколько
предсказанных вероятностей.
И мы видим,
что в этом случае модель для нашего
набора данных newdata
прогнозирует вероятности 1.37,
1,36, что явно не соответствует
действительности,
поскольку вероятности должны
лежать в диапазоне от 0 до 1.
Тем не менее, несмотря на такой
очевидный недостаток метода наименьших
квадратов применительно к
прогнозированию бинарных переменных,
тем не менее для средних наблюдений,
для среднестатистического индивида метод
наименьших квадратов вполне может
дать адекватные результаты.

