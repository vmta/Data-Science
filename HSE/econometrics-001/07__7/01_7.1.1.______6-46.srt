1
00:00:13,045 --> 00:00:17,946
Человек практически всю
жизнь говорит прозой,

2
00:00:17,946 --> 00:00:21,635
иногда не осознавая этого, и точно так же,

3
00:00:21,635 --> 00:00:25,155
не осознавая, использует метод
максимального правдоподобия.

4
00:00:25,155 --> 00:00:27,430
Приведем такой пример бытовой ситуации.

5
00:00:27,430 --> 00:00:30,054
Если я приезжаю в какой-то
незнакомый город,

6
00:00:30,054 --> 00:00:33,249
прихожу на главную площадь
и вижу работающий фонтан.

7
00:00:33,249 --> 00:00:36,776
И у меня, например,
в голове возникают две гипотезы.

8
00:00:36,776 --> 00:00:40,330
Первая — что здесь фонтан
работает каждый вечер,

9
00:00:40,330 --> 00:00:44,240
и поэтому я пришел в
случайный вечер и увидел его.

10
00:00:44,240 --> 00:00:47,904
И вторая,
совершенно противоположная гипотеза,

11
00:00:47,904 --> 00:00:51,892
что фонтан на самом деле в этом
городе включают один раз в году,

12
00:00:51,892 --> 00:00:56,380
и просто мне так повезло, что я приехал
как раз в тот день, когда он работал.

13
00:00:56,380 --> 00:00:59,390
Вот две гипотезы,
обе они объясняют мои наблюдения.

14
00:00:59,390 --> 00:01:03,780
Но при первой гипотезе,
что фонтан работает каждый вечер,

15
00:01:03,780 --> 00:01:09,020
вероятность увидеть его,
приехав в случайный день, равна единице.

16
00:01:09,020 --> 00:01:13,458
А при верной второй гипотезе,
что фонтан включают один раз день в году,

17
00:01:13,458 --> 00:01:18,080
а я приехал и в первый вечер увидел
фонтан работающий, то вероятность того,

18
00:01:18,080 --> 00:01:21,580
что я в случайный вечер увижу фонтан,
равна 1/365-ой.

19
00:01:21,580 --> 00:01:25,992
То есть при гипотезе 1 вероятность
получить имеющиеся наблюдения равна

20
00:01:25,992 --> 00:01:26,670
единичке.

21
00:01:26,670 --> 00:01:31,760
А при гипотезе 2 вероятность получить
имеющиеся наблюдения рана 1/365-ой.

22
00:01:31,760 --> 00:01:35,950
Так вот метод максимального правдоподобия
говорит, что выбирайте ту гипотезу,

23
00:01:35,950 --> 00:01:39,380
при которой вероятность имеющихся
наблюдений максимальна.

24
00:01:39,380 --> 00:01:43,847
Соответственно, согласно
этому простому принципу, мы,

25
00:01:43,847 --> 00:01:47,827
приехав в город и увидев в первый
вечер работающий вечером фонтан,

26
00:01:47,827 --> 00:01:52,050
скорей всего предположим, что, наверное,
здесь каждый вечер работает фонтан.

27
00:01:52,050 --> 00:01:55,273
Итак, метод максимального
правдоподобия более формально.

28
00:01:55,273 --> 00:01:59,281
У нас есть некий неизвестный параметр θ,
и мы хотим его оценить, то есть хотим

29
00:01:59,281 --> 00:02:03,312
придумать некое θ с крышкой, которое
бы заменяло нам неизвестный параметр θ.

30
00:02:03,312 --> 00:02:07,640
Метод максимального правдоподобия говорит:
возьмите такое значение θ с крышкой,

31
00:02:07,640 --> 00:02:11,370
при котором вероятность получить
имеющиеся данные максимальна.

32
00:02:11,370 --> 00:02:13,402
Рассмотрим простой пример задачи.

33
00:02:13,402 --> 00:02:17,080
Здесь у нас будет какая-нибудь
дискретная случайная величина.

34
00:02:17,080 --> 00:02:22,144
Пусть мы наблюдаем количество звонков,
сколько раз вам позвонили за первый день,

35
00:02:22,144 --> 00:02:24,808
за второй день,
за третий день и за четвертый.

36
00:02:24,808 --> 00:02:28,000
В первый день вам не позвонили ни разу,
во второй день — один раз,

37
00:02:28,000 --> 00:02:30,690
в третий день — два раза,
в четвертый день — ноль раз.

38
00:02:30,690 --> 00:02:34,603
И у вас есть некая модель, которая
зависит от неизвестного параметра p.

39
00:02:34,603 --> 00:02:39,443
И, соответственно, мы хотим оценить с
помощью метода максимального правдоподобия

40
00:02:39,443 --> 00:02:40,930
неизвестный параметр p.

41
00:02:40,930 --> 00:02:43,081
Сейчас мы решим эту задачу.

42
00:02:43,081 --> 00:02:47,394
Наши наблюдения будут: y_1 = 0,

43
00:02:47,394 --> 00:02:52,406
y_2 = 1, y_3 = 2 и

44
00:02:52,406 --> 00:02:58,014
y_4 = 0 И за кадром есть обязательно
какая-то модель для наших данных.

45
00:02:58,014 --> 00:03:01,367
Предположим, что наша
модель имеет следующий вид.

46
00:03:01,367 --> 00:03:07,174
Что y_i-тые – независимы, и для отдельно

47
00:03:07,174 --> 00:03:12,016
взятого y_i вероятности того,

48
00:03:12,016 --> 00:03:15,240
что он будет равен 0, 1 или 2,

49
00:03:15,240 --> 00:03:21,524
соответственно равны p, 2p и 1-3p.

50
00:03:21,524 --> 00:03:28,610
И оценим неизвестный параметр p с помощью
метода максимального правдоподобия.

51
00:03:28,610 --> 00:03:34,383
Выписываем вероятность
получить имеющиеся у нас

52
00:03:34,383 --> 00:03:39,890
наблюдения: y_1 = 0, вероятность того,
что одновременно y_2 = 1,

53
00:03:39,890 --> 00:03:44,610
y_3 = 2 и 

54
00:03:44,610 --> 00:03:51,240
y_4 = 0.

55
00:03:51,240 --> 00:03:54,779
Поскольку мы предполагаем в модели,
что y_i-тые независимы,

56
00:03:54,779 --> 00:03:57,870
то эта вероятность равна
произведению вероятностей.

57
00:03:57,870 --> 00:04:02,647
Вероятность того, что y_1 = 0,
помножить на вероятность того,

58
00:04:02,647 --> 00:04:08,000
что y_2 = 1, помножить на 
вероятность того,что y_3 = 2,

59
00:04:08,000 --> 00:04:12,380
помножить на вероятность того, что y_4 = 0.

60
00:04:12,380 --> 00:04:16,502
Поскольку у нас задана модель
для отдельно взятых наблюдений,

61
00:04:16,502 --> 00:04:18,698
то мы получаем все эти вероятности.

62
00:04:18,698 --> 00:04:22,556
Первая вероятность равно p,
вторая вероятность равно 2p,

63
00:04:22,556 --> 00:04:26,717
третья вероятность того,
что y = 2, равно 1-3p,

64
00:04:26,717 --> 00:04:30,600
и четвертая вероятность снова равна p.

65
00:04:30,600 --> 00:04:35,837
Соответственно, мы
получили функцию: 2p куб,

66
00:04:35,837 --> 00:04:40,921
помножить на 1-3p, и эту функцию нам надо

67
00:04:40,921 --> 00:04:45,833
максимизировать, подбирая параметр p.

68
00:04:45,833 --> 00:04:50,280
Мы сделаем маленький технических трюк.

69
00:04:50,280 --> 00:04:53,093
Как правило,
максимизировать произведения тяжело.

70
00:04:53,093 --> 00:04:57,304
Гораздо легче максимизировать сумму,
потому что есть такое простое правило,

71
00:04:57,304 --> 00:04:59,990
что производная суммы
равна сумме производных.

72
00:04:59,990 --> 00:05:04,340
Поэтому я, прежде, чем максимизировать
эту функцию, я логарифмирую ее.

73
00:05:04,340 --> 00:05:10,295
Итак, я выпишу логарифм функции
правдоподобия l от p равняется

74
00:05:10,295 --> 00:05:15,404
логарифму от 2p куб, помножить на 1-3p, и,

75
00:05:15,404 --> 00:05:21,280
упростив немножко логарифм,
логарифм превращает произведение в сумму,

76
00:05:21,280 --> 00:05:28,670
буду максимизировать логарифм
функции правдоподобия.

77
00:05:28,670 --> 00:05:31,620
плюс логарифм 1-3p.

78
00:05:31,620 --> 00:05:35,995
Берем производную, l штрих по p

79
00:05:35,995 --> 00:05:42,460
равняется 

80
00:05:42,460 --> 00:05:47,910
3 умножить на 1/p минус 3 
умножить на 1/(1-3p).

81
00:05:47,910 --> 00:05:53,644
Чтобы найти экстремум функции,
приравниваем производную к 0, 3 умножить на 1,

82
00:05:53,644 --> 00:05:59,132
деленное на p с крышечкой, - 3 умножить на 1,

83
00:05:59,132 --> 00:06:04,930
деленное на 1-3p с крышечкой равняется 0.

84
00:06:04,930 --> 00:06:08,510
Сокращаем на 3.

85
00:06:08,510 --> 00:06:14,493
Домножаем на 1-3p на p с крышкой,
получаем: 1-3p с

86
00:06:14,493 --> 00:06:19,943
крышкой - p с крышкой равняется 0.

87
00:06:19,943 --> 00:06:25,900
Отсюда получаем,
что 4p с крышкой равняется 1.

88
00:06:25,900 --> 00:06:29,150
И p с крышкой равняется 1/4.

89
00:06:29,150 --> 00:06:33,781
Таким образом мы получили для
данной задачи оценку неизвестного

90
00:06:33,781 --> 00:06:37,438
параметра p с помощью метода
максимального правдоподобия.

91
00:06:37,438 --> 00:06:41,460
Мы промаксимизировали вероятность
получить имеющиеся у нас наблюдения.

