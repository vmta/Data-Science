1
00:00:13,250 --> 00:00:17,521
Рассмотрим ещё один пример

2
00:00:17,521 --> 00:00:23,554
построения модели и её оценки с
помощью метода наименьших квадратов.

3
00:00:23,554 --> 00:00:27,740
Для этого возьмём ещё один встроенный
набор данных в R — набор данных по

4
00:00:27,740 --> 00:00:29,060
швейцарским кантонам.

5
00:00:29,060 --> 00:00:32,900
Поместим в табличку…Давайте табличку
на этот раз назовём буковкой t.

6
00:00:32,900 --> 00:00:37,090
В табличку t поместим
встроенный набор данных swiss.

7
00:00:37,090 --> 00:00:43,719
Опять же можно почитать документацию
по этому набору данных и обнаружить,

8
00:00:43,719 --> 00:00:48,040
что это данные 1888-го года,

9
00:00:48,040 --> 00:00:54,424
и переменные здесь: Fertility —
это количество детей до пяти лет,

10
00:00:54,424 --> 00:00:58,370
делённое на количество женщин, по-моему,
до 50-ти лет и отмасштабированное,

11
00:00:58,370 --> 00:01:01,582
на 1000 домноженное; Agriculture
— это процент мужчин,

12
00:01:01,582 --> 00:01:06,972
занятых в сельском хозяйстве;
Examination — это какие-то, процент тех,

13
00:01:06,972 --> 00:01:13,966
кто получил высокий результат где-то
на экзаменах в армии, и так далее.

14
00:01:13,966 --> 00:01:16,277
У нас есть описание этого набора данных.

15
00:01:16,277 --> 00:01:21,371
И мы попробуем посмотреть, как зависит,
соответственно, фертильность,

16
00:01:21,371 --> 00:01:25,630
то есть количество детей,
деленное на количество женщин,

17
00:01:25,630 --> 00:01:29,720
от остальных показателей по кантонам.

18
00:01:29,720 --> 00:01:35,168
Опять же, не забывайте никогда смотреть
на данные, то есть я рекомендую,

19
00:01:35,168 --> 00:01:39,837
во-первых, посмотреть
на табличку t вживую.

20
00:01:39,837 --> 00:01:44,950
Для этого мы бросим
взгляд на неё glimpse(t).

21
00:01:44,950 --> 00:01:49,580
Вот мы видим переменные и
первые несколько значений.

22
00:01:49,580 --> 00:01:54,820
Соответственно, можно посмотреть
описательные статистики describe(t).

23
00:01:54,820 --> 00:01:59,459
Нажимаем Ctrl Enter, видим среднее
значение по каждой переменной.

24
00:01:59,459 --> 00:02:02,996
Видим, что у нас 47
наблюдений и так далее.

25
00:02:02,996 --> 00:02:06,740
И, конечно, смотрите на графики.

26
00:02:06,740 --> 00:02:10,410
К сожалению, когда у вас много
количественных переменных,

27
00:02:10,410 --> 00:02:14,590
то одной диаграммы рассеяния,
которую мы строили, конечно недостаточно.

28
00:02:14,590 --> 00:02:19,423
И вообще визуализировать сложный набор
данных с большим количеством переменных

29
00:02:19,423 --> 00:02:20,830
очень сложно.

30
00:02:20,830 --> 00:02:27,233
Но одно из простейших средств посмотреть,
как-то хоть себе представить огромное

31
00:02:27,233 --> 00:02:31,527
количество переменных — это нарисовать
большое количество диаграмм рассеяния.

32
00:02:31,527 --> 00:02:35,239
В R есть готовая функция,
называется ggpairs,

33
00:02:35,239 --> 00:02:40,690
она живёт в пакете GGally,
который мы предварительно подгрузили.

34
00:02:40,690 --> 00:02:46,436
И можем набрать ggpairs(t) и посмотреть

35
00:02:46,436 --> 00:02:50,770
на результат.

36
00:02:50,770 --> 00:02:55,865
По графику, например,

37
00:02:55,865 --> 00:02:59,212
уже можно понять, что, например,
католики не любят протестантов.

38
00:02:59,212 --> 00:03:01,928
Вот так вот, раз,
и по этому графику вот видите,

39
00:03:01,928 --> 00:03:07,267
если я посмотрю переменную доли
католического населения в кантоне,

40
00:03:07,267 --> 00:03:14,004
то есть резкая поляризация: либо 0 %
католического населения, либо 100 %.

41
00:03:14,004 --> 00:03:19,191
Ну бывают редкие исключения, но в целом,
вот если посмотреть на переменную,

42
00:03:19,191 --> 00:03:23,760
то видна поляризация: либо 100 %
католического населения, либо 0 %.

43
00:03:23,760 --> 00:03:27,367
То есть на этом графике у нас представлена
диаграмма рассеяния каждой переменной с

44
00:03:27,367 --> 00:03:31,423
каждой: доля католического населения
против переменной Education, доля мужчин,

45
00:03:31,423 --> 00:03:36,020
занятых в сельском хозяйстве,
против переменной «фертильность».

46
00:03:36,020 --> 00:03:40,892
И здесь видна некоторая положительная
взаимосвязь: чем выше доля мужчин,

47
00:03:40,892 --> 00:03:45,713
занятых в сельском хозяйстве, тем выше
фертильность, то есть можем сделать вывод,

48
00:03:45,713 --> 00:03:50,431
что в сельских регионах, где больше
мужчин занято в сельском хозяйстве,

49
00:03:50,431 --> 00:03:52,446
там вот выше рождаемость.

50
00:03:52,446 --> 00:03:56,654
Соответственно, вот видна
какая-то отрицательная

51
00:03:56,654 --> 00:04:00,471
взаимосвязь между «фертильностью»
и переменной Examination.

52
00:04:00,471 --> 00:04:04,440
То есть на этом графике видно много
зависимостей, его можно долго изучать.

53
00:04:04,440 --> 00:04:10,940
А мы перейдём к оценке модели
методом наименьших квадратов.

54
00:04:10,940 --> 00:04:13,110
Давайте оценим какую-нибудь модель,

55
00:04:13,110 --> 00:04:18,610
пусть будет model2 с помощью метода
наименьших квадратов, то есть lm.

56
00:04:18,610 --> 00:04:23,521
По данным из таблички t оценим
следующую модель: мы посмотрим от

57
00:04:23,521 --> 00:04:25,387
чего зависит фертильность.

58
00:04:25,387 --> 00:04:28,518
То есть фертильность — это у
нас объясняемая переменная.

59
00:04:28,518 --> 00:04:31,920
Ставим тильдочку (~) и тут
пишем объясняющие переменные.

60
00:04:31,920 --> 00:04:36,205
В качестве потенциальных объясняющих
возьмём, скажем, долю мужчин,

61
00:04:36,205 --> 00:04:42,720
занятых в сельском хозяйстве,
переменную education и,

62
00:04:42,720 --> 00:04:49,070
скажем, долю католического населения
в соответствующем кантоне.

63
00:04:49,070 --> 00:04:52,159
Соответственно, запускаем нашу команду.

64
00:04:52,159 --> 00:04:54,599
Модель моментально оценивается.

65
00:04:54,599 --> 00:05:01,530
Мы можем посмотреть коэффициенты:
β с крышкой в оценённой модели.

66
00:05:01,530 --> 00:05:07,279
То есть видно, что в нашей модели
при прочих равных доля мужчин,

67
00:05:07,279 --> 00:05:11,270
занятых в сельском хозяйстве,
отрицательно сказывается на фертильности,

68
00:05:11,270 --> 00:05:14,019
образование — отрицательно,
а доля католического

69
00:05:14,019 --> 00:05:18,312
населения положительно сказывается
на показателе фертильности.

70
00:05:18,312 --> 00:05:24,516
Можно опять же посмотреть
спрогнозированные значения фертильности.

71
00:05:24,516 --> 00:05:29,572
Можно, соответственно, тут подписаны
названия кантонов швейцарских.

72
00:05:29,572 --> 00:05:35,300
Можно посмотреть остатки ε
с крышкой в нашей model2.

73
00:05:35,300 --> 00:05:40,370
Можно посмотреть показатель RSS,

74
00:05:40,370 --> 00:05:43,173
deviance(model2).

75
00:05:43,173 --> 00:05:47,896
Пропустил буковку n, deviance(model2).

76
00:05:47,896 --> 00:05:50,498
И можно посчитать R-квадрат.

77
00:05:50,498 --> 00:05:53,479
R-квадрат можно посчитать
ещё одним способом.

78
00:05:53,479 --> 00:05:57,389
Есть готовое понятие отчёта,
которое рассчитывает всякие дополнительные

79
00:05:57,389 --> 00:06:01,311
статистики для метода
наименьших квадратов.

80
00:06:01,311 --> 00:06:07,030
Давайте поместим в список
report некий отчёт по модели 2.

81
00:06:07,030 --> 00:06:11,520
И теперь из этого отчёта, ну,
во-первых, его можно посмотреть.

82
00:06:11,520 --> 00:06:15,852
Здесь куча информации,
которую мы пока не знаем, но,

83
00:06:15,852 --> 00:06:19,495
в частности, среди прочего
выводит этот отчёт показатель,

84
00:06:19,495 --> 00:06:23,357
который нам уже известен,
— множественный R-квадрат 0,64,

85
00:06:23,357 --> 00:06:28,480
и его можно из этого списка извлечь,
используя $r.squared.

86
00:06:28,480 --> 00:06:34,810
Соответственно R-квадрат
в этой модели равен 0,64,

87
00:06:34,810 --> 00:06:40,865
и он показывает корреляцию,
квадрат выборочной корреляции между

88
00:06:40,865 --> 00:06:46,333
спрогнозированной переменной и
исходной объясняемой переменной.

89
00:06:46,333 --> 00:06:53,581
Если я возьму корреляцию из таблички
t достану переменную fertility

90
00:06:53,581 --> 00:06:58,940
и возьму спрогнозированные
значения из model2,

91
00:06:58,940 --> 00:07:03,819
это у меня получится корреляция
между спрогнозированной

92
00:07:03,819 --> 00:07:08,640
переменной и исходной
зависимой переменной.

93
00:07:08,640 --> 00:07:12,147
И если я возведу эту корреляцию в квадрат,

94
00:07:12,147 --> 00:07:15,970
то я получу в точности
коэффициент R-квадрат.

95
00:07:15,970 --> 00:07:21,020
Аналогично можно в данном
наборе данных спрогнозировать:

96
00:07:21,020 --> 00:07:25,885
если я возьму новый набор данных

97
00:07:25,885 --> 00:07:32,285
nd2, data.frame,

98
00:07:32,285 --> 00:07:36,987
куда помещу гипотетические значения
для какого-нибудь региона, ну, скажем,

99
00:07:36,987 --> 00:07:42,125
рассмотрю регион с долей мужчин,

100
00:07:42,125 --> 00:07:47,060
занятых в сельском хозяйстве 0,5,
с долей католического населения,

101
00:07:47,060 --> 00:07:50,050
тоже пусть будет равной 0,5,

102
00:07:50,050 --> 00:07:55,080
и с переменной education, равной 20-ти.

103
00:07:55,080 --> 00:07:59,420
Вот создам новый набор данных.

104
00:07:59,420 --> 00:08:07,660
И, соответственно,
я смогу прогнозировать по model2 для nd2.

105
00:08:07,660 --> 00:08:12,751
У меня окажется, что показатель
фертильности, то есть это домноженное

106
00:08:12,751 --> 00:08:17,891
на 1000 количество детей до пяти лет,
делённое на количество женщин.

107
00:08:17,891 --> 00:08:20,580
Соответственно, прогноз равен 64.

