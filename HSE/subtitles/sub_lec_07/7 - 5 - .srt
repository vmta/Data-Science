1
00:00:13,270 --> 00:00:18,260
Мы будем оценивать логит и пробит-

2
00:00:18,260 --> 00:00:21,464
модели именно с помощью метода
максимального правдоподобия.

3
00:00:21,464 --> 00:00:23,250
Что такое логит и пробит-модели?

4
00:00:23,250 --> 00:00:27,430
В этих моделях мы пытаемся объяснить некую
бинарную переменную, то есть переменную,

5
00:00:27,430 --> 00:00:30,149
которая принимает значения: либо 0,
либо 1.

6
00:00:30,149 --> 00:00:33,430
Каждое наблюдение,
каждое y_i — это либо 0, либо 1.

7
00:00:33,430 --> 00:00:38,455
Соответственно, мы предполагаем,
что существует некая

8
00:00:38,455 --> 00:00:43,480
невидимая нами, скрытая,
ненаблюдаемая переменная y_i*.

9
00:00:43,480 --> 00:00:47,645
И y_i = 1, когда y_i* > 0.

10
00:00:47,645 --> 00:00:51,810
И y_i = 0,
когда скрытая переменная отрицательна.

11
00:00:51,810 --> 00:00:56,673
И модель строится не для y_i,
которое либо 0, либо 1,

12
00:00:56,673 --> 00:01:01,212
а именно для скрытой
ненаблюдаемой переменной y_i*.

13
00:01:01,212 --> 00:01:07,770
Модель имеет вид:
β₁ + β₂ x_i + ε_i.

14
00:01:07,770 --> 00:01:14,710
Разница логит и пробит-моделей состоит в
спецификации случайной составляющей ε_i.

15
00:01:14,710 --> 00:01:19,933
А именно в пробит-модели ε_i
предполагается стандартными нормальными

16
00:01:19,933 --> 00:01:25,402
случайными величинами с
матожиданием 0 и дисперсией 1,

17
00:01:25,402 --> 00:01:31,351
а в логит-модели ε_i, предполагается, имеет
специальное логистическое распределение.

18
00:01:31,351 --> 00:01:33,965
Кто не знаком с логистическим
распределением,

19
00:01:33,965 --> 00:01:38,938
пока временно может представлять себе, что
оно похоже на нормальное распределение с

20
00:01:38,938 --> 00:01:43,066
математическим ожиданием 0 и дисперсией,
равной 1,6 в квадрате.

21
00:01:43,066 --> 00:01:47,235
Давайте попробуем, чтобы лучше
почувствовать логистическую модель,

22
00:01:47,235 --> 00:01:53,820
посчитать в ней вероятность того, что y_i,
конкретное наблюдение, примет значение 1.

23
00:01:53,820 --> 00:02:00,703
С одной стороны, это вероятность того,
что скрытая переменная неотрицательна,

24
00:02:00,703 --> 00:02:06,321
поскольку скрытая переменная
β₁ + β₂ x_i + ε_i, мы получаем,

25
00:02:06,321 --> 00:02:10,590
что вероятность того, что y_i = 1,

26
00:02:10,590 --> 00:02:15,140
можно свести к некой вероятности на ε_i.

27
00:02:15,140 --> 00:02:21,300
То есть у нас получается вероятность того,
что ε_i < либо = β₁ + β₂ x_i,

28
00:02:21,300 --> 00:02:26,340
и это есть значение функции
распределения в точке β₁ + β₂ x_i.

29
00:02:26,340 --> 00:02:28,257
Из теории вероятности мы знаем,

30
00:02:28,257 --> 00:02:33,260
что значение функции распределения — это
есть некий интеграл от функции плотности.

31
00:02:33,260 --> 00:02:35,141
И теперь мы посчитаем с вами,

32
00:02:35,141 --> 00:02:39,227
чему же равна конкретно эта
вероятность для логит-модели.

33
00:02:39,227 --> 00:02:45,671
Функция плотности логистической случайной
величины f(u) имеет следующий вид — это

34
00:02:45,671 --> 00:02:50,990
e в степени (−u) делить на 
(1 + e в степени (−u)) в квадрате.

35
00:02:50,990 --> 00:02:55,180
Если домножить на e в степени
2u числитель и знаменатель,

36
00:02:55,180 --> 00:03:02,620
то получится в числителе e в степени u
делить на 1 + e в степени u в квадрате.

37
00:03:02,620 --> 00:03:07,140
И отсюда получается, что функция
четная в точке u и в точке (−u).

38
00:03:07,140 --> 00:03:09,707
Она принимает одинаковые значения.

39
00:03:09,707 --> 00:03:15,264
И ее график, если построить его,
то окажется, что он выглядит

40
00:03:15,264 --> 00:03:21,142
очень похоже на привычную кривую
плотности для нормального распределения.

41
00:03:21,142 --> 00:03:23,410
То есть центр на нуле, там же максимум,

42
00:03:23,410 --> 00:03:26,927
и кривая плавно убывает
к плюс и минус бесконечности.

43
00:03:26,927 --> 00:03:31,875
И отличие логистического распределения
от нормального состоит в том,

44
00:03:31,875 --> 00:03:34,891
что функцию распределения, я напомню,

45
00:03:34,891 --> 00:03:40,126
что функция распределения
F(t) — это вероятность того,

46
00:03:40,126 --> 00:03:44,030
что, соответственно,
случайная составляющая < либо = t.

47
00:03:44,030 --> 00:03:47,588
Вот эту функцию у логистического
распределения можно посчитать в

48
00:03:47,588 --> 00:03:48,287
явном виде.

49
00:03:48,287 --> 00:03:52,368
У нормального, к сожалению, это остается
интегралом, который в явном виде не

50
00:03:52,368 --> 00:03:55,596
берется, а у логистического распределения
без проблем можно посчитать,

51
00:03:55,596 --> 00:03:57,170
что мы сейчас быстренько и сделаем.

52
00:03:57,170 --> 00:04:02,690
Соответственно, это есть интеграл
от минус бесконечности до t,

53
00:04:02,690 --> 00:04:07,726
f(u)du, то есть на картинке функция

54
00:04:07,726 --> 00:04:12,413
распределения в точке t, это, значит,

55
00:04:12,413 --> 00:04:16,490
у нас u, это f(u), и вот это,

56
00:04:16,490 --> 00:04:22,130
эта площадь закрашенная, это F(t).

57
00:04:22,130 --> 00:04:28,140
Соответственно, этот интеграл,
к счастью, легко берется.

58
00:04:28,140 --> 00:04:32,400
Мы берем интеграл от
минус бесконечности до t,

59
00:04:32,400 --> 00:04:36,915
e в степени u делить на 
1 + e в степени u в квадрате du,

60
00:04:36,915 --> 00:04:40,530
e эту вносим под знак дифференциала,

61
00:04:40,530 --> 00:04:44,626
получаем ∫ от минус бесконечности до t,

62
00:04:44,626 --> 00:04:49,550
de в степени u делить на 1 + e в
степени u в квадрате,

63
00:04:49,550 --> 00:04:53,817
получается как будто e в степени u
— это x, а тут 1 + x в квадрате.

64
00:04:53,817 --> 00:04:59,133
Соответственно, интеграл — это (−1),
деленное на 1 + x,

65
00:04:59,133 --> 00:05:03,212
ну в роли икса выступает e в степени u.

66
00:05:03,212 --> 00:05:09,815
И мы меняем здесь u от
минус бесконечности до t.

67
00:05:09,815 --> 00:05:13,268
Подставляем t,

68
00:05:13,268 --> 00:05:18,310
получаем (−1) делить на 1 + e в степени t.

69
00:05:18,310 --> 00:05:20,975
И когда подставляем u
равное минус бесконечности,

70
00:05:20,975 --> 00:05:24,669
e в степени минус бесконечность
в пределе дает 0, получаем (−1).

71
00:05:24,669 --> 00:05:25,770
Но его надо вычесть.

72
00:05:25,770 --> 00:05:31,373
Поэтому получаем +1, и, соответственно,
если привести к общему знаменателю,

73
00:05:31,373 --> 00:05:36,932
получим: 1 + e в степени t − 1,
делить на 1 + e в степени t,

74
00:05:36,932 --> 00:05:41,961
и получается e в степени t
делить на 1 + e в степени t.

75
00:05:41,961 --> 00:05:47,295
И, соответственно, мы установили
такой факт, что для логистического

76
00:05:47,295 --> 00:05:52,240
распределения, функция распределения в
большой F(t) имеет вот такой простой вид.

77
00:05:52,240 --> 00:05:55,541
График ее, естественно,

78
00:05:55,541 --> 00:06:00,970
является возрастающим графиком от 0 до 1,

79
00:06:00,970 --> 00:06:06,310
то есть это вот какая-то
вот такая функция.

80
00:06:06,310 --> 00:06:11,335
Но в отличии от нормальной, для графика,

81
00:06:11,335 --> 00:06:15,080
соответствующего для нормальной случайной
величины, здесь явный простой вид.

82
00:06:15,080 --> 00:06:19,590
И, соответственно, мы можем
применить это к нашей логит-модели.

83
00:06:19,590 --> 00:06:24,763
В логит-модели вероятность того,
что y_i = 1,

84
00:06:24,763 --> 00:06:33,170
это есть значение функции распределения
в точке (β₁ + β₂ помножить на x_i).

85
00:06:33,170 --> 00:06:35,849
То есть, согласно нашей формуле,

86
00:06:35,849 --> 00:06:41,090
это есть e в степени β₁ + β₂ x_i,

87
00:06:41,090 --> 00:06:47,164
делить на 1 + e в степени β₁ + β₂ x_i.

88
00:06:47,164 --> 00:06:52,015
И также очень компактную
формулу имеет так называемое

89
00:06:52,015 --> 00:06:54,000
логарифмическое отношение шансов.

90
00:06:54,000 --> 00:06:58,670
То есть, если я возьму логарифм
отношения вероятности того,

91
00:06:58,670 --> 00:07:03,340
что y = 1 к вероятности того, что y = 0,

92
00:07:03,340 --> 00:07:08,200
ну если я временно величину β₁ +

93
00:07:08,200 --> 00:07:13,100
β₂x_i обозначу за t,

94
00:07:13,100 --> 00:07:18,270
то у меня получится, что это есть

95
00:07:18,270 --> 00:07:23,630
e в степени t делить, логарифм,

96
00:07:23,630 --> 00:07:28,170
e в степени t делить на 1 + e в степени t,

97
00:07:28,170 --> 00:07:36,210
а в знаменателе надо посчитать
вероятность того, что y_i = 0.

98
00:07:36,210 --> 00:07:40,860
Но если вероятность того,
что y_i = 1 считается по такой формуле,

99
00:07:40,860 --> 00:07:45,520
то поскольку вероятность того,
что y_i = 1 и вероятность того, что y_i = 0,

100
00:07:45,520 --> 00:07:49,741
дают в сумме 1, то соответственно,
вероятность того,

101
00:07:49,741 --> 00:07:53,950
что y_i = 0,
должна = 1 делить на 1 + e в степени t.

102
00:07:53,950 --> 00:07:59,990
И в нашем случае это выйдет:
1 делить на 1+ e в степени t.

103
00:07:59,990 --> 00:08:03,150
1+ e в степени t благополучно сократится,

104
00:08:03,150 --> 00:08:07,360
логарифм от экспоненты —
благополучно останется только t.

105
00:08:07,360 --> 00:08:12,218
И останется β₁ + β₂ x_i.

106
00:08:12,218 --> 00:08:17,043
И соответственно,
мы получили для логит-модели

107
00:08:17,043 --> 00:08:20,480
интерпретацию величины β₁ + β₂ x_i.

108
00:08:20,480 --> 00:08:25,895
Оказывается, это логарифм
отношения шансов того,

109
00:08:25,895 --> 00:08:32,480
что y окажется равным 1, деленное на
вероятность того, что y_i равно 0.

110
00:08:32,480 --> 00:08:38,135
Таким образом мы получили, что в
логистической модели вероятность того,

111
00:08:38,135 --> 00:08:43,139
что y_i равно 1, определяется как
1 деленное на 1 + экспонента в

112
00:08:43,139 --> 00:08:50,740
точке −β₁ + β₂ x_i, а очень красиво
выглядит логарифмическое отношение шансов.

113
00:08:50,740 --> 00:08:56,085
То есть логарифм отношения вероятности
того, что y_i = 1 к вероятности того,

114
00:08:56,085 --> 00:09:01,430
что y_i = 0,
принимает красивый вид β₁ + β₂ x_i.

115
00:09:01,430 --> 00:09:06,340
Это, к сожалению или к счастью, верно
только для логит-модели, для пробит-модели

116
00:09:06,340 --> 00:09:11,250
интегралы в явном виде не берутся и
таких наглядных формул не существует.

