1
00:00:13,270 --> 00:00:20,796
Логит и пробит-модели, единственная
проблема от которой они страдают — это то,

2
00:00:20,796 --> 00:00:25,640
что в некоторых случаях оценки метода
максимального правдоподобия не существуют.

3
00:00:25,640 --> 00:00:32,146
Мы рассмотрим простой пример, когда
складывается такая неприятная ситуация.

4
00:00:32,146 --> 00:00:38,801
У нас есть наблюдение: y_1 = 0,
y_2 = 0, и y_3 = 1.

5
00:00:38,801 --> 00:00:43,020
Это наблюдение за нашей
бинарной переменной.

6
00:00:43,020 --> 00:00:48,120
И мы пытаемся ее объяснить с
помощью некоторой объясняющей

7
00:00:48,120 --> 00:00:52,785
переменной x_1 = 1, x_2 = 2, x_3 = 3.

8
00:00:52,785 --> 00:00:57,558
Я напомню, что мы оцениваем логит-модель,

9
00:00:57,558 --> 00:01:02,005
то есть мы предполагаем, что y_i = 1 или 0.

10
00:01:02,005 --> 00:01:08,200
Единичке, если скрытая переменная y со
звездочкой больше, либо равна нулю.

11
00:01:08,200 --> 00:01:12,330
И нулю, если скрытая переменная
y со звездочкой меньше 0.

12
00:01:12,330 --> 00:01:17,533
А это самое y_i* = 

13
00:01:17,533 --> 00:01:23,230
β₁ + β₂ x_i + ε_i,
имеющая логистическое распределение.

14
00:01:23,230 --> 00:01:28,322
Как мы с вами установили,
вероятность того,

15
00:01:28,322 --> 00:01:33,800
что y_i = 1 равна 1,

16
00:01:33,800 --> 00:01:42,079
деленное на 1 + экспонента β₁ + β₂ x_i.

17
00:01:42,079 --> 00:01:48,591
Давайте изобразим
графически нашу ситуацию.

18
00:01:48,591 --> 00:01:51,580
У нас будет два графика.

19
00:01:51,580 --> 00:01:58,529
Верхний — это будет график
функции распределения.

20
00:01:58,529 --> 00:02:05,320
Здесь мы будет откладывать
значения β₁ + β₂ x.

21
00:02:05,320 --> 00:02:10,295
А по вертикали, соответственно,
будет откладываться

22
00:02:10,295 --> 00:02:15,400
от 0 до 1 вероятность того, что y_i = 1.

23
00:02:15,400 --> 00:02:22,950
На нижнем графике, вот здесь нижний
график будет немножко нетрадиционный.

24
00:02:22,950 --> 00:02:26,430
Мы x отложим по вертикали.

25
00:02:26,430 --> 00:02:29,550
По вертикали будет отложено значение x.

26
00:02:29,550 --> 00:02:37,130
А по горизонтали, чтобы графики совпадали,
будет отложено β₁ + β₂, умножить на x.

27
00:02:37,130 --> 00:02:42,660
Соответственно, у нас иксы — это 1,

28
00:02:42,660 --> 00:02:47,440
2 и 3.

29
00:02:47,440 --> 00:02:52,170
Если мы зафиксируем значения β₁ и β₂,

30
00:02:52,170 --> 00:02:56,900
возьмем какие-нибудь
конкретные значения β₁ и β₂,

31
00:02:56,900 --> 00:03:01,200
зависимость β₁ + β₂ x — линейная.

32
00:03:01,200 --> 00:03:05,481
Давайте мы назовем этот параметр а.

33
00:03:05,481 --> 00:03:09,069
Здесь будет а, здесь а и здесь а.

34
00:03:09,069 --> 00:03:15,615
Зависимость а от x линейная,
ее можно изобразить какой-то прямой.

35
00:03:15,615 --> 00:03:18,850
Давайте я нарисую какую-нибудь прямую.

36
00:03:18,850 --> 00:03:23,750
То есть, выбрав β₁ и β₂,

37
00:03:23,750 --> 00:03:29,351
я каждому x могу
соответственно сопоставить β₁

38
00:03:29,351 --> 00:03:34,360
+ β₂ умножить на x_1.

39
00:03:38,605 --> 00:03:42,850
β₁ + β₂ умножить на x_2.

40
00:03:42,850 --> 00:03:48,315
И β₁

41
00:03:48,315 --> 00:03:52,520
+ β₂ умножить на x_3.

42
00:03:52,520 --> 00:03:58,010
Подняв горизонтальные
координаты трех точек

43
00:03:58,010 --> 00:04:04,370
на верхний график,
я получу те же три значения.

44
00:04:04,370 --> 00:04:09,388
Теперь я дополню верхний график, я нарисую
там вот эту функцию распределения.

45
00:04:09,388 --> 00:04:12,827
То есть здесь на графике я нарисую F(а).

46
00:04:12,827 --> 00:04:16,560
Функция распределения,

47
00:04:16,560 --> 00:04:22,550
она имеет следующий вид: 1
делить на 1 + е в степени,

48
00:04:22,550 --> 00:04:31,499
+ экспонента от (-а).

49
00:04:31,499 --> 00:04:34,970
Ой, вот здесь я потерял минус в формуле.

50
00:04:34,970 --> 00:04:40,182
Соответственно, график имеет
следующий вид: функция

51
00:04:40,182 --> 00:04:44,270
является возрастающей от 0

52
00:04:44,270 --> 00:04:50,365
до 1.

53
00:04:50,365 --> 00:04:56,460
И отметим на… мы знаем,
что первый игрек у нас равен 0.

54
00:04:56,460 --> 00:05:00,840
Вероятность того,
что y равен 0 отмеряется сверху.

55
00:05:00,840 --> 00:05:07,820
Вот это у нас — вероятность того,
что y_1 = 0.

56
00:05:07,820 --> 00:05:12,537
Вот это у нас — вероятность того,

57
00:05:12,537 --> 00:05:19,270
что y_2 = 0.

58
00:05:19,270 --> 00:05:22,280
И вот эта вероятность снизу,

59
00:05:22,280 --> 00:05:26,920
это вероятность того, что y_3 = 1.

60
00:05:26,920 --> 00:05:31,560
Соответственно, значения
функции правдоподобия,

61
00:05:31,560 --> 00:05:36,537
а именно вероятность того, что y_1 = 0,

62
00:05:36,537 --> 00:05:41,582
y_2 = 0, и y_3 = 1, в силу независимости

63
00:05:41,582 --> 00:05:46,093
наблюдений, это есть
произведение вероятностей.

64
00:05:46,093 --> 00:05:50,917
Вероятность того, что y_1 = 0,
помножить на вероятность того,

65
00:05:50,917 --> 00:05:55,700
что y_2 = 0, помножить на вероятность того,
что y_3 = 1.

66
00:05:55,700 --> 00:05:59,966
Соответственно, значение
функции правдоподобия — есть

67
00:05:59,966 --> 00:06:02,525
произведение трех длин отрезков.

68
00:06:02,525 --> 00:06:07,022
Вероятность того, что y = 0,
помножить на вероятность того,

69
00:06:07,022 --> 00:06:11,240
что y_2 = 0, помножить на вероятность того,
что y_3 = 1.

70
00:06:11,240 --> 00:06:18,130
Меняя, подбирая β₁ и β₂,
то есть меняя наклон этой прямой,

71
00:06:18,130 --> 00:06:22,667
я меняю значения β₁ + β₂ х_1,

72
00:06:22,667 --> 00:06:26,243
β₁ + β₂ х_2 и β₁ + β₂ х_3.

73
00:06:26,243 --> 00:06:31,120
Меняются расположения трех
точек на горизонтальной оси.

74
00:06:31,120 --> 00:06:34,180
И соответственно меняются длины отрезков.

75
00:06:34,180 --> 00:06:38,014
И меняется результирующее произведение.

76
00:06:38,014 --> 00:06:43,657
Я напомню, что мы хотим
максимизировать это произведение,

77
00:06:43,657 --> 00:06:46,380
подбирая параметры β₁ и β₂.

78
00:06:46,380 --> 00:06:50,718
То есть мы хотим сделать это
произведение максимально возможным.

79
00:06:50,718 --> 00:06:55,169
И на этом графике становится понятно,
что экстремум не существует,

80
00:06:55,169 --> 00:06:58,566
потому что я могу так двигать прямую,
что точка,

81
00:06:58,566 --> 00:07:03,758
соответствующая третьему наблюдению,
уйдет далеко вправо.

82
00:07:03,758 --> 00:07:09,620
И длина отрезка, вероятность того,
что y_3 = 1, будет стремиться к 1.

83
00:07:09,620 --> 00:07:16,511
А точки, которые соответствуют первому
и второму наблюдению, уйдут влево.

84
00:07:16,511 --> 00:07:20,898
И, соответственно, вероятности того,

85
00:07:20,898 --> 00:07:24,975
что y_1 = 0 и y_2 = 0,
тоже будут стремиться к 1.

86
00:07:24,975 --> 00:07:29,780
Этого можно добиться,
выбрав прямую с очень, очень,

87
00:07:29,780 --> 00:07:32,935
очень, очень пологим наклоном.

88
00:07:32,935 --> 00:07:35,936
Вот если я вместо нарисованной
мной в первый раз

89
00:07:35,936 --> 00:07:40,776
прямой возьму прямую с более
пологим наклоном, вот такую вот,

90
00:07:40,776 --> 00:07:45,650
давайте я ее отмечу как-то по-другому,

91
00:07:45,650 --> 00:07:49,710
это альтернативные значения β₁ + β₂.

92
00:07:49,710 --> 00:07:54,028
Соответственно, при таких
альтернативных значениях точки первого,

93
00:07:54,028 --> 00:07:56,604
второго и третьего наблюдения.

94
00:07:56,604 --> 00:08:02,870
Третье наблюдение попадет
существенно правее, третий штрих.

95
00:08:02,870 --> 00:08:10,291
А точки, соответствующие первому
и второму наблюдению — два штрих,

96
00:08:10,291 --> 00:08:15,755
а один штрих даже вылазит за рисунок.

97
00:08:15,755 --> 00:08:18,230
Один штрих.

98
00:08:18,230 --> 00:08:22,910
Точки, соответствующие первому и второму
наблюдению будут лежать существенно левей.

99
00:08:22,910 --> 00:08:27,773
Соответственно, вероятности того,
что y_1 = 0, y_2 = 0,

100
00:08:27,773 --> 00:08:32,242
возрастут, и вероятность того,
что y_3 = 1, тоже возрастет.

101
00:08:32,242 --> 00:08:36,344
Но поскольку никаких ограничений
на наклон прямой у меня нет,

102
00:08:36,344 --> 00:08:41,413
я могу сделать наклон прямой сколь
угодно маленьким, то и, соответственно,

103
00:08:41,413 --> 00:08:46,685
экстремум этого произведения, произведения
длин трех отрезков будет недостижим.

104
00:08:46,685 --> 00:08:52,391
Следовательно, вот в таком простом примере
с тремя наблюдениями и одним регрессором,

105
00:08:52,391 --> 00:08:56,657
случай очень простой — три наблюдения,
один регрессор,

106
00:08:56,657 --> 00:09:01,460
уже оказалось, что бывает такое,
что оценки метода максимального

107
00:09:01,460 --> 00:09:04,330
правдоподобия в
логит-модели не существует.

108
00:09:04,330 --> 00:09:07,197
Заметим, что с существенной,

109
00:09:07,197 --> 00:09:11,750
содержательной точки зрения,
этот случай очень простой.

110
00:09:11,750 --> 00:09:15,810
Это задача, на самом деле,
здесь легко идеально прогнозировать.

111
00:09:15,810 --> 00:09:20,690
Тут можно построить правило гораздо проще,
чем логит-модель,

112
00:09:20,690 --> 00:09:24,655
которая звучит: если х2 > 2.5,

113
00:09:24,655 --> 00:09:29,860
значит y_3 = 1,
и это правило дает нам идеальные прогнозы.

114
00:09:29,860 --> 00:09:34,744
Оказывается, в ситуации,
когда возможно идеальное прогнозирование,

115
00:09:34,744 --> 00:09:39,220
оценки логит- и пробит- модели не
существуют, как показывает этот пример.

116
00:09:39,220 --> 00:09:43,615
Указанная нами проблема логит-
и пробит- моделей, как правило,

117
00:09:43,615 --> 00:09:47,277
она возникает при большом
количестве дамми-переменных,

118
00:09:47,277 --> 00:09:51,350
то есть переменных типа 0 или 1,
используемых в качестве регрессоров.

119
00:09:51,350 --> 00:09:54,833
Признаком является то,
что метод максимального правдоподобия,

120
00:09:54,833 --> 00:09:56,726
задача оптимизации, не сходится.

121
00:09:56,726 --> 00:10:03,110
R, как правило, выводит сообщение: fitted
probabilities numerically 0 or 1 occurred.

122
00:10:03,110 --> 00:10:08,587
Соответственно, решением ее является
либо регуляризация, либо использование

123
00:10:08,587 --> 00:10:12,500
байесовского подхода, которые лежат
за пределами нашего вводного курса.

124
00:10:12,500 --> 00:10:17,058
В сегодняшней лекции мы рассмотрели
метод максимального правдоподобия,

125
00:10:17,058 --> 00:10:20,200
а также применили его к
логит- и пробит-моделям.

126
00:10:20,200 --> 00:10:24,813
Логит- и пробит-модели предназначены
для моделирования зависимой переменной,

127
00:10:24,813 --> 00:10:27,960
которая принимает бинарные значения,
то есть 0 или 1.

128
00:10:27,960 --> 00:10:32,040
В этой ситуации, если использовать метод
наименьших квадратов, то можно получить

129
00:10:32,040 --> 00:10:38,538
прогнозируемые вероятности больше 1 или
меньше 0, что, конечно, не есть хорошо.

130
00:10:38,538 --> 00:10:43,223
В следующий раз мы применим метод
максимального правдоподобия к оценке

131
00:10:43,223 --> 00:10:44,930
модели временных рядов.

