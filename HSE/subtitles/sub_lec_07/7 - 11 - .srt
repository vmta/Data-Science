1
00:00:13,270 --> 00:00:17,945
Теперь наша задача перейти

2
00:00:17,945 --> 00:00:22,620
от спрогнозированных скрытых
переменных к прогнозу вероятности.

3
00:00:22,620 --> 00:00:27,885
Соответственно, мы
изменяем наш набор данных:

4
00:00:27,885 --> 00:00:35,740
newdata_pr равняется mutate(newdata_pr).

5
00:00:35,740 --> 00:00:41,421
Точечный прогноз вероятности
равен логистической функции

6
00:00:41,421 --> 00:00:47,890
распределения plogis в точке прогноза
скрытой переменной plogis(fit).

7
00:00:47,890 --> 00:00:52,854
Соответственно, левая граница
доверительного интервала left_ci

8
00:00:52,854 --> 00:00:57,034
confidence interval — это
будет логистическая функция

9
00:00:57,034 --> 00:01:02,179
распределения от точечного
прогноза скрытой переменной

10
00:01:02,179 --> 00:01:06,680
минус 1.96 помножить
на стандартную ошибку.

11
00:01:06,680 --> 00:01:11,236
И правая граница доверительного интервала

12
00:01:11,236 --> 00:01:16,445
right_ci равняется логистическая функция

13
00:01:16,445 --> 00:01:20,910
распределения в точке точечного

14
00:01:20,910 --> 00:01:26,370
прогноза плюс 1.96 умножить
на стандартную ошибку.

15
00:01:26,370 --> 00:01:32,280
Смотрим, что у нас все правильно
написано и запускаем нашу функцию.

16
00:01:32,280 --> 00:01:37,265
Давайте посмотрим снова на набор данных.

17
00:01:37,265 --> 00:01:42,250
И вот здесь у нас уже есть все,
что нам реально интересно:

18
00:01:42,250 --> 00:01:47,221
и возраст — старые объясняющие переменные,

19
00:01:47,221 --> 00:01:51,118
и предсказанная вероятность 0.4,
и доверительный интервал для вероятностей.

20
00:01:51,118 --> 00:01:55,690
Вот, например, для первого наблюдения,
для возраста 5 лет, соответственно,

21
00:01:55,690 --> 00:01:58,595
точечный прогноз вероятностей 0.4,

22
00:01:58,595 --> 00:02:04,156
а 95 %-й доверительный
интервал – от 0.28 до 0.52.

23
00:02:04,156 --> 00:02:11,320
Мы можем визуализировать наши
результаты прогнозирования на графике.

24
00:02:11,320 --> 00:02:17,634
qplot, данные

25
00:02:17,634 --> 00:02:22,360
мы берем из набора данных newdata_pr.

26
00:02:22,360 --> 00:02:26,390
По горизонтали мы на
этот раз отложим возраст,

27
00:02:26,390 --> 00:02:30,520
по вертикали мы отложим

28
00:02:30,520 --> 00:02:36,086
спрогнозированную точечную
вероятность и укажем,

29
00:02:36,086 --> 00:02:39,750
что графиком является простая линия.

30
00:02:39,750 --> 00:02:44,150
Соответственно, мы видим,
что точечный прогноз

31
00:02:44,150 --> 00:02:49,040
вероятности выжить падает
с ростом возраста.

32
00:02:49,040 --> 00:02:53,930
Теперь добавим на наш график границы
95 %-го доверительного интервала.

33
00:02:53,930 --> 00:03:00,126
Пишем плюс geom_ribbon, указываем,

34
00:03:00,126 --> 00:03:05,953
что границами закрашиваемой
области является

35
00:03:05,953 --> 00:03:10,788
ymin нижняя граница от left_ci до

36
00:03:10,788 --> 00:03:15,885
ymax — это правая граница
доверительного интервала.

37
00:03:15,885 --> 00:03:19,297
И давайте закрашивать не
сплошным черным цветом,

38
00:03:19,297 --> 00:03:24,421
это будет очень заметно, давайте
установим некий уровень прозрачности

39
00:03:24,421 --> 00:03:29,420
alpha = 0,2 и посмотрим на наш график.

40
00:03:29,420 --> 00:03:33,351
Вот мы видим теперь не только
точечные прогнозы вероятности выжить,

41
00:03:33,351 --> 00:03:35,155
но и доверительные интервалы.

42
00:03:35,155 --> 00:03:39,419
Причем заметно, что точность
прогнозирования растет с ростом возраста.

43
00:03:39,419 --> 00:03:43,670
Поскольку у нас мало детей и больше
пассажиров в возрасте, то поэтому

44
00:03:43,670 --> 00:03:48,235
доверительный интервал сокращается
с увеличением возраста пассажира,

45
00:03:48,235 --> 00:03:49,770
его ширина сокращается.

46
00:03:49,770 --> 00:03:52,421
Перейдем к сравнению моделей.

47
00:03:52,421 --> 00:03:57,310
Для этого сравним нашу модель с
моделью без финансовых переменных.

48
00:03:57,310 --> 00:04:01,370
Отберем сначала тот же набор данных,
на котором оценивалась первая модель.

49
00:04:01,370 --> 00:04:04,704
По умолчанию R выкидывает
пропущенные наблюдения,

50
00:04:04,704 --> 00:04:09,247
и поэтому первая модель оценивалась не
по всей выборке, а по тем наблюдениям,

51
00:04:09,247 --> 00:04:15,140
где присутствуют переменные: пол,
тариф, класс пассажира и его возраст.

52
00:04:15,140 --> 00:04:19,110
Отберем выборку t2 равняется,

53
00:04:19,110 --> 00:04:25,461
отберем нужные переменные select(t) пол,

54
00:04:25,461 --> 00:04:30,170
возраст, класс пассажира,

55
00:04:30,170 --> 00:04:34,120
выжил он или не выжил, тариф,

56
00:04:34,120 --> 00:04:39,630
и удалим из данной выборки
пропущенные значения.

57
00:04:39,630 --> 00:04:45,046
После этого на этой выборке,
на которой оценивалась первая модель,

58
00:04:45,046 --> 00:04:52,380
оценим вторую модель
m_logit2 равняется glm.

59
00:04:52,380 --> 00:04:57,938
Данные мы берем из набора данных t2,
формула будет более простой,

60
00:04:57,938 --> 00:05:02,757
мы пытаемся предсказать вероятность
выживет или не выживет только с помощью

61
00:05:02,757 --> 00:05:06,685
физической характеристики человека,
а именно пол и возраст.

62
00:05:06,685 --> 00:05:12,167
И точно так же,
как и ранее указываем семейство моделей

63
00:05:12,167 --> 00:05:19,140
биноминальное, family равняется binomial,

64
00:05:19,140 --> 00:05:26,705
и уравнение связи логит-.

65
00:05:26,705 --> 00:05:29,124
И указываем,
что нам потребуются, возможно,

66
00:05:29,124 --> 00:05:31,960
в дальнейшем иксы для
оценивания предельных эффектов.

67
00:05:31,960 --> 00:05:35,923
Теперь, когда у нас оценена
вторая модель более простая,

68
00:05:35,923 --> 00:05:41,888
мы можем их сравнить с помощью теста
отношения правдоподобия lr-теста.

69
00:05:41,888 --> 00:05:48,270
lrtest модель logit и модель logit2.

70
00:05:48,270 --> 00:05:54,075
Мы видим результаты теста,
тест нам говорит,

71
00:05:54,075 --> 00:05:59,040
что гипотеза отвергается,
потому что p-value очень мало.

72
00:05:59,040 --> 00:06:03,922
То есть гипотеза о том, что финансовые
переменные не оказывают влияния

73
00:06:03,922 --> 00:06:06,650
на вероятность выжить, отвергается.

