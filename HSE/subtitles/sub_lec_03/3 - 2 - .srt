1
00:00:12,520 --> 00:00:19,770
Рассмотрим построение доверительных
интервалов для прогнозов на примере.

2
00:00:19,770 --> 00:00:25,780
Исследователь оценил по 2040 наблюдениям

3
00:00:25,780 --> 00:00:33,677
модель стоимости квартир в Москве
и получил следующие результаты.

4
00:00:33,677 --> 00:00:38,910
Оценка цены квартиры
равна минус 62 плюс 2.6

5
00:00:38,910 --> 00:00:44,894
умножить на общую площадь квартиры,
при этом известно также,

6
00:00:44,894 --> 00:00:50,197
что оценка неизвестной дисперсии
ε, σ² с крышкой, равна

7
00:00:50,197 --> 00:00:55,204
1154 и ковариационная матрица,

8
00:00:55,204 --> 00:01:02,354
точнее ее оценка для неизвестных
коэффициентов, равна следующей

9
00:01:02,354 --> 00:01:08,741
матрице: 13.78 минус 0.18,

10
00:01:08,741 --> 00:01:14,840
минус 0.18 и 0.0025.

11
00:01:14,840 --> 00:01:19,650
И по имеющимся данным нам нужно
ответить на следующие вопросы.

12
00:01:19,650 --> 00:01:24,060
Наша цель — мы хотим спрогнозировать
стоимость квартиры площадью 60 метров.

13
00:01:24,060 --> 00:01:29,280
То есть у нас есть некая квартира,

14
00:01:29,280 --> 00:01:33,530
для которой мы хотим строить прогнозы,
поэтому я обозначу индексом F,

15
00:01:33,530 --> 00:01:37,499
общей площадью 60 метров,
мы для данных регрессоров,

16
00:01:37,499 --> 00:01:43,281
для данного значения регрессоров
хотим посчитать прогноз точечный

17
00:01:43,281 --> 00:01:49,703
price F с крышечкой и хотим
посчитать два интервала.

18
00:01:49,703 --> 00:01:56,145
Один 95 %-ный доверительный интервал

19
00:01:56,145 --> 00:02:01,498
для неизвестной средней стоимости

20
00:02:01,498 --> 00:02:08,010
квартиры с площадью 60 метров.

21
00:02:08,010 --> 00:02:14,266
И хотим посчитать 95 %-ный предиктивный,

22
00:02:14,266 --> 00:02:19,574
предиктивный интервал для
фактической стоимости

23
00:02:19,574 --> 00:02:27,670
одной случайно выбираемой квартиры
опять же с площадью 60 метров.

24
00:02:27,670 --> 00:02:34,878
Еще раз, в чем разница 
между этими объектами?

25
00:02:34,878 --> 00:02:40,710
Первое — это средняя стоимость квартиры
в Москве с площадью 60 метров.

26
00:02:40,710 --> 00:02:45,045
А это площадь случайно выбираемой
квартиры, это стоимость случайно

27
00:02:45,045 --> 00:02:48,170
выбираемой квартиры в Москве
с площадью 60 метров.

28
00:02:48,170 --> 00:02:52,272
То есть это некая характеристика
скорее города, а это вот,

29
00:02:52,272 --> 00:02:55,532
если вы собрались покупать одну квартиру,

30
00:02:55,532 --> 00:03:00,470
то вот y_F — это ее будущая цена.

31
00:03:00,470 --> 00:03:01,784
Давайте приступим.

32
00:03:01,784 --> 00:03:05,860
Получить точечный прогноз очень легко,
price_f с крышечкой, надо просто

33
00:03:05,860 --> 00:03:11,260
подставить значение объясняющих
переменных в уравнение регрессии.

34
00:03:11,260 --> 00:03:18,620
Минус 62 плюс 2.6 умножить на
60 и мы получаем примерно 94.

35
00:03:18,620 --> 00:03:23,140
Теперь перейдем к построению
доверительного интервала,

36
00:03:23,140 --> 00:03:27,590
у нас в каждом случае, в случае b
и в случае c, есть ошибка прогноза.

37
00:03:27,590 --> 00:03:32,859
В первом случае — это на сколько наша
спрогнозированная цена отличается

38
00:03:32,859 --> 00:03:37,838
от средней стоимости по Москве
для квартиры размера 60 метров.

39
00:03:37,838 --> 00:03:42,375
А второй, на сколько наш прогноз
отличается от конкретно выбранной

40
00:03:42,375 --> 00:03:44,549
случайной квартиры с площадью 60 метров.

41
00:03:44,549 --> 00:03:47,420
Насколько отличается
спрогнозированная цена от ее цены.

42
00:03:47,420 --> 00:03:49,247
И во втором случае ошибка больше.

43
00:03:49,247 --> 00:03:53,970
Соответственно,
давайте посчитаем сначала

44
00:03:53,970 --> 00:03:58,838
дисперсию β нашего,

45
00:03:58,838 --> 00:04:05,500
точнее прогноза price с крышечкой
при фиксированных иксах.

46
00:04:05,500 --> 00:04:09,840
За счет чего наш прогноз случаен?

47
00:04:09,840 --> 00:04:14,740
Шестьдесят не случайно — это то, что мы
выбрали, у нас регрессоры фиксированы.

48
00:04:14,740 --> 00:04:17,203
Соответственно, случаен он за счет того,

49
00:04:17,203 --> 00:04:21,810
что коэффициенты минус 62 и 2.6 на
самом деле — это результаты оценивания.

50
00:04:21,810 --> 00:04:26,584
И минус 62 и 2.6 зависели от вот
этой выборки в 2040 наблюдений.

51
00:04:26,584 --> 00:04:31,317
Если бы нам попалась другая выборка,
у нас были бы здесь не минус 62 и 2.6

52
00:04:31,317 --> 00:04:34,572
а какие-то другие числа,
случайность и следовательно,

53
00:04:34,572 --> 00:04:38,603
не нулевая дисперсия прогноза связана с
тем, что мы оцениваем коэффициенты не по

54
00:04:38,603 --> 00:04:42,820
всем наблюдениям Москвы,
а по случайной выборке.

55
00:04:42,820 --> 00:04:47,700
Соответственно, наша дисперсия
— это дисперсия β₁ с крышкой

56
00:04:47,700 --> 00:04:52,250
плюс β₂ с крышкой помножить на
60 при фиксированных иксах.

57
00:04:52,250 --> 00:04:57,257
И она равняется по свойствам дисперсии,
это дисперсия

58
00:04:57,257 --> 00:05:02,560
β₁ с крышечкой при
фиксированных иксах плюс 60

59
00:05:02,560 --> 00:05:07,910
в квадрате на дисперсию β₂ с
крышечкой при фиксированных иксах

60
00:05:07,910 --> 00:05:13,040
плюс 2 умножить на 60 на
ковариацию β₁ с крышечкой,

61
00:05:13,040 --> 00:05:18,662
β₂ с крышечкой при фиксированных иксах.

62
00:05:18,662 --> 00:05:23,170
Настоящую дисперсию мы не
знаем и никогда не узнаем.

63
00:05:23,170 --> 00:05:27,530
Зато вместо настоящей дисперсии
мы можем посчитать оценку

64
00:05:27,530 --> 00:05:32,650
дисперсии var с крышкой от
price с крышкой при фиксированных иксах.

65
00:05:32,650 --> 00:05:36,800
Тогда все компоненты в этой
формуле получат крышку над ними.

66
00:05:36,800 --> 00:05:41,557
Вот так я могу везде поставить крышку,
крышка,

67
00:05:41,557 --> 00:05:45,953
крышка, крышка, крышка, крышка.

68
00:05:45,953 --> 00:05:51,920
А оценка дисперсии, оценка ковариации есть
в ковариационной матрице в оцененной.

69
00:05:51,920 --> 00:05:57,026
Соответственно, мы получаем 13.78 плюс

70
00:05:57,026 --> 00:06:03,600
60 в квадрате помножить на оценку
дисперсии второго коэффициента 0.025

71
00:06:03,600 --> 00:06:10,700
плюс 120 помножить на оценку
ковариации на минус 0.18.

72
00:06:10,700 --> 00:06:17,090
Если это вычисление выполнить,
то у нас получится примерно 1.

73
00:06:17,090 --> 00:06:21,330
Зная оценку дисперсии прогноза,

74
00:06:21,330 --> 00:06:26,107
мы можем легко оценить
дисперсию ошибки прогноза в

75
00:06:26,107 --> 00:06:30,440
первом случае и дисперсию ошибки
прогноза во втором случае.

76
00:06:30,440 --> 00:06:32,683
Давайте мы их сразу оценим.

77
00:06:32,683 --> 00:06:37,162
Значит, на сколько прогноз наш
не похож на среднюю стоимость

78
00:06:37,162 --> 00:06:39,980
квартиры с площадью 60 метров в Москве.

79
00:06:39,980 --> 00:06:44,725
Это var с крышкой,

80
00:06:44,725 --> 00:06:49,606
E от y_F при условии, что totalspan

81
00:06:49,606 --> 00:06:54,255
F равно 60 минус наш

82
00:06:54,255 --> 00:07:00,153
прогноз y_F так,

83
00:07:00,153 --> 00:07:04,820
здесь мне крышечка не нужна,

84
00:07:04,820 --> 00:07:10,772
и от y_F и соответственно,

85
00:07:10,772 --> 00:07:14,977
при опять же фиксированных регрессорах.

86
00:07:14,977 --> 00:07:18,879
При фиксированных регрессорах,

87
00:07:18,879 --> 00:07:22,692
вот эта величина является константой.

88
00:07:22,692 --> 00:07:27,000
Соответственно, она не
влияет на дисперсию.

89
00:07:27,000 --> 00:07:28,672
А дисперсию y_F с крышечкой,

90
00:07:28,672 --> 00:07:32,520
дисперсию price с крышечкой мы
уже посчитали — это примерно 1.

91
00:07:32,520 --> 00:07:35,633
Вторая дисперсия чуть-чуть сложнее.

92
00:07:35,633 --> 00:07:39,804
Это дисперсия фактического
значения y_F минус y_F

93
00:07:39,804 --> 00:07:43,830
с крышечкой при фиксированных иксах.

94
00:07:43,830 --> 00:07:48,756
Но, поскольку фактический y_F, это есть,
то есть фактическая

95
00:07:48,756 --> 00:07:53,570
стоимость какой-нибудь случайно выбираемой
квартиры в Москве — это что такое?

96
00:07:53,570 --> 00:07:59,462
Это среднестатистическая стоимость
квартиры с данными параметрами плюс

97
00:07:59,462 --> 00:08:05,779
случайная составляющая, вызванная тем,
что мы случайным образом выбираем квартиры

98
00:08:05,779 --> 00:08:11,160
с данными характеристиками и минус 
ŷ при фиксированных иксах.

99
00:08:11,160 --> 00:08:15,835
Опять же, при фиксированных иксах, вот эта
случайная величина, ее значение известно,

100
00:08:15,835 --> 00:08:21,032
поэтому она не влияет на дисперсию и
следовательно, на оценку дисперсии и нам

101
00:08:21,032 --> 00:08:27,009
остается просто var с крышкой 
ε_F минус y_F с крышкой.

102
00:08:27,009 --> 00:08:34,320
Поскольку мы строим прогнозы вот
эти по 2040 наблюдениям,

103
00:08:34,320 --> 00:08:40,211
а это мы строим прогнозы
для какой-то новой квартиры,

104
00:08:40,211 --> 00:08:42,720
которая не входит в наши 2040 наблюдений.

105
00:08:42,720 --> 00:08:45,190
Это некое наблюдение, условно 2041,

106
00:08:45,190 --> 00:08:49,540
то есть мы строим прогнозы не для той
квартиры, которая у нас есть в выборке.

107
00:08:49,540 --> 00:08:53,068
Поэтому эти случайные величины независимы,

108
00:08:53,068 --> 00:08:58,962
поэтому это есть просто
сумма оценок дисперсии

109
00:08:58,962 --> 00:09:03,725
var с крышкой y_F при фиксированных

110
00:09:03,725 --> 00:09:09,040
иксах и здесь тоже при
фиксированных иксах.

111
00:09:09,040 --> 00:09:13,855
И мы получаем — это σ² с крышкой,

112
00:09:13,855 --> 00:09:19,330
11154 плюс 1155.

113
00:09:19,330 --> 00:09:23,895
И теперь мы легко можем построить
оба доверительных интервала.

114
00:09:23,895 --> 00:09:28,460
Доверительные интервалы у
нас строятся по принципу.

115
00:09:28,460 --> 00:09:30,380
Доверительный интервал в b.

116
00:09:30,380 --> 00:09:36,074
Поскольку у нас очень много наблюдений,
n = 2040, то мы можем спокойно

117
00:09:36,074 --> 00:09:41,504
использовать нормальные
распределения для 95-% значения,

118
00:09:41,504 --> 00:09:45,730
критические для статистики нормального
распределения, равны примерно 2,

119
00:09:45,730 --> 00:09:49,626
но если быть точным:
1.96 и, соответственно,

120
00:09:49,626 --> 00:09:55,308
первый доверительный интервал мы строим
по принципу ŷ минус 1.96

121
00:09:55,308 --> 00:10:00,870
помножить на стандартную
ошибку для первого случая,

122
00:10:00,870 --> 00:10:06,700
а стандартная ошибка для первого
случая — это корень из единички

123
00:10:06,700 --> 00:10:14,228
до y_F с крышечкой плюс 1.96
помножить на корень из единички.

124
00:10:14,228 --> 00:10:19,408
А в случае с мы используем
стандартную ошибку,

125
00:10:19,408 --> 00:10:22,451
равную корню из второй дисперсии.

126
00:10:22,451 --> 00:10:27,090
Соответственно, у нас получается
y_F с крышечкой минус 1.96

127
00:10:27,090 --> 00:10:30,896
помножить на корень из 1155,

128
00:10:30,896 --> 00:10:36,620
и y_F с крышечкой плюс 1.96
помножить на корень из 1155.

129
00:10:36,620 --> 00:10:41,401
Вот у меня получается два
доверительных интервала.

130
00:10:41,401 --> 00:10:47,196
Из них первый выходит 94-точечный

131
00:10:47,196 --> 00:10:53,090
прогноз минус 2.94 плюс 2,

132
00:10:53,090 --> 00:11:01,070
а второй доверительный интервал выходит:
корень из 1155 — это примерно 34.

133
00:11:01,070 --> 00:11:06,664
Соответственно, 34 умножаем на 2,
это получается 68.

134
00:11:06,664 --> 00:11:12,160
Здесь 94 минус 68, а здесь 94 плюс 68.

135
00:11:12,160 --> 00:11:17,255
То есть ширина доверительного интервала
и ширина прогнозного интервала

136
00:11:17,255 --> 00:11:18,639
резко отличается.

137
00:11:18,639 --> 00:11:19,200
Почему?

138
00:11:19,200 --> 00:11:23,635
Потому что наша модель довольно
хорошо точно оценивает среднюю

139
00:11:23,635 --> 00:11:28,290
стоимость квартиры с площадью 60 метров.

140
00:11:28,290 --> 00:11:34,570
И вот про среднюю стоимость квартиры в
Москве, мы уверены, что она от 92 до 96.

141
00:11:34,570 --> 00:11:39,680
Однако если мы возьмем не некую
мифическую среднестатистическую квартиру,

142
00:11:39,680 --> 00:11:44,482
а просто выберем наугад из
всех предложений квартиру

143
00:11:44,482 --> 00:11:49,231
с площадью 60 метров, она,
естественно, не среднестатистическая.

144
00:11:49,231 --> 00:11:52,446
Она может отличаться от
среднестатистической как в плюс — быть

145
00:11:52,446 --> 00:11:54,240
дороже ее, так и быть дешевле нее.

146
00:11:54,240 --> 00:11:59,350
Поэтому наш доверительный интервал,
наш предиктивный интервал для конкретного

147
00:11:59,350 --> 00:12:06,546
значения y, он оказывается шире и
он соответственно равен от 94 минус 68,

148
00:12:06,546 --> 00:12:14,100
до 94 плюс 68.

