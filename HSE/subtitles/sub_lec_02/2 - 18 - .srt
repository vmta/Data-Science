1
00:00:13,005 --> 00:00:18,087
Перейдем к компьютерной
части второй лекции.

2
00:00:18,087 --> 00:00:22,041
Запускаем наш R студио, открываем,

3
00:00:22,041 --> 00:00:28,693
чтобы долго не набирать, небольшой
файл-заготовку lab_02_before.R и,

4
00:00:28,693 --> 00:00:32,906
как и любой серьезный файл
с каким-то исследованием,

5
00:00:32,906 --> 00:00:37,329
он начинается с загрузки
большого числа полезных пакетов,

6
00:00:37,329 --> 00:00:40,960
в которых содержатся
полезные и удобные функции.

7
00:00:40,960 --> 00:00:43,836
Поскольку с некоторыми из этих
пакетов мы работаем в первый раз,

8
00:00:43,836 --> 00:00:47,120
то их сначала необходимо предварительно
скачать, установить из Интернета.

9
00:00:47,120 --> 00:00:51,932
Для этого, мы залазим в меню
Tools выбираем опцию 

10
00:00:51,932 --> 00:00:57,037
Install packages и через запятую пишем те пакеты,
которые мы собираемся

11
00:00:57,037 --> 00:01:01,663
использовать в первый раз memisc,
можно просто их, 

12
00:01:01,663 --> 00:01:07,959
то есть эта установка делается
один раз dplyr, psych и так далее.

13
00:01:07,959 --> 00:01:13,014
И нажимаем install и соответственно,
они поставятся.

14
00:01:13,014 --> 00:01:16,627
Поскольку на моем компьютере они
уже стоят, то я тут нажму Cancel,

15
00:01:16,627 --> 00:01:19,420
а при нажатии кнопки Install,
они поставятся.

16
00:01:19,420 --> 00:01:24,946
После того, как пакеты установлены,
мы можем быстренько понажимать

17
00:01:24,946 --> 00:01:31,690
Ctrl+Enter или у кого Mac — Command+Enter,
активировать все пакеты.

18
00:01:31,690 --> 00:01:36,427
И приступить к

19
00:01:36,427 --> 00:01:40,850
решению содержательных задач.

20
00:01:40,850 --> 00:01:45,928
Первая задача,
с которой мы начнем, это как

21
00:01:45,928 --> 00:01:51,096
в R генерить случайные величины, как
считать вероятности, как зная вероятность,

22
00:01:51,096 --> 00:01:57,399
находить точку, которая соответствует
данной вероятности, квантили распределения.

23
00:01:57,399 --> 00:02:03,920
Поехали, задача один: «как генерить,
генерировать случайные величины».

24
00:02:03,920 --> 00:02:07,639
Генерируем случайные величины.

25
00:02:07,639 --> 00:02:11,175
Допустим, мы хотим сгенерировать

26
00:02:11,175 --> 00:02:14,990
100 нормально распределенных
случайных величин.

27
00:02:14,990 --> 00:02:19,740
То есть наша задача сгенерировать x_1 ...,

28
00:02:19,740 --> 00:02:25,001
x_{100}, давайте лучше z напишем,
чтобы не путать с регрессорами.

29
00:02:25,001 --> 00:02:25,501
z_2, ...,

30
00:02:26,904 --> 00:02:33,506
z_{100}, так, чтобы каждая из z была
нормальна с математическим ожиданием,

31
00:02:33,506 --> 00:02:38,280
скажем, 5 и дисперсией, скажем, 9.

32
00:02:38,280 --> 00:02:41,217
Это сделать очень просто.

33
00:02:41,217 --> 00:02:43,520
Мы создаем вектор z.

34
00:02:43,520 --> 00:02:49,396
Любая генерация случайных величин,
там много разных распределений бывает, да,

35
00:02:49,396 --> 00:02:52,970
начинается с буквы r —
сокращение от слова random.

36
00:02:52,970 --> 00:02:57,721
Нормальные случайные величины генерятся
командой rnorm, а какое-нибудь

37
00:02:57,721 --> 00:03:01,080
другое распределение генерится r
и какое-нибудь другое сокращение.

38
00:03:01,080 --> 00:03:02,732
Давайте начнем с нормальных.

39
00:03:02,732 --> 00:03:04,505
Нам нужно 100 случайных величин.

40
00:03:04,505 --> 00:03:09,380
Поэтому rnorm(100), а дальше надо указать
параметры нормального распределения.

41
00:03:09,380 --> 00:03:15,913
В данном случае параметры: среднее равно 5,
mean равно 5, а дисперсия равна 9,

42
00:03:15,913 --> 00:03:20,587
в R, если нажать Tab, то можно
посмотреть, надо указывать стандартное

43
00:03:20,587 --> 00:03:25,471
отклонение и поэтому мы укажем
стандартное отклонение 3.

44
00:03:25,471 --> 00:03:29,916
Нажимаем Ctrl+Enter и у нас вот
справа появляется в окошке, что в

45
00:03:29,916 --> 00:03:34,850
памяти компьютера находится теперь вектор
z длины 100 и вот его первые значения.

46
00:03:34,850 --> 00:03:38,022
Можно посмотреть какое-то
конкретное значение,

47
00:03:38,022 --> 00:03:40,770
например, чему равно 56-ое значение z.

48
00:03:40,770 --> 00:03:46,160
Можно посмотреть несколько,
допустим, со 2 по 9.

49
00:03:46,160 --> 00:03:49,175
Вот это значения z со 2 по 9.

50
00:03:49,175 --> 00:03:54,417
Можно, например, построить гистограмму

51
00:03:54,417 --> 00:04:00,387
полученного вектора z то есть гистограмму,
полученных чисел,

52
00:04:00,387 --> 00:04:04,700
вот действительно, так издалека
похоже на нормальное распределение.

53
00:04:04,700 --> 00:04:07,523
Если бы было не 100 случайных величин,
а больше,

54
00:04:07,523 --> 00:04:11,490
то гистограмма была больше бы похожа
на классическую функцию плотности.

55
00:04:11,490 --> 00:04:13,954
Помимо генерации случайных величин,

56
00:04:13,954 --> 00:04:18,070
может потребоваться построить
например ее функцию плотности.

57
00:04:18,070 --> 00:04:22,296
Давайте построим функцию плотности нашей
случайной величины, любой из z: z_1,

58
00:04:22,296 --> 00:04:29,343
z_2, они все одинаково распределены
нормально со средним 5 и дисперсией 9.

59
00:04:29,343 --> 00:04:32,446
Построим функцию плотности.

60
00:04:32,446 --> 00:04:36,492
Для того чтобы построить
график функции плотности,

61
00:04:36,492 --> 00:04:39,810
надо сначала сказать при каких
иксах мы его будем строить.

62
00:04:39,810 --> 00:04:43,153
То есть значение абсциссы,
а соответственно,

63
00:04:43,153 --> 00:04:46,440
значение ординаты — это
будет функция плотности.

64
00:04:46,440 --> 00:04:51,425
Поскольку у нас случайная величина около
5, плюс-минус 2 стандартных ошибки

65
00:04:51,425 --> 00:04:56,359
— это плюс-минус 6, соответственно,
она где-то бегает от минус 1 до 11.

66
00:04:56,359 --> 00:04:58,690
И иногда вылезает за эти пределы.

67
00:04:58,690 --> 00:05:03,698
Поэтому, давайте мы построим график
функции плотности при иксах, лежащих в

68
00:05:03,698 --> 00:05:10,310
диапазоне, скажем от минус 10 и до
15 и точность у нас будет с шагом 0.5.

69
00:05:10,310 --> 00:05:14,750
То есть точечки будут через
каждые 0.5 по оси абсцисс.

70
00:05:14,750 --> 00:05:18,835
Соответственно, можно
посмотреть на этот вектор х.

71
00:05:18,835 --> 00:05:24,285
Вектор х это видно минус 10, минус 9,5,
минус 9, минус 8,5 и так далее до 15.

72
00:05:24,285 --> 00:05:27,560
Начинается с минус 10 и
заканчивается 15 с шагом 0.5.

73
00:05:27,560 --> 00:05:32,080
Соответственно, игрек это должно быть
значение функции плотности по оси ординат.

74
00:05:32,080 --> 00:05:36,022
Все функции плотности в R начинаются
с буквы d, сокращение от density.

75
00:05:36,022 --> 00:05:41,040
Соответственно, функция плотности
нормальной случайной величины это dnorm.

76
00:05:41,040 --> 00:05:45,828
Значит, пишем dnorm, в скобках мы
указываем наши иксы и параметры

77
00:05:45,828 --> 00:05:50,127
нашего распределения, параметры
нормального распределения — это среднее

78
00:05:50,127 --> 00:05:54,390
равно 5 и стандартное отклонение,
равное 3.

79
00:05:54,390 --> 00:05:59,519
Сгенерили значения ординат,
соответственно,

80
00:05:59,519 --> 00:06:03,839
теперь мы можем построить график
qplot по оси икс откладываем икс,

81
00:06:03,839 --> 00:06:08,280
по оси игрек откладываем игрек и
получаем вот такой вот график.

82
00:06:08,280 --> 00:06:13,385
Обычно, поскольку функция
плотности является непрерывной

83
00:06:13,385 --> 00:06:18,751
функцией в данном случае, то можно
подчеркнуть этот факт и построить функцию,

84
00:06:18,751 --> 00:06:22,454
указав тип геометрии графика «линия»,
соответственно,

85
00:06:22,454 --> 00:06:25,609
мы получим вот такой 
сглаженный график и действительно,

86
00:06:25,609 --> 00:06:31,530
в среднем случайная величина равна 5,
за минус 5 и за 15 попадает очень редко.

87
00:06:31,530 --> 00:06:36,730
Вот такая у нас получилась
функция плотности.

88
00:06:36,730 --> 00:06:41,800
Теперь перейдем к следующей
задаче — расчету вероятностей.

89
00:06:41,800 --> 00:06:46,479
Давайте посчитаем,
скажем, вероятность того,

90
00:06:46,479 --> 00:06:50,950
что z окажется меньше 3.

91
00:06:50,950 --> 00:06:55,502
Поскольку вероятность того,
что z меньше 3 — это не что иное,

92
00:06:55,502 --> 00:07:00,705
как функция распределения в точке 3, для
любой случайной величины вероятность того,

93
00:07:00,705 --> 00:07:02,715
что она будет меньше конкретного числа,

94
00:07:02,715 --> 00:07:07,130
это функция распределения данной
случайной величины в данной точке.

95
00:07:07,130 --> 00:07:12,700
Все функции распределения
в R начинаются с буквы p,

96
00:07:12,700 --> 00:07:17,180
сокращение от probability
distribution function.

97
00:07:17,180 --> 00:07:22,484
Соответственно, в данном случае мы
получаем, что нам надо найти pnorm от 3,

98
00:07:22,484 --> 00:07:26,790
если среднее равно 5,
а стандартное отклонение равно 3.

99
00:07:26,790 --> 00:07:29,792
Я пропустил знак равенства.

100
00:07:29,792 --> 00:07:33,400
Стандартное отклонение равно 3.

101
00:07:33,400 --> 00:07:38,446
Или например,
если я хочу найти вероятность того,

102
00:07:38,446 --> 00:07:45,420
что z лежит в диапазоне от 4 до 9,

103
00:07:45,420 --> 00:07:50,080
то это есть с точки зрения
здравого смысла вероятность того,

104
00:07:50,080 --> 00:07:55,290
что z меньше 9 минус вероятность того,
что z меньше 4.

105
00:07:55,290 --> 00:07:59,704
И, соответственно, можно посчитать
эту вероятность как pnorm в точке 9 с

106
00:07:59,704 --> 00:08:04,800
параметрами среднее равно 5,
стандартное отклонение равно 3 минус

107
00:08:04,800 --> 00:08:10,150
функция распределения в точке 4,

108
00:08:10,150 --> 00:08:15,380
а параметры остались те же самые, среднее
равно 5, стандартное отклонение равно 3.

109
00:08:15,380 --> 00:08:18,400
Соответственно, искомая
вероятность равна 0.53.

110
00:08:18,400 --> 00:08:21,492
И по аналогии можно еще найти
квантили распределения.

111
00:08:21,492 --> 00:08:23,540
Что такое квантили распределения?

112
00:08:23,540 --> 00:08:30,220
Квантиль — это на самом деле,
обратная функция к функции распределения.

113
00:08:30,220 --> 00:08:35,858
То есть, если, например, я хочу найти
такое число а, чтобы вероятность того,

114
00:08:35,858 --> 00:08:39,686
что z меньше а была равна, скажем, 0.7.

115
00:08:39,686 --> 00:08:41,810
И вот надо найти такое а.

116
00:08:41,810 --> 00:08:45,009
То соответственно, это можно найти
с помощью квантильной функции,

117
00:08:45,009 --> 00:08:52,010
квантили начинаются с буквы q в r,
qnorm от 0.7,

118
00:08:52,010 --> 00:08:59,040
параметры те же самые,
5 и стандартное отклонение 3.

119
00:08:59,040 --> 00:09:04,202
И, судя по графику,
чтобы вероятность составила 0.7,

120
00:09:04,202 --> 00:09:08,860
нам надо,
получится число где-то большее 5, да.

121
00:09:08,860 --> 00:09:16,930
И вот, тут где-то 6.57 и вот слева от
6.57 площадь под графиком равна 0.7.

122
00:09:16,930 --> 00:09:23,150
Соответственно, помимо
нормального распределения,

123
00:09:23,150 --> 00:09:27,921
естественно в R есть и другие самые
популярные распределния это хи-квадрат, t

124
00:09:27,921 --> 00:09:31,480
и F, которые нам понадобятся.

125
00:09:31,480 --> 00:09:35,910
Соответственно, для них, соответствующие
четверки функции будут выглядеть как

126
00:09:35,910 --> 00:09:41,153
rchisq,  dchisq — это функция

127
00:09:41,153 --> 00:09:46,186
плотности хи-квадрат случайной величины,
pchisq — это

128
00:09:46,186 --> 00:09:51,280
функция распределения и qchisq,
и аналогично для t и F.

129
00:09:51,280 --> 00:09:55,750
rt функция позволяет
генерировать t распределение.

130
00:09:55,750 --> 00:10:00,928
dt — это функция плотности 
t-распределения, pt — это функция

131
00:10:00,928 --> 00:10:05,720
распределения t-распределения
и qt — это квантильная функция,

132
00:10:05,720 --> 00:10:10,095
и аналогично для F распределения.

